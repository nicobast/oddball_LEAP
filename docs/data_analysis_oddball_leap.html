<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Nico Bast" />

<meta name="date" content="2023-10-20" />

<title>data_analysis_oddball_leap_280423</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-1.0.9/grViz.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">project_oddball_LEAP</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">data_analysis_oddball_leap_280423</h1>
<h4 class="author">Nico Bast</h4>
<h4 class="date">2023-10-20</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2023-10-20
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 5
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 2
</p>
<p>
<strong>Knit directory:</strong> <code>project_oddball_LEAP/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20230119code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20230119)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20230119code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20230119)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongabsolute">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>File paths:</strong> absolute </a>
</p>
</div>
<div id="strongFilepathsstrongabsolute" class="panel-collapse collapse">
<div class="panel-body">
<p>
Using absolute paths to the files within your workflowr project makes it
difficult for you and others to run your code on a different machine.
Change the absolute path(s) below to the suggested relative path(s) to
make your code more reproducible.
</p>
<table class="table table-condensed table-hover">
<thead>
<tr>
<th style="text-align:left;">
absolute
</th>
<th style="text-align:left;">
relative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C:/Users/nico/PowerFolders/project_oddball_LEAP
</td>
<td style="text-align:left;">
.
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomnicobastoddballLEAPtreecce27345bef2f1e4e9b1441abf2473b060f0719ftargetblankcce2734a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/nicobast/oddball_LEAP/tree/cce27345bef2f1e4e9b1441abf2473b060f0719f" target="_blank">cce2734</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomnicobastoddballLEAPtreecce27345bef2f1e4e9b1441abf2473b060f0719ftargetblankcce2734a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/nicobast/oddball_LEAP/tree/cce27345bef2f1e4e9b1441abf2473b060f0719f" target="_blank">cce2734</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .PowerFolder/
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/figure/
    Ignored:    manuscript/
    Ignored:    output/figures/
    Ignored:    output/supplements/

Unstaged changes:
    Modified:   analysis/data_analysis_oddball_leap.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/data_analysis_oddball_leap.Rmd</code>) and HTML
(<code>docs/data_analysis_oddball_leap.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/cce27345bef2f1e4e9b1441abf2473b060f0719f/analysis/data_analysis_oddball_leap.Rmd" target="_blank">cce2734</a>
</td>
<td>
nicobast
</td>
<td>
2023-10-20
</td>
<td>
internal revision - full markdown knit
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/d2ac698dc8dbfbdd9efe36046cccbdc89f9668d0/analysis/data_analysis_oddball_leap.Rmd" target="_blank">d2ac698</a>
</td>
<td>
nicobast
</td>
<td>
2023-07-20
</td>
<td>
state of first complete draft
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/ff4532e59ad7276fd1ac848a859696197224c0f2/analysis/data_analysis_oddball_leap.Rmd" target="_blank">ff4532e</a>
</td>
<td>
nicobast
</td>
<td>
2023-07-19
</td>
<td>
single supplements doc
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/d9f4fe91486ed21b38c9489f6dbd488536d23ea8/analysis/data_analysis_oddball_leap.Rmd" target="_blank">d9f4fe9</a>
</td>
<td>
nicobast
</td>
<td>
2023-07-07
</td>
<td>
finalize initial draft analysis
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/851806814219749dda23d8d676eb64863fd4aaad/analysis/data_analysis_oddball_leap.Rmd" target="_blank">8518068</a>
</td>
<td>
nicobast
</td>
<td>
2023-07-06
</td>
<td>
scaling of demographics with DVs between groups
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/3f4583722466e05a906b3db226790a13df6a884a/analysis/data_analysis_oddball_leap.Rmd" target="_blank">3f45837</a>
</td>
<td>
nicobast
</td>
<td>
2023-07-06
</td>
<td>
extended supplements, revised figures
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/2fa7ce772f543e075e1e4c5ce2f048917fcca9a3/analysis/data_analysis_oddball_leap.Rmd" target="_blank">2fa7ce7</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-22
</td>
<td>
added supplements to markdown
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/00d9e34494ee7e037f0a893c9dd114112db87714/analysis/data_analysis_oddball_leap.Rmd" target="_blank">00d9e34</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-21
</td>
<td>
revised analysis markdown
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/f71f9651770dbeb6bddd5b9a92715fc2c1f90af6/analysis/data_analysis_oddball_leap.Rmd" target="_blank">f71f965</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-16
</td>
<td>
fixed ID and condition + visualization of mm
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/e73fca7b3636a5a6bf0720c963bacbbc659d989a/analysis/data_analysis_oddball_leap.Rmd" target="_blank">e73fca7</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-15
</td>
<td>
read EEG and retrieve trial info
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/1d6516525a8f6ca1c6db1325e6f030c83aba55f2/analysis/data_analysis_oddball_leap.Rmd" target="_blank">1d65165</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-12
</td>
<td>
filled readme
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/nicobast/oddball_LEAP/blob/c8c8e30880c22b64ea9551638e0ecde3a0d3791c/analysis/data_analysis_oddball_leap.Rmd" target="_blank">c8c8e30</a>
</td>
<td>
nicobast
</td>
<td>
2023-06-12
</td>
<td>
first draft of analysis markdown
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="setup" class="section level1">
<h1>setup</h1>
</div>
<div id="load-data" class="section level1">
<h1>load data</h1>
<p>Eye tracking and EEG data in separate file that are already
preprocessed, see</p>
<li>
<li>
<pre class="r"><code>## pupil data
load(file=paste0(project_path,&#39;/data/mmn_leap_pd_final_dfs_21022023&#39;))

## EEG data - reduced to FZ channel - see read_eeg_data.R
#load(paste0(project_path,&quot;/data/leap_oddball_eeg_list.rdata&quot;))
list_eeg_redux&lt;-readRDS(paste0(project_path,&quot;/data/leap_oddball_eeg_list_redux.rds&quot;))</code></pre>
<p>Also load and merge the data generated by the PCDM computational
model, see</p>
<li>
<li>
<pre class="r"><code>#read data estimated in MAtlab
mat_output&lt;-readMat(paste0(project_path,&quot;/data/pcdm_estimates_1run_290323.mat&quot;))

#extract parameters
pcdm_parameters&lt;-mat_output[[2]]
names(pcdm_parameters)&lt;-c(&#39;interpolateBlinks&#39;,&#39;downsampleRate&#39;,&#39;fitTimeseries&#39;,&#39;change_cutoff_by_samplingRate&#39;,&#39;low_bandpass_filter_range&#39;,&#39;blinkint_vel_thres_on&#39;,&#39;blinkint_window_from_onset&#39;,&#39;blinkint_min_dur&#39;,&#39;rel_vel_thres&#39;,&#39;min_sac_dur&#39;)

#create empty list
list_pcdm_estimates&lt;-list()

### extract required info from matlab object in for loop
for (i in seq(length(mat_output[[1]]))){

pcdm_estimate&lt;-mat_output[[1]][i][[1]][[1]] #extract relevant data of single participant
names(pcdm_estimate)&lt;-dimnames(pcdm_estimate)[[1]] #assign names of dimensions
pcdm_estimate&lt;-lapply(pcdm_estimate,unlist) # remove internal list structure

list_pcdm_estimates[[i]]&lt;-pcdm_estimate

}

#add names
names(list_pcdm_estimates)&lt;-sapply(list_pcdm_estimates,function(x){x[&#39;name&#39;]})

#create vectors
gain_pcdm&lt;-unlist(sapply(list_pcdm_estimates,function(x){x[&#39;gain&#39;]}))
Rsq_pcdm&lt;-unlist(sapply(list_pcdm_estimates,function(x){x[&#39;Rsq&#39;]}))
offset_pcdm&lt;-unlist(sapply(list_pcdm_estimates,function(x){x[&#39;offset&#39;]}))
id&lt;-substr(names(list_pcdm_estimates),1,nchar(names(list_pcdm_estimates))-4)
id&lt;-id[id!=&quot;&quot;] #remove empty entries

#exclude outliers
gain_pcdm[gain_pcdm&gt;0.2 | gain_pcdm&lt;(-0.2)]&lt;-NA

#merge data
df_pcdm&lt;-data.frame(id,gain_pcdm,Rsq_pcdm,offset_pcdm)
df_timepoint&lt;-merge(df_timepoint,df_pcdm,by=&#39;id&#39;,all.x=T)</code></pre>
</div>
<div id="calculate-mismatch-negativity-mmn" class="section level1">
<h1>calculate mismatch negativity (MMN)</h1>
<pre class="r"><code>###---&gt; calculate MMN ####

fun_estimate_mmn&lt;-function(one_set){

  #testing
  #one_set&lt;-list_eeg[[100]]

  ###restrict to timeframe - 50-350ms
  one_set&lt;-one_set[one_set$times&gt;50 &amp; one_set$times&lt;350,]

  mmn_trial&lt;-with(one_set,by(Fz,trial_counter,function(channel_data){

      channel_data_smooth&lt;-rollmean(channel_data,k=20) #rolling mean of 20ms
      min(channel_data_smooth)

  }))

  trial_counter&lt;-names(mmn_trial)
  mmn&lt;-as.numeric(mmn_trial)
  mmn_per_trial&lt;-data.frame(trial_counter,mmn)
  return(mmn_per_trial)

}

list_mmn&lt;-pblapply(list_eeg_redux,fun_estimate_mmn)

##--&gt; create data frame
ID&lt;-substr(names(list_mmn),10,22)
condition&lt;-substr(names(list_mmn),1,8)

list_mmn&lt;-pbmapply(function(x,y,z){
  x$condition&lt;-y
  x$ID&lt;-z
  return(x)
  },x=list_mmn,y=condition,z=ID,SIMPLIFY = F)

df_mmn&lt;-data.table::rbindlist(list_mmn)

df_mmn$trial_counter&lt;-as.numeric(df_mmn$trial_counter)
df_mmn$condition&lt;-as.factor(df_mmn$condition)</code></pre>
</div>
<div id="merge-eye-tracking-and-eeg-data" class="section level1">
<h1>merge eye-tracking and EEG data</h1>
<pre class="r"><code>##prepare EEG data
df_mmn$ID&lt;-sub(&#39;/&#39;,&#39;&#39;,df_mmn$ID)
df_mmn$ID&lt;-sub(&#39;_&#39;,&#39;&#39;,df_mmn$ID)

    #with(df_timepoint,table(subjects,wave))

    #eye-tracking data with MMN data
    table(df_timepoint$subjects %in% df_mmn$ID)</code></pre>
<pre><code>
FALSE  TRUE 
   62   260 </code></pre>
<pre class="r"><code>    table(unique(df_mmn$ID) %in% df_timepoint$subjects)</code></pre>
<pre><code>
FALSE  TRUE 
  275   187 </code></pre>
<pre class="r"><code>#create merge variables    
df_mmn$merge_id&lt;-interaction(df_mmn$ID,df_mmn$trial_counter)
df_trial$merge_id&lt;-interaction(df_trial$subjects,df_trial$EventCounter)

#merge - per-trial level (df_trial)
df_trial&lt;-merge(df_trial,df_mmn,by=&#39;merge_id&#39;,all.x=T)

    table(is.na(df_mmn$mmn))</code></pre>
<pre><code>
 FALSE 
115884 </code></pre>
<pre class="r"><code>    table(is.na(df_trial$rpd_auc))</code></pre>
<pre><code>
 FALSE 
298934 </code></pre>
<pre class="r"><code>    table(is.na(df_trial$mmn)) #missing in MMN --&gt; to be expected</code></pre>
<pre><code>
 FALSE   TRUE 
 45620 253314 </code></pre>
<pre class="r"><code>    ##--&gt; not all trials analyzed in eye-tracking were selected for EEG
    
##some trials are not correctly matched - correct for that
with(df_trial,table(condition,EventData))</code></pre>
<pre><code>          EventData
condition    201   202   203   204
  combined   614    13    26 10924
  duration   675    26 10610    15
  frequenc   665 10670    61    19
  standard 11194    29    33    46</code></pre>
<pre class="r"><code>df_trial_mmn&lt;-df_trial[(df_trial$EventData==&#39;201&#39; &amp; df_trial$condition==&#39;standard&#39;|
                 df_trial$EventData==&#39;203&#39; &amp; df_trial$condition==&#39;duration&#39;|
                 df_trial$EventData==&#39;202&#39; &amp; df_trial$condition==&#39;frequenc&#39;|
                 df_trial$EventData==&#39;204&#39; &amp; df_trial$condition==&#39;combined&#39;),]

###merge per-participant level (df_timepoint)
df_mmn_timepoint&lt;-aggregate(mmn~id+EventData,data=df_trial_mmn,FUN=mean,na.rm=T)
df_mmn_timepoint&lt;-reshape(df_mmn_timepoint, idvar = &quot;id&quot;, timevar = &quot;EventData&quot;, direction = &quot;wide&quot;)

df_timepoint&lt;-merge(df_timepoint,df_mmn_timepoint,by=&#39;id&#39;,all.x = T)
rm(df_mmn_timepoint)

###which participants have MMN data
table(is.na(df_timepoint$mmn.201),df_timepoint$t1_diagnosis) ##</code></pre>
<pre><code>       
        ASD Control
  FALSE 144      97
  TRUE   47      34</code></pre>
</div>
<div id="descriptives-table-of-sample" class="section level1">
<h1>descriptives table of sample</h1>
<p>generates a table on characteristics of the sample between groups</p>
<pre class="r"><code>#### sample descriptives - PARTICIPANT specific ####

fun_return_descriptive&lt;-function(variable,group,rounding=2,scaling=1){
  mean_values&lt;-by(variable,group,function(x){round(mean(x,na.rm=T),rounding)})
  sd_values&lt;-by(variable,group,function(x){round(sd(x,na.rm=T),rounding)})
  min_values&lt;-by(variable,group,function(x){round(min(x,na.rm=T),rounding)})
  max_values&lt;-by(variable,group,function(x){round(max(x,na.rm=T),rounding)})
  mean_values&lt;-mean_values*scaling
  sd_values&lt;-sd_values*scaling
  min_values&lt;-min_values*scaling
  max_values&lt;-max_values*scaling
  paste0(mean_values,&#39;/&#39;,sd_values,&#39; &#39;,&#39;[&#39;,min_values,&#39;-&#39;,max_values,&#39;]&#39;)
}

#standard descriptives
n_group&lt;-with(df_dem,by(subjects,t1_diagnosis,function(x){length(unique(x))}))
gender&lt;-with(df_dem,by(t1_sex,t1_diagnosis,function(x){paste0(table(x)[2],&#39;/&#39;,table(x)[1])}))
timepoints&lt;-with(df_dem,by(timepoints,t1_diagnosis,function(x){paste0(table(x)[1],&#39;/&#39;,table(x)[2],&#39;/&#39;,table(x)[3])}))
age&lt;-with(df_dem,fun_return_descriptive(variable=t1_ageyrs,group=t1_diagnosis))
iq&lt;-with(df_dem,fun_return_descriptive(variable=t1_fsiq,group=t1_diagnosis))
piq&lt;-with(df_dem,fun_return_descriptive(variable=t1_piq,group=t1_diagnosis))
viq&lt;-with(df_dem,fun_return_descriptive(variable=t1_viq,group=t1_diagnosis))

#clinical variables
srs&lt;-with(df_dem,fun_return_descriptive(variable=t1_srs_rawscore,group=t1_diagnosis))
rbs_total&lt;-with(df_dem,fun_return_descriptive(variable=t1_rbs_total,group=t1_diagnosis))
sdq_total&lt;-with(df_dem,fun_return_descriptive(variable=t1_sdq_total_difficulties_p,group=t1_diagnosis))
adhd_inatt&lt;-with(df_dem,fun_return_descriptive(variable=adhd_inatt,group=t1_diagnosis))
adhd_hyper&lt;-with(df_dem,fun_return_descriptive(variable=adhd_hyper,group=t1_diagnosis))
anx_beck&lt;-with(df_dem,fun_return_descriptive(variable=anx_beck,group=t1_diagnosis))
dep_beck&lt;-with(df_dem,fun_return_descriptive(variable=dep_beck,group=t1_diagnosis))

##data quality
#precision&lt;-with(df_dem,fun_return_descriptive(variable=Precision,group=t1_diagnosis))
#accuracy&lt;-with(df_dem,fun_return_descriptive(variable=Accuracy,group=t1_diagnosis))
#sampling_rate&lt;-with(df_dem,by(sampling_rate,t1_diagnosis,function(x){paste0(table(x)[2],&#39;/&#39;,table(x)[1])}))
missing_data_trial&lt;-with(df_dem,fun_return_descriptive(variable=missing_data_trial,group=t1_diagnosis,rounding=4,scaling = 100))
sampling_rate&lt;-with(df_timepoint,by(sampling_rate,t1_diagnosis,function(x){paste0(table(x)[2],&#39;/&#39;,table(x)[1])}))

#et vars
center_dev_id&lt;-with(df_dem,fun_return_descriptive(variable=center_dev,group=t1_diagnosis,rounding=4,scaling=100))
screen_dist_id&lt;-with(df_dem,fun_return_descriptive(variable=screen_dist,group=t1_diagnosis))
pd_baseline_id&lt;-with(df_dem,fun_return_descriptive(variable=pd_baseline,group=t1_diagnosis))
# rpd_response201_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_response.201,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_response202_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_response.202,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_response203_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_response.203,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_response204_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_response.204,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_auc201_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_auc.201,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_auc202_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_auc.202,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_auc203_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_auc.203,group=t1_diagnosis,rounding=4,scaling=100))
# rpd_auc204_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_auc.204,group=t1_diagnosis,rounding=4,scaling=100))


rpd_auc_id&lt;-with(df_dem,fun_return_descriptive(variable=rpd_auc,group=t1_diagnosis,rounding=4,scaling=100))


descriptives_table&lt;-rbind(n_group,gender,timepoints,age,iq,piq,viq,
                          missing_data_trial,sampling_rate,
                          center_dev_id,screen_dist_id,pd_baseline_id,
                          srs,rbs_total,sdq_total,adhd_inatt,adhd_hyper,anx_beck,dep_beck
                          #rpd_response201_id,rpd_response202_id,rpd_response203_id,rpd_response204_id,
                          #rpd_auc201_id,rpd_auc202_id,rpd_auc203_id,rpd_auc204_id
                          )

##group differences
groupdiff_p&lt;-c(NA,
               round(as.numeric(with(df_dem,chisq.test(t1_sex,t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,chisq.test(timepoints,t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_ageyrs~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_fsiq~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_piq~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_viq~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(missing_data_trial~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_timepoint,chisq.test(sampling_rate,t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(center_dev~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(screen_dist~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(pd_baseline~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_srs_rawscore~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_rbs_total~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(t1_sdq_total_difficulties_p~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(adhd_inatt~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(adhd_hyper~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(anx_beck~t1_diagnosis))[&#39;p.value&#39;]),3),
               round(as.numeric(with(df_dem,t.test(dep_beck~t1_diagnosis))[&#39;p.value&#39;]),3)
               # round(as.numeric(with(df_dem,t.test(rpd_response.201~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_response.202~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_response.203~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_response.204~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_auc.201~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_auc.202~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_auc.203~t1_diagnosis))[&#39;p.value&#39;]),3),
               # round(as.numeric(with(df_dem,t.test(rpd_auc.204~t1_diagnosis))[&#39;p.value&#39;]),3)
               )

groupdiff_p[which(groupdiff_p==0)]&lt;-&#39;&lt;0.001&#39;
groupdiff_p[which(is.na(groupdiff_p))]&lt;-&#39;-&#39;

row_names&lt;-c(&#39;n&#39;,&#39;gender (F/M)&#39;,&#39;timepoints (1/2/1+2)&#39;,&#39;age (in years)&#39;,&#39;IQ&#39;,&#39;perceptual IQ&#39;,&#39;verbal IQ&#39;,
             #&#39;data quality: precision&#39;,&#39;data quality: accuracy&#39;,
             #&#39;sampling rate (120Hz/300Hz)&#39;,
             &#39;missing data per trial (%)&#39;,&#39;sampling rate (300Hz / 120Hz)&#39;,
             &#39;gaze center deviation (%)&#39;,&#39;screen distance (mm)&#39;,&#39;mean pupil size (mm)&#39;,
             &#39;SRS (total)&#39;,&#39;RBS (total)&#39;,&#39;SDQ (total)&#39;,&#39;ADHD inattention&#39;,&#39;ADHD hyperactivity&#39;,&#39;BAI (anxiety)&#39;,&#39;BDI (depression)&#39;
             # &#39;pupillary response: amplitude - standard (%)&#39;,&#39;pupillary response: amplitude - oddball pitch (%)&#39;,&#39;pupillary response: amplitude - oddball length (%)&#39;,&#39;pupillary response: amplitude - oddball both (%)&#39;,
             # &#39;pupillary response: AUC - standard (%)&#39;,&#39;pupillary response: AUC - oddball pitch (%)&#39;,&#39;pupillary response: AUC - oddball length (%)&#39;,&#39;pupillary response: AUC - oddball both (%)&#39;
             )

descriptives_table&lt;-cbind(row_names,descriptives_table,groupdiff_p)

#add group differences
#descriptives_table&lt;-ifelse(descriptives_table==&#39;0&#39;,&#39;&lt;0.001&#39;,descriptives_table)

table_sample&lt;-descriptives_table %&gt;%
  kbl(caption = &quot;Sample description&quot;,
      col.names = c(&#39;&#39;,&#39;autistic individuals (ASD)&#39;,&#39;non-autistic individuals (NTC)&#39;,&#39;group difference (p)&#39;),
      row.names = F) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)


descriptives_table</code></pre>
<pre><code>                   row_names                      
n_group            &quot;n&quot;                            
gender             &quot;gender (F/M)&quot;                 
timepoints         &quot;timepoints (1/2/1+2)&quot;         
age                &quot;age (in years)&quot;               
iq                 &quot;IQ&quot;                           
piq                &quot;perceptual IQ&quot;                
viq                &quot;verbal IQ&quot;                    
missing_data_trial &quot;missing data per trial (%)&quot;   
sampling_rate      &quot;sampling rate (300Hz / 120Hz)&quot;
center_dev_id      &quot;gaze center deviation (%)&quot;    
screen_dist_id     &quot;screen distance (mm)&quot;         
pd_baseline_id     &quot;mean pupil size (mm)&quot;         
srs                &quot;SRS (total)&quot;                  
rbs_total          &quot;RBS (total)&quot;                  
sdq_total          &quot;SDQ (total)&quot;                  
adhd_inatt         &quot;ADHD inattention&quot;             
adhd_hyper         &quot;ADHD hyperactivity&quot;           
anx_beck           &quot;BAI (anxiety)&quot;                
dep_beck           &quot;BDI (depression)&quot;             
                   ASD                           Control                      
n_group            &quot;139&quot;                         &quot;88&quot;                         
gender             &quot;101/38&quot;                      &quot;57/31&quot;                      
timepoints         &quot;43/51/45&quot;                    &quot;25/31/32&quot;                   
age                &quot;16.13/5.48 [6.24-27.35]&quot;     &quot;17.59/6.03 [6.24-30.98]&quot;    
iq                 &quot;97.55/21.33 [40-148]&quot;        &quot;103.91/19.55 [52-142]&quot;      
piq                &quot;99.18/20.79 [45-137]&quot;        &quot;103.66/19.28 [51-137]&quot;      
viq                &quot;95.91/21.06 [45-160]&quot;        &quot;102.63/19.33 [51-143]&quot;      
missing_data_trial &quot;1.82/1.25 [0.21-6.79]&quot;       &quot;1.84/1.29 [0.27-8.42]&quot;      
sampling_rate      &quot;132/59&quot;                      &quot;81/50&quot;                      
center_dev_id      &quot;13.19/5.76 [3.45-28.95]&quot;     &quot;12.12/5.86 [3.28-28.96]&quot;    
screen_dist_id     &quot;610.2/49.64 [507.33-727.12]&quot; &quot;610.86/48.05 [513.2-769.58]&quot;
pd_baseline_id     &quot;3.47/0.47 [2.35-4.56]&quot;       &quot;3.36/0.54 [2.32-5.88]&quot;      
srs                &quot;100.66/29.09 [20-157]&quot;       &quot;29.15/29.12 [1-113]&quot;        
rbs_total          &quot;20.69/15.33 [0-73]&quot;          &quot;2.7/5.9 [0-34]&quot;             
sdq_total          &quot;17.75/6.37 [3-34]&quot;           &quot;8.66/7.23 [0-29]&quot;           
adhd_inatt         &quot;5.18/3.16 [0-9]&quot;             &quot;1.66/2.58 [0-9]&quot;            
adhd_hyper         &quot;3.15/2.85 [0-9]&quot;             &quot;0.91/1.82 [0-7]&quot;            
anx_beck           &quot;14.94/10.67 [0-51]&quot;          &quot;8.69/7.66 [0-29]&quot;           
dep_beck           &quot;13.52/11.11 [0-55]&quot;          &quot;8.26/9 [0-39]&quot;              
                   groupdiff_p
n_group            &quot;-&quot;        
gender             &quot;0.267&quot;    
timepoints         &quot;0.819&quot;    
age                &quot;0.067&quot;    
iq                 &quot;0.023&quot;    
piq                &quot;0.1&quot;      
viq                &quot;0.016&quot;    
missing_data_trial &quot;0.908&quot;    
sampling_rate      &quot;0.216&quot;    
center_dev_id      &quot;0.176&quot;    
screen_dist_id     &quot;0.92&quot;     
pd_baseline_id     &quot;0.1&quot;      
srs                &quot;&lt;0.001&quot;   
rbs_total          &quot;&lt;0.001&quot;   
sdq_total          &quot;&lt;0.001&quot;   
adhd_inatt         &quot;&lt;0.001&quot;   
adhd_hyper         &quot;&lt;0.001&quot;   
anx_beck           &quot;&lt;0.001&quot;   
dep_beck           &quot;&lt;0.001&quot;   </code></pre>
<pre class="r"><code>table_sample</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Sample description
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
autistic individuals (ASD)
</th>
<th style="text-align:left;">
non-autistic individuals (NTC)
</th>
<th style="text-align:left;">
group difference (p)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
139
</td>
<td style="text-align:left;">
88
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
gender (F/M)
</td>
<td style="text-align:left;">
101/38
</td>
<td style="text-align:left;">
57/31
</td>
<td style="text-align:left;">
0.267
</td>
</tr>
<tr>
<td style="text-align:left;">
timepoints (1/2/1+2)
</td>
<td style="text-align:left;">
43/51/45
</td>
<td style="text-align:left;">
25/31/32
</td>
<td style="text-align:left;">
0.819
</td>
</tr>
<tr>
<td style="text-align:left;">
age (in years)
</td>
<td style="text-align:left;">
16.13/5.48 [6.24-27.35]
</td>
<td style="text-align:left;">
17.59/6.03 [6.24-30.98]
</td>
<td style="text-align:left;">
0.067
</td>
</tr>
<tr>
<td style="text-align:left;">
IQ
</td>
<td style="text-align:left;">
97.55/21.33 [40-148]
</td>
<td style="text-align:left;">
103.91/19.55 [52-142]
</td>
<td style="text-align:left;">
0.023
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:left;">
99.18/20.79 [45-137]
</td>
<td style="text-align:left;">
103.66/19.28 [51-137]
</td>
<td style="text-align:left;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
verbal IQ
</td>
<td style="text-align:left;">
95.91/21.06 [45-160]
</td>
<td style="text-align:left;">
102.63/19.33 [51-143]
</td>
<td style="text-align:left;">
0.016
</td>
</tr>
<tr>
<td style="text-align:left;">
missing data per trial (%)
</td>
<td style="text-align:left;">
1.82/1.25 [0.21-6.79]
</td>
<td style="text-align:left;">
1.84/1.29 [0.27-8.42]
</td>
<td style="text-align:left;">
0.908
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate (300Hz / 120Hz)
</td>
<td style="text-align:left;">
132/59
</td>
<td style="text-align:left;">
81/50
</td>
<td style="text-align:left;">
0.216
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation (%)
</td>
<td style="text-align:left;">
13.19/5.76 [3.45-28.95]
</td>
<td style="text-align:left;">
12.12/5.86 [3.28-28.96]
</td>
<td style="text-align:left;">
0.176
</td>
</tr>
<tr>
<td style="text-align:left;">
screen distance (mm)
</td>
<td style="text-align:left;">
610.2/49.64 [507.33-727.12]
</td>
<td style="text-align:left;">
610.86/48.05 [513.2-769.58]
</td>
<td style="text-align:left;">
0.92
</td>
</tr>
<tr>
<td style="text-align:left;">
mean pupil size (mm)
</td>
<td style="text-align:left;">
3.47/0.47 [2.35-4.56]
</td>
<td style="text-align:left;">
3.36/0.54 [2.32-5.88]
</td>
<td style="text-align:left;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
SRS (total)
</td>
<td style="text-align:left;">
100.66/29.09 [20-157]
</td>
<td style="text-align:left;">
29.15/29.12 [1-113]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
RBS (total)
</td>
<td style="text-align:left;">
20.69/15.33 [0-73]
</td>
<td style="text-align:left;">
2.7/5.9 [0-34]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
SDQ (total)
</td>
<td style="text-align:left;">
17.75/6.37 [3-34]
</td>
<td style="text-align:left;">
8.66/7.23 [0-29]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
ADHD inattention
</td>
<td style="text-align:left;">
5.18/3.16 [0-9]
</td>
<td style="text-align:left;">
1.66/2.58 [0-9]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
ADHD hyperactivity
</td>
<td style="text-align:left;">
3.15/2.85 [0-9]
</td>
<td style="text-align:left;">
0.91/1.82 [0-7]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
BAI (anxiety)
</td>
<td style="text-align:left;">
14.94/10.67 [0-51]
</td>
<td style="text-align:left;">
8.69/7.66 [0-29]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
BDI (depression)
</td>
<td style="text-align:left;">
13.52/11.11 [0-55]
</td>
<td style="text-align:left;">
8.26/9 [0-39]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table></li>
</ul>
<pre class="r"><code>save_kable(table_sample, file=paste0(project_path,&#39;/output/table_sampledescription.html&#39;))</code></pre>
</div>
<div id="group-differences-of-dependent-variables-per-participant"
class="section level1">
<h1>group differences of dependent variables (per participant)</h1>
<pre class="r"><code>#BPS
summary(lm&lt;-lm(scale(pd)~t1_diagnosis,df_timepoint))</code></pre>
<pre><code>
Call:
lm(formula = scale(pd) ~ t1_diagnosis, data = df_timepoint)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2080 -0.6811 -0.1461  0.6637  4.8262 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)          0.10464    0.07189   1.456   0.1465  
t1_diagnosisControl -0.25722    0.11271  -2.282   0.0231 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9935 on 320 degrees of freedom
Multiple R-squared:  0.01602,   Adjusted R-squared:  0.01294 
F-statistic: 5.208 on 1 and 320 DF,  p-value: 0.02313</code></pre>
<pre class="r"><code>cohens_d(x=scale(pd)~t1_diagnosis,data=df_timepoint)</code></pre>
<pre><code>Cohen&#39;s d |       95% CI
------------------------
0.26      | [0.04, 0.48]

- Estimated using pooled SD.</code></pre>
<pre class="r"><code>#NG
summary(lm(scale(gain_pcdm)~t1_diagnosis,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))</code></pre>
<pre><code>
Call:
lm(formula = scale(gain_pcdm) ~ t1_diagnosis, data = df_timepoint[df_timepoint$Rsq_pcdm &gt; 
    0.2, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1775 -0.3402 -0.1553  0.1973  3.1694 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)           0.1628     0.1152   1.413   0.1601  
t1_diagnosisControl  -0.4005     0.1807  -2.217   0.0285 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9843 on 121 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.03902,   Adjusted R-squared:  0.03108 
F-statistic: 4.913 on 1 and 121 DF,  p-value: 0.02852</code></pre>
<pre class="r"><code>cohens_d(x=scale(pd)~t1_diagnosis,data=df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])</code></pre>
<pre><code>Cohen&#39;s d |       95% CI
------------------------
0.41      | [0.09, 0.73]

- Estimated using pooled SD.</code></pre>
</div>
<div id="covariate-effects-on-dependent-variables-per-participant"
class="section level1">
<h1>covariate effects on dependent variables (per participant)</h1>
<pre class="r"><code>#BPS
c(summary(lm(scale(pd)~scale(ageyrs),df_timepoint))[[&#39;coefficients&#39;]][2,1],
      confint(lm(scale(pd)~scale(ageyrs),df_timepoint))[2,])</code></pre>
<pre><code>                2.5 %     97.5 % 
-0.3848224 -0.4863341 -0.2833108 </code></pre>
<pre class="r"><code>#MMN - standards 
c(summary(lm(scale(mmn.201)~scale(ageyrs),df_timepoint))[[&#39;coefficients&#39;]][2,1],
      confint(lm(scale(mmn.201)~scale(ageyrs),df_timepoint))[2,])</code></pre>
<pre><code>              2.5 %    97.5 % 
0.5966341 0.4842925 0.7089757 </code></pre>
<pre class="r"><code>#MMN - pitch oddballs 
c(summary(lm(scale(mmn.202)~scale(ageyrs),df_timepoint))[[&#39;coefficients&#39;]][2,1],
      confint(lm(scale(mmn.202)~scale(ageyrs),df_timepoint))[2,])</code></pre>
<pre><code>              2.5 %    97.5 % 
0.5587295 0.4423915 0.6750675 </code></pre>
<pre class="r"><code>#MMN - length oddballs 
c(summary(lm(scale(mmn.203)~scale(ageyrs),df_timepoint))[[&#39;coefficients&#39;]][2,1],
      confint(lm(scale(mmn.203)~scale(ageyrs),df_timepoint))[2,])</code></pre>
<pre><code>              2.5 %    97.5 % 
0.6063284 0.4939439 0.7187129 </code></pre>
<pre class="r"><code>#MMN - pitch &amp; length oddballs
c(summary(lm(scale(mmn.204)~scale(ageyrs),df_timepoint))[[&#39;coefficients&#39;]][2,1],
      confint(lm(scale(mmn.204)~scale(ageyrs),df_timepoint))[2,])</code></pre>
<pre><code>              2.5 %    97.5 % 
0.5168204 0.3973653 0.6362755 </code></pre>
</div>
<div id="associations-of-dependent-variables-per-participant"
class="section level1">
<h1>associations of dependent variables (per participant)</h1>
<p>correlation coefficients on per-participant level of</p>
<li>
pupillary measure: baseline pupil size (BPS)
</li>
<li>
pupillary measure: stimulus-evoked pupilalry response (SEPR)
</li>
<li>
EEG measure: mismatch negativity (MMN)
</li>
<li>
computational model: neural gain (NG)
</li>
<p>Event Data coding</p>
<li>
201 = standard
</li>
<li>
202 = pitch
</li>
<li>
203 = length
</li>
<li>
204 = pitch &amp; length
</li>
<pre class="r"><code>rm(gain_pcdm)
attach(df_timepoint)

cor_table&lt;-data.frame(t(cbind(

#SEPR -PD
cbind(cor.test(rpd_auc.201,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.202,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.203,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.204,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),

#SEPR - MMN --&gt; uncorrelated
cbind(cor.test(rpd_auc.201,mmn.201)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.202,mmn.202)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.203,mmn.203)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(rpd_auc.204,mmn.204)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),

#BPS - MMN --&gt; substantial negative correlations
cbind(cor.test(pd,mmn.201)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(pd,mmn.202)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(pd,mmn.203)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(pd,mmn.204)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),

# NG - BPS
cbind(cor.test(gain_pcdm,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,pd)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),

#NG - SEPR
cbind(cor.test(gain_pcdm,rpd_auc.201)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,rpd_auc.202)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,rpd_auc.203)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,rpd_auc.204)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),

#NG - MMN
cbind(cor.test(gain_pcdm,mmn.201)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,mmn.202)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,mmn.203)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)]),
cbind(cor.test(gain_pcdm,mmn.204)[c(&#39;data.name&#39;,&#39;estimate&#39;,&#39;p.value&#39;)])


)))


#format table
cor_table$data.name&lt;-unlist(cor_table$data.name)
cor_table$estimate&lt;-unlist(cor_table$estimate)
cor_table$p.value&lt;-unlist(cor_table$p.value)

cor_table$estimate&lt;-round(cor_table$estimate,4)
cor_table$p.value&lt;-round(cor_table$p.value,4)

cor_table$data.name&lt;-gsub(&#39;rpd_auc&#39;,&#39;SEPR&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;pd&#39;,&#39;BPS&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;gain_pcdm&#39;,&#39;NG&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;mmn&#39;,&#39;MMN&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;.201&#39;,&#39; (standard)&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;.202&#39;,&#39; (pitch oddball)&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;.203&#39;,&#39; (length oddball)&#39;,cor_table$data.name)
cor_table$data.name&lt;-gsub(&#39;.204&#39;,&#39; (pitch+length oddball)&#39;,cor_table$data.name)



#Bonferroni correction
number_of_comparisons&lt;-nrow(cor_table)
cor_table$p_adjust&lt;-cor_table$p.value*number_of_comparisons
cor_table$p_adjust&lt;-ifelse(cor_table$p_adjust&gt;1,1,cor_table$p_adjust)

#produce table
cor_table_format&lt;-cor_table %&gt;%
    kbl(caption = &quot;correlations of baseline pupil size (BPS), 
        stimulus-evoked pupillary response (SEPR), 
        mismatch negativity (MMN), and neural gain (NG) for different stimuli.&quot;,
        col.names = c(&#39;correlation&#39;,&#39;coefficient (r)&#39;,&#39;p&#39;,&#39;p adjusted&#39;)) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

cor_table_format</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
correlations of baseline pupil size (BPS), stimulus-evoked pupillary
response (SEPR), mismatch negativity (MMN), and neural gain (NG) for
different stimuli.
</caption>
<thead>
<tr>
<th style="text-align:left;">
correlation
</th>
<th style="text-align:right;">
coefficient (r)
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SEPR (standard) and BPS
</td>
<td style="text-align:right;">
0.0647
</td>
<td style="text-align:right;">
0.2466
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (pitch oddball) and BPS
</td>
<td style="text-align:right;">
-0.0361
</td>
<td style="text-align:right;">
0.5230
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (length oddball) and BPS
</td>
<td style="text-align:right;">
0.1512
</td>
<td style="text-align:right;">
0.0069
</td>
<td style="text-align:right;">
0.1656
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (pitch+length oddball) and BPS
</td>
<td style="text-align:right;">
-0.1502
</td>
<td style="text-align:right;">
0.0074
</td>
<td style="text-align:right;">
0.1776
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (standard) and MMN (standard)
</td>
<td style="text-align:right;">
-0.0445
</td>
<td style="text-align:right;">
0.4915
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (pitch oddball) and MMN (pitch oddball)
</td>
<td style="text-align:right;">
0.0731
</td>
<td style="text-align:right;">
0.2595
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (length oddball) and MMN (length oddball)
</td>
<td style="text-align:right;">
0.0387
</td>
<td style="text-align:right;">
0.5510
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR (pitch+length oddball) and MMN (pitch+length oddball)
</td>
<td style="text-align:right;">
-0.0063
</td>
<td style="text-align:right;">
0.9227
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS and MMN (standard)
</td>
<td style="text-align:right;">
-0.1947
</td>
<td style="text-align:right;">
0.0024
</td>
<td style="text-align:right;">
0.0576
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS and MMN (pitch oddball)
</td>
<td style="text-align:right;">
-0.2292
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0072
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS and MMN (length oddball)
</td>
<td style="text-align:right;">
-0.2151
</td>
<td style="text-align:right;">
0.0008
</td>
<td style="text-align:right;">
0.0192
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS and MMN (pitch+length oddball)
</td>
<td style="text-align:right;">
-0.2008
</td>
<td style="text-align:right;">
0.0018
</td>
<td style="text-align:right;">
0.0432
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and BPS
</td>
<td style="text-align:right;">
-0.0159
</td>
<td style="text-align:right;">
0.7964
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and BPS
</td>
<td style="text-align:right;">
-0.0159
</td>
<td style="text-align:right;">
0.7964
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and BPS
</td>
<td style="text-align:right;">
-0.0159
</td>
<td style="text-align:right;">
0.7964
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and BPS
</td>
<td style="text-align:right;">
-0.0159
</td>
<td style="text-align:right;">
0.7964
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and SEPR (standard)
</td>
<td style="text-align:right;">
-0.0053
</td>
<td style="text-align:right;">
0.9318
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and SEPR (pitch oddball)
</td>
<td style="text-align:right;">
0.0055
</td>
<td style="text-align:right;">
0.9292
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and SEPR (length oddball)
</td>
<td style="text-align:right;">
-0.0427
</td>
<td style="text-align:right;">
0.4897
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and SEPR (pitch+length oddball)
</td>
<td style="text-align:right;">
-0.0906
</td>
<td style="text-align:right;">
0.1429
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and MMN (standard)
</td>
<td style="text-align:right;">
-0.0198
</td>
<td style="text-align:right;">
0.7835
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and MMN (pitch oddball)
</td>
<td style="text-align:right;">
-0.0597
</td>
<td style="text-align:right;">
0.4055
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and MMN (length oddball)
</td>
<td style="text-align:right;">
-0.1025
</td>
<td style="text-align:right;">
0.1530
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
NG and MMN (pitch+length oddball)
</td>
<td style="text-align:right;">
-0.0393
</td>
<td style="text-align:right;">
0.5840
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(cor_table_format,file=paste0(project_path,&#39;/output/supplements/associations_DV_perparticipant.html&#39;))</code></pre>
</div>
<div id="association-of-dependent-variables-per-trial"
class="section level1">
<h1>association of dependent variables (per trial)</h1>
<pre class="r"><code>#interrelation of BPS and SEPR
lmm&lt;-lmer(scale(rpd_auc)~scale(pd_baseline)+
            (1|subjects)+(1|wave),data=df_trial)
anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                   Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(pd_baseline)  10572   10572     1 202742   10999 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>cbind(round(fixef(lmm)[&#39;scale(pd_baseline)&#39;],2),
              round(confint(lmm,parm = &#39;scale(pd_baseline)&#39;),2))</code></pre>
<pre><code>                         2.5 % 97.5 %
scale(pd_baseline) -0.37 -0.37  -0.36</code></pre>
<pre class="r"><code>#model fit
r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.206
     Marginal R2: 0.110</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(rpd_auc)~scale(pd_baseline)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(rpd_auc)~1+
                   (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] Inf</code></pre>
<pre class="r"><code> # data - create greta arrays
    x &lt;- as_data(scale(df_trial$pd_baseline))</code></pre>
<pre class="r"><code>    y &lt;- as_data(scale(df_trial$rpd_auc))
    subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

    
    # variables and priors
    int &lt;- normal(0, 1)
    coef &lt;- normal(0, 1)
    sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
    a_subject &lt;- normal(0, 1, dim = max(subject_id))

    # operations
    mean &lt;- int + coef * x + a_subject[subject_id]

    # likelihood - distribution over data
    distribution(y) &lt;- normal(mean, sd)

    # defining the model
    m &lt;- model(int, coef, sd)

    # plotting
    #require(DiagrammeR)
    plot(m)</code></pre>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ee605e591035ac3eda2c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ee605e591035ac3eda2c">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\",\n       rankdir = \"LR\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"int\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#E0D2EE\", width = \"0.6\", height = \"0.48\", fillcolor = \"#F4F0F9\"] \n  \"2\" [label = \"normal\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"diamond\", color = \"#B797D7\", width = \"1\", height = \"0.8\", fillcolor = \"#E0D2EE\"] \n  \"3\" [label = \"0\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"4\" [label = \"1\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"5\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"6\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"7\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"8\" [label = \"mean\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"9\" [label = \"normal\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"diamond\", color = \"#B797D7\", width = \"1\", height = \"0.8\", fillcolor = \"#E0D2EE\"] \n  \"10\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"11\" [label = \"sd\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#E0D2EE\", width = \"0.6\", height = \"0.48\", fillcolor = \"#F4F0F9\"] \n  \"12\" [label = \"student\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"diamond\", color = \"#B797D7\", width = \"1\", height = \"0.8\", fillcolor = \"#E0D2EE\"] \n  \"13\" [label = \"3\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"14\" [label = \"0\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"15\" [label = \"1\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"16\" [label = \"y\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"17\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"18\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"19\" [label = \"a_subject\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#E0D2EE\", width = \"0.6\", height = \"0.48\", fillcolor = \"#F4F0F9\"] \n  \"20\" [label = \"normal\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"diamond\", color = \"#B797D7\", width = \"1\", height = \"0.8\", fillcolor = \"#E0D2EE\"] \n  \"21\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"22\" [label = \"0\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"23\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"24\" [label = \"1\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"25\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"26\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"27\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"28\" [label = \"coef\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#E0D2EE\", width = \"0.6\", height = \"0.48\", fillcolor = \"#F4F0F9\"] \n  \"29\" [label = \"normal\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"diamond\", color = \"#B797D7\", width = \"1\", height = \"0.8\", fillcolor = \"#E0D2EE\"] \n  \"30\" [label = \"0\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"31\" [label = \"1\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n  \"32\" [label = \"\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"lightgray\", width = \"0.2\", height = \"0.16\", fillcolor = \"#D3D3D3\"] \n  \"33\" [label = \"x\n\", fontcolor = \"#8960B3\", fontsize = \"12\", penwidth = \"2\", shape = \"square\", color = \"#E0D2EE\", width = \"0.5\", height = \"0.4\", fillcolor = \"#FFFFFF\"] \n\"1\"->\"5\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"expand_dim\", style = \"solid\"] \n\"2\"->\"1\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", penwidth = \"3\", style = \"dashed\"] \n\"3\"->\"2\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"mean\", style = \"solid\"] \n\"4\"->\"2\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"sd\", style = \"solid\"] \n\"5\"->\"6\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"add\", style = \"solid\"] \n\"6\"->\"7\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"set_dim\", style = \"solid\"] \n\"7\"->\"8\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"add\", style = \"solid\"] \n\"8\"->\"9\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"mean\", style = \"solid\"] \n\"9\"->\"16\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", penwidth = \"3\", style = \"dashed\"] \n\"10\"->\"9\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"sd\", style = \"solid\"] \n\"11\"->\"10\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"expand_dim\", style = \"solid\"] \n\"12\"->\"11\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", penwidth = \"3\", style = \"dashed\"] \n\"13\"->\"12\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"df\", style = \"solid\"] \n\"14\"->\"12\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"mu\", style = \"solid\"] \n\"15\"->\"12\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"sigma\", style = \"solid\"] \n\"17\"->\"8\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"add\", style = \"solid\"] \n\"18\"->\"17\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"set_dim\", style = \"solid\"] \n\"19\"->\"18\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"extract\", style = \"solid\"] \n\"20\"->\"19\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", penwidth = \"3\", style = \"dashed\"] \n\"21\"->\"20\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"mean\", style = \"solid\"] \n\"22\"->\"21\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"expand_dim\", style = \"solid\"] \n\"23\"->\"20\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"sd\", style = \"solid\"] \n\"24\"->\"23\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"expand_dim\", style = \"solid\"] \n\"25\"->\"6\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"add\", style = \"solid\"] \n\"26\"->\"25\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"set_dim\", style = \"solid\"] \n\"27\"->\"26\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"multiply\", style = \"solid\"] \n\"28\"->\"27\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"expand_dim\", style = \"solid\"] \n\"29\"->\"28\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", penwidth = \"3\", style = \"dashed\"] \n\"30\"->\"29\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"mean\", style = \"solid\"] \n\"31\"->\"29\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"sd\", style = \"solid\"] \n\"32\"->\"26\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"multiply\", style = \"solid\"] \n\"33\"->\"32\" [color = \"Gainsboro\", fontname = \"Helvetica\", fontcolor = \"gray\", fontsize = \"11\", penwidth = \"3\", label = \"set_dim\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>    # sampling
    draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups)</code></pre>
<pre class="r"><code>    summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

         Mean       SD  Naive SE Time-series SE
int   0.01629 0.069193 3.868e-04      1.364e-02
coef -0.37037 0.003527 1.972e-05      4.719e-05
sd    0.98044 0.001253 7.007e-06      8.731e-06

2. Quantiles for each variable:

        2.5%      25%       50%      75%   97.5%
int  -0.1207 -0.03406  0.007404  0.07451  0.1344
coef -0.3773 -0.37273 -0.370336 -0.36796 -0.3635
sd    0.9780  0.97959  0.980439  0.98130  0.9829</code></pre>
<pre class="r"><code>    mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/BPS_SEPR_association_Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/BPS_SEPR_association_Bayesian-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    #posterior predictive checking
    coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

     Point est. Upper C.I.
int        1.43       2.09
coef       1.00       1.00
sd         1.00       1.00

Multivariate psrf

1.35</code></pre>
<pre class="r"><code>    coda::effectiveSize(draws) #ESS</code></pre>
<pre><code>        int        coef          sd 
   19.14415  5768.26852 20839.20538 </code></pre>
<pre class="r"><code>    #save model
    draws_SEPR_BPS&lt;-draws
    save(draws_SEPR_BPS,file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_BPS.Rdata&#39;))</code></pre>
<pre class="r"><code>###here use ID as random intercept (subject + wave) as MMN is only available for one timepoint

#interrelation of BPS and SEPR
lmm&lt;-lmer(scale(mmn)~scale(pd_baseline)*EventData+
            (1|id),data=df_trial)

anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                              Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
scale(pd_baseline)            13.524  13.524     1 16715 15.3996 8.736e-05 ***
EventData                    100.599  33.533     3 45439 38.1829 &lt; 2.2e-16 ***
scale(pd_baseline):EventData   4.954   1.651     3 45430  1.8802    0.1305    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>cbind(round(fixef(lmm)[&#39;scale(pd_baseline)&#39;],2),
              round(confint(lmm,parm = &#39;scale(pd_baseline)&#39;),2))</code></pre>
<pre><code>                         2.5 % 97.5 %
scale(pd_baseline) -0.02 -0.04      0</code></pre>
<pre class="r"><code>#model fit
r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.127
     Marginal R2: 0.003</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(mmn)~scale(pd_baseline)+EventData+
              (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~EventData+
                   (1|id),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] 6.84896</code></pre>
<pre class="r"><code>###here use ID as random intercept (subject + wave) as MMN is only available for one timepoint

#interrelation of BPS and SEPR
lmm&lt;-lmer(scale(mmn)~scale(rpd_auc)*EventData+
            (1|id),data=df_trial)

anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                         Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
scale(rpd_auc)           17.266  17.266     1 45406 19.6637 9.255e-06 ***
EventData                99.913  33.304     3 45438 37.9286 &lt; 2.2e-16 ***
scale(rpd_auc):EventData  0.831   0.277     3 45401  0.3153    0.8143    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>cbind(round(fixef(lmm)[&#39;scale(rpd_auc)&#39;],2),
              round(confint(lmm,parm = &#39;scale(rpd_auc)&#39;),2))</code></pre>
<pre><code>                    2.5 % 97.5 %
scale(rpd_auc) 0.02  0.01   0.04</code></pre>
<pre class="r"><code>#model fit
r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.129
     Marginal R2: 0.003</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(mmn)~scale(rpd_auc)+
              (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~1+
                   (1|id),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] 56.29533</code></pre>
</div>
<div
id="composite-figure---pupil-size-and-fz-amplitude-change-within-trials"
class="section level1">
<h1>composite figure - pupil size and Fz amplitude change within
trials</h1>
<p>visualization of pupile size change (BPS,SEPR) and Fz amplitude
change (MMN) within trials</p>
<div id="mmn---scalp-topography-part-1" class="section level2">
<h2>MMN - scalp topography (part 1)</h2>
<pre class="r"><code>#load all EEG channel data - LARGE FILE ON DIFFERENT DRIVE
load(file=localation_of_EEG_allchannel_data)

#for standard coordinates of electrodes
data(eegcoord) #load sample set with standard coordinates
#rownames(eegcoord) #names of channels

###select only participants that are in final sample
subjects_in_list&lt;-substr(names(list_mmn),10,22)
subjects_in_list&lt;-sub(&#39;/&#39;,&#39;&#39;,subjects_in_list)
subjects_in_list&lt;-sub(&#39;_&#39;,&#39;&#39;,subjects_in_list)
list_elements_in_final_sample&lt;-which(subjects_in_list %in% unique(df_trial$subjects))
list_eeg_selected&lt;-list_eeg[list_elements_in_final_sample]

#participants_to_sample&lt;-round(length(list_eeg)/4*fraction_to_sample)
participants_to_sample&lt;-round(length(list_eeg_selected)/4*fraction_to_sample)

#select 30 random from each condition - same participants
combined_sampled&lt;-sample(1:(length(list_eeg_selected)/4),participants_to_sample)
duration_sampled&lt;-combined_sampled+length(list_eeg_selected)/4
frequency_sampled&lt;-combined_sampled+2*length(list_eeg_selected)/4
standard_sampled&lt;-combined_sampled+3*length(list_eeg_selected)/4

select_samples&lt;-c(combined_sampled,
                  duration_sampled,
                  frequency_sampled,
                  standard_sampled)

#select thirty random participants - from participants that have ET data
list_eeg_selected&lt;-list_eeg_selected[select_samples]

fun_prepare_channeldata_plotting&lt;-function(one_set,sample_coordinates){

  ##testing
  # one_set&lt;-list_eeg_selected[[1]]
  # sample_coordinates&lt;-eegcoord
  
  #match names of sample coordnisates and data set
  names(one_set)&lt;-toupper(names(one_set)) #capitalize names - naming convention of eegkit
  sample_coordinates&lt;-sample_coordinates[rownames(sample_coordinates) %in% names(one_set),]
  sample_coordinates$variable&lt;-rownames(sample_coordinates)


  #limit site to interested timeframe - 150-250 ms after trial onset
  one_set&lt;-one_set[one_set$TIMES &gt;= 150 &amp; one_set$TIMES &lt;= 250,]
      ###--&gt; less flexibel but reduces file size
  
  #melt to long format
  one_set$TIMES&lt;-as.factor(one_set$TIMES) #preserve in melting
  one_set&lt;-reshape2::melt(one_set,value.name=&#39;amplitude&#39;) #convert to long format

  #merge with sampel coordinates
  one_set&lt;-merge(one_set,sample_coordinates,by=&#39;variable&#39;) #merge with sample coordniates
  names(one_set)[1]&lt;-&#39;electrode&#39; #set name for later plotting function
  one_set$TIMES&lt;-as.numeric(levels(one_set$TIMES))[one_set$TIMES]
  
  return(one_set)

      }

#takes around 20 minutes
list_eeg_selected&lt;-pblapply(list_eeg_selected,fun_prepare_channeldata_plotting,sample_coordinates=eegcoord)
df_plot&lt;-data.table::rbindlist(list_eeg_selected)

#scalp topography separated for condition
limits_of_plotted_range&lt;-c(-3,3)

gf_4a&lt;-topoplot(df_plot[df_plot$CONDITION==&#39;standard&#39;,], 
         interp_limit=&#39;head&#39;,limits=limits_of_plotted_range)+labs(title=&#39;standard&#39;) #scale coordniates to head

gf_4b&lt;-topoplot(df_plot[df_plot$CONDITION==&#39;frequenc&#39;,], 
         interp_limit=&#39;head&#39;,limits=limits_of_plotted_range)+labs(title=&#39;pitch oddball&#39;) #scale coordniates to head

gf_4c&lt;-topoplot(df_plot[df_plot$CONDITION==&#39;duration&#39;,], 
         interp_limit=&#39;head&#39;,limits=limits_of_plotted_range)+labs(title=&#39;length oddball&#39;) #scale coordniates to head

gf_4d&lt;-topoplot(df_plot[df_plot$CONDITION==&#39;combined&#39;,],
         interp_limit=&#39;head&#39;,limits=limits_of_plotted_range)+labs(title=&#39;pitch &amp; length oddball&#39;) #scale coordniates to head


#extract legend
g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}

mylegend&lt;-g_legend(gf_4a)

#plot in markdown
grid.arrange(
  arrangeGrob(
    gf_4a + theme(legend.position=&quot;none&quot;),
    gf_4b + theme(legend.position=&quot;none&quot;),
    gf_4c + theme(legend.position=&quot;none&quot;),
    gf_4d + theme(legend.position=&quot;none&quot;),nrow=2),
  mylegend, ncol=2, widths=c(5,1))</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/scalp%20topography-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="mmn---fz-amplitude-change-within-trials-part-2"
class="section level2">
<h2>MMN - Fz amplitude change within trials (part 2)</h2>
<pre class="r"><code>df_eeg&lt;-data.table::rbindlist(list_eeg_redux) ##very fast compared to do.call(rbind)

subsample&lt;-sample(1:nrow(df_eeg),nrow(df_eeg)/sampling_factor) # select 10% of data for faster plotting

    ### use participants selected for scalp topography - much slower and same results
    # df_eeg$ID&lt;-sub(&#39;/&#39;,&#39;&#39;,df_eeg$ID)
    # df_eeg$ID&lt;-sub(&#39;_&#39;,&#39;&#39;,df_eeg$ID)
    # selected_participants&lt;-substr(names(list_mmn)[combined_sampled],10,21)
    # subsample&lt;-which(df_eeg$ID %in% selected_participants)

custom_condition_colors &lt;- rev(wes_palette(&#39;FantasticFox1&#39;,5,type=&#39;discrete&#39;)[2:5]) #reverse custom colors to match color coding in other figures

gf_1&lt;-ggplot(df_eeg[subsample,],aes(x=times/1000,y=Fz,group=condition,color=condition,fill=condition))+
  geom_smooth()+
  labs(y=&#39;electrode Fz - amplitute (uV)&#39;,x=&#39;trial duration (s)&#39;)+
  scale_fill_manual(values = custom_condition_colors, labels=c(&quot;standard&quot; = &quot;standard&quot;, &quot;frequenc&quot; = &quot;pitch oddball&quot;, &quot;duration&quot; = &quot;length oddball &quot;, &quot;combined&quot; = &quot;pitch &amp; length oddball&quot;))+
  scale_color_manual(values = custom_condition_colors, labels=c(&quot;standard&quot; = &quot;standard&quot;, &quot;frequenc&quot; = &quot;pitch oddball&quot;, &quot;duration&quot; = &quot;length oddball &quot;, &quot;combined&quot; = &quot;pitch &amp; length oddball&quot;))+
  xlim(-0.1,0.6) #allign with eye-tracking epoch for plotting

#gf_1</code></pre>
</div>
<div
id="pupil-size-change-within-trial---progression-between-groups-part-34"
class="section level2">
<h2>pupil size change within trial - progression between groups (part
3+4)</h2>
<pre class="r"><code>#sample data
sampled_df&lt;-df[sample(1:nrow(df),nrow(df)/sampling_factor),]
#ON FULL DATA - takes 1hour+ to complete

gf_2&lt;-ggplot(sampled_df[sampled_df$time_event&lt;0.6,],aes(x=time_event,y=rpd,group=EventData,color=EventData,fill=EventData))+
  geom_smooth(alpha=0.4)+
  labs(x=&#39;trial duration (s)&#39;,y=&#39;pupil size (mm)&#39;)+
  scale_fill_manual(values = custom_condition_colors[c(1,3,2,4)], labels=c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball &quot;, &quot;204&quot; = &quot;pitch &amp; length oddball&quot;))+ #[c(1,3,2,4)] = colors like EEG fig
  scale_color_manual(values = custom_condition_colors[c(1,3,2,4)], labels=c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball &quot;, &quot;204&quot; = &quot;pitch &amp; length oddball&quot;))+
  xlim(-0.1,0.6) #allign with eeg epoch


#add demographics data
df_dem_merge&lt;-df_dem[,c(&#39;subjects&#39;,&#39;t1_group&#39;,&#39;t1_diagnosis&#39;,&#39;t1_sex&#39;,&#39;t1_ageyrs&#39;,&#39;t2_ageyrs&#39;,&#39;t1_fsiq&#39;,&#39;t1_piq&#39;,&#39;t1_viq&#39;)]
df_dem_merge$subjects&lt;-as.character(df_dem_merge$subjects)
sampled_df$subjects&lt;-substr(sampled_df$id,1,12)
sampled_df&lt;-merge(sampled_df,df_dem_merge,by=&#39;subjects&#39;) ###--&gt; takes a while

    
#define quartiles
sampled_df$trial_position&lt;-ifelse(sampled_df$EventCounter&lt;350,&#39;first quarter&#39;,
  ifelse(sampled_df$EventCounter&gt;1050,&#39;last quarter&#39;,
         ifelse(sampled_df$EventCounter&gt;=350 &amp; sampled_df$EventCounter&lt;=700,&#39;second quarter&#39;,
                ifelse(sampled_df$EventCounter&gt;700 &amp; sampled_df$EventCounter&lt;=1050,&#39;third quarter&#39;,NA
                                       ))))

sampled_df$trial_position&lt;-factor(sampled_df$trial_position,
                                  levels=c(&#39;first quarter&#39;,&#39;second quarter&#39;,&#39;third quarter&#39;,&#39;last quarter&#39;))

#plot split by group and quartiles
gf_3&lt;-ggplot(sampled_df[sampled_df$time_event&lt;0.60 &amp; !is.na(sampled_df$trial_position),],
       aes(x=time_event,y=rpd,group=interaction(t1_diagnosis,EventData),
           color=EventData,fill=EventData,linetype=t1_diagnosis))+
  facet_grid(EventData ~ trial_position)+
  geom_smooth()+
  #geom_smooth(formula = y ~ x + poly(x,4))
  scale_linetype_discrete(labels=c(&quot;ASD&quot; = &quot;autistic&quot;, &quot;Control&quot; = &quot;non-autistic&quot;))+
  scale_fill_manual(values = custom_condition_colors,
                     labels=c(&quot;201&quot; = &quot;standard&quot;,
                              &quot;202&quot; = &quot;pitch oddball&quot;,
                              &quot;203&quot; = &quot;length oddball &quot;,
                              &quot;204&quot; = &quot;pitch &amp; length oddball&quot;))+
  scale_color_manual(values = custom_condition_colors,
                     labels=c(&quot;201&quot; = &quot;standard&quot;,
                              &quot;202&quot; = &quot;pitch oddball&quot;,
                              &quot;203&quot; = &quot;length oddball &quot;,
                              &quot;204&quot; = &quot;pitch &amp; length oddball&quot;))+
  labs(x=&#39;trial duration (s)&#39;,y=&#39;pupil size (mm)&#39;,color=&#39;stimulus&#39;,fill=&#39;stimulus&#39;,linetype=&#39;group&#39;)+
  theme(strip.text.y = element_blank()) #remove labels on facet axis


#extract legend
g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}

mylegend_pupil&lt;-g_legend(gf_3)

#print in markdown
#grid.arrange(gf_2+theme(legend.position = &#39;none&#39;),gf_3,widths=c(1,1.3))    </code></pre>
</div>
<div id="save-composite-figure" class="section level2">
<h2>save composite figure</h2>
<pre class="r"><code>#save to file
tiff(file=paste0(project_path,&quot;/output/figures/figure_pupil_mmn_withintrial2.tiff&quot;), # create a file in tiff format in current working directory
     width=12, height=8, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(
  arrangeGrob(gf_2+theme(legend.position = &#39;none&#39;),
              gf_3+theme(legend.position = &#39;none&#39;),
              mylegend_pupil,ncol=3,widths=c(5,5,2)), #pupil size change Grob 
  arrangeGrob(gf_1+theme(legend.position = &#39;none&#39;), #MMN Grob
              arrangeGrob(
                gf_4a + theme(legend.position=&quot;none&quot;),
                gf_4b + theme(legend.position=&quot;none&quot;),
                gf_4c + theme(legend.position=&quot;none&quot;),
                gf_4d + theme(legend.position=&quot;none&quot;),nrow=2),
              mylegend, ncol=3, widths=c(5,5,2)),
  nrow=2)

dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="task-effects" class="section level1">
<h1>task effects</h1>
<p>investigates influence of stimulus and task progression on pupillary
measures (BPS, SEPR) and EEG measure (MMN) in separate linear mixed
models and supported by Bayesian posterior sampling</p>
<div id="task-condition-stimulus-effect" class="section level2">
<h2>task condition / stimulus effect</h2>
<pre class="r"><code>##BPS
## include trial characteristics - TRIAL CONDITION
lmm&lt;-lmer(scale(pd_baseline)~EventData+
            (1|subjects)+(1|wave),data=df_trial)

anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
          Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
EventData 12.573  4.1911     3 298709   16.11 1.816e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>emmeans(lmm,~EventData)</code></pre>
<pre><code> EventData  emmean     SE  df asymp.LCL asymp.UCL
 201       0.03432 0.0698 Inf    -0.102     0.171
 202       0.00965 0.0699 Inf    -0.127     0.147
 203       0.02492 0.0699 Inf    -0.112     0.162
 204       0.01919 0.0699 Inf    -0.118     0.156

Degrees-of-freedom method: asymptotic 
Results are given on the scale(3.41, 0.55) (not the response) scale. 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>confint(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                    estimate      SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202  0.02467 0.00432 Inf  0.013570  0.035777
 EventData201 - EventData203  0.00940 0.00400 Inf -0.000874  0.019669
 EventData201 - EventData204  0.01513 0.00389 Inf  0.005144  0.025121
 EventData202 - EventData203 -0.01528 0.00571 Inf -0.029938 -0.000615
 EventData202 - EventData204 -0.00954 0.00563 Inf -0.024006  0.004923
 EventData203 - EventData204  0.00573 0.00539 Inf -0.008102  0.019571

Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>###--&gt; 201 &gt; 202 + 204; 203 &gt; 202

      ###restricted to trial that are preceded by standards
      lmm_r&lt;-lmer(scale(pd_baseline)~EventData+
            (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position!=1,])

      anova(lmm_r)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
          Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
EventData 7.9209  2.6403     3 248309  10.148 1.114e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>      emmeans(lmm_r,~EventData)</code></pre>
<pre><code> EventData emmean     SE  df asymp.LCL asymp.UCL
 201       0.0343 0.0695 Inf    -0.102     0.171
 202       0.0151 0.0696 Inf    -0.121     0.152
 203       0.0316 0.0696 Inf    -0.105     0.168
 204       0.0196 0.0696 Inf    -0.117     0.156

Degrees-of-freedom method: asymptotic 
Results are given on the scale(3.41, 0.55) (not the response) scale. 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>      confint(contrast(emmeans(lmm_r,~EventData),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                    estimate      SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202  0.01920 0.00445 Inf   0.00778   0.03062
 EventData201 - EventData203  0.00274 0.00418 Inf  -0.00800   0.01349
 EventData201 - EventData204  0.01469 0.00392 Inf   0.00461   0.02476
 EventData202 - EventData203 -0.01646 0.00589 Inf  -0.03158  -0.00133
 EventData202 - EventData204 -0.00451 0.00570 Inf  -0.01916   0.01014
 EventData203 - EventData204  0.01194 0.00550 Inf  -0.00219   0.02608

Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.763
     Marginal R2: 0.000</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(pd_baseline)~EventData+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

# null_lmm_ML &lt;- lmer(scale(pd_baseline)~1+
#                    (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>    # data - create greta arrays
    y &lt;- as_data(scale(df_trial$pd_baseline))
    events &lt;- as_data(model.matrix(~ EventData - 1, df_trial)) #alternative to dummy coding?
    subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

    # variables and priors
    int &lt;- normal(0, 1)
    event_coef&lt;- normal(0, 1, dim=ncol(events))
    sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
    a_subject &lt;- normal(0, 1, dim = max(subject_id))

    # operations
    mean &lt;- events %*% event_coef + a_subject[subject_id]

    # likelihood - distribution over data
    distribution(y) &lt;- normal(mean, sd)

    # defining the model
    m &lt;- model(event_coef)

    # sampling
    draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups)</code></pre>
<pre class="r"><code>    summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                   Mean      SD  Naive SE Time-series SE
event_coef[1,1] 0.03139 0.04436 0.0002480        0.01087
event_coef[2,1] 0.00674 0.04456 0.0002491        0.01056
event_coef[3,1] 0.02194 0.04456 0.0002491        0.01031
event_coef[4,1] 0.01613 0.04449 0.0002487        0.01080

2. Quantiles for each variable:

                    2.5%       25%     50%     75%   97.5%
event_coef[1,1] -0.07498  0.001769 0.04319 0.06542 0.09367
event_coef[2,1] -0.10026 -0.022901 0.01825 0.04114 0.06935
event_coef[3,1] -0.08503 -0.007652 0.03320 0.05624 0.08500
event_coef[4,1] -0.09057 -0.013351 0.02745 0.05051 0.07874</code></pre>
<pre class="r"><code>    mcmc_intervals(draws, prob= .66, prob_outer = .95)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_BPS_Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_BPS_Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_BPS_Bayesian-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    #posterior predictive checking
    coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

                Point est. Upper C.I.
event_coef[1,1]       2.45       4.57
event_coef[2,1]       2.43       4.50
event_coef[3,1]       2.43       4.50
event_coef[4,1]       2.43       4.51

Multivariate psrf

2.09</code></pre>
<pre class="r"><code>    coda::effectiveSize(draws) #ESS</code></pre>
<pre><code>event_coef[1,1] event_coef[2,1] event_coef[3,1] event_coef[4,1] 
       21.00984        23.38021        24.69788        25.06928 </code></pre>
<pre class="r"><code>    #save model
    draws_BPS_trialcondition&lt;-draws
    save(draws_BPS_trialcondition,file=paste0(project_path,&#39;/data/Bayesian_model_BPS_trialcondition.Rdata&#39;))</code></pre>
<pre class="r"><code>##SEPR
  
## include trial characteristics - TRIAL CONDITION
lmm&lt;-lmer(scale(rpd_auc)~EventData+
            (1|subjects)+(1|wave),data=df_trial)

anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
          Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
EventData 125.41  41.802     3 298713  41.934 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>emmeans(lmm,~EventData)</code></pre>
<pre><code> EventData   emmean      SE  df asymp.LCL asymp.UCL
 201       -0.01286 0.00781 Inf   -0.0282   0.00244
 202        0.06041 0.01116 Inf    0.0385   0.08229
 203        0.00911 0.01069 Inf   -0.0118   0.03005
 204        0.04352 0.01053 Inf    0.0229   0.06415

Degrees-of-freedom method: asymptotic 
Results are given on the scale(-0.00104, 0.0336) (not the response) scale. 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>confint(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                    estimate      SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202  -0.0733 0.00846 Inf   -0.0950  -0.05154
 EventData201 - EventData203  -0.0220 0.00783 Inf   -0.0421  -0.00186
 EventData201 - EventData204  -0.0564 0.00761 Inf   -0.0759  -0.03683
 EventData202 - EventData203   0.0513 0.01117 Inf    0.0226   0.08000
 EventData202 - EventData204   0.0169 0.01102 Inf   -0.0114   0.04521
 EventData203 - EventData204  -0.0344 0.01054 Inf   -0.0615  -0.00733

Note: contrasts are still on the scale(-0.00104, 0.0336) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>###--&gt; 201 &gt; 202 + 204; 203 &gt; 202

r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.004
     Marginal R2: 0.000</code></pre>
<pre class="r"><code>#BIC Bayes Factor  
lmm_ML&lt;-lmer(scale(rpd_auc)~EventData+
          (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(rpd_auc)~1+
                 (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
BF_BIC</code></pre>
<pre><code>[1] 1.2541e+19</code></pre>
<pre class="r"><code>    # data - create greta arrays
    y &lt;- as_data(scale(df_trial$rpd_auc))
    events &lt;- as_data(model.matrix(~ EventData - 1, df_trial)) #alternative to dummy coding?
    subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

    # variables and priors
    int &lt;- normal(0, 1)
    event_coef&lt;- normal(0, 1, dim=ncol(events))
    sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
    a_subject &lt;- normal(0, 1, dim = max(subject_id))

    # operations
    mean &lt;- int + events %*% event_coef + a_subject[subject_id]

    # likelihood - distribution over data
    distribution(y) &lt;- normal(mean, sd)

    # defining the model
    m &lt;- model(event_coef)

    # sampling
    draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups)</code></pre>
<pre class="r"><code>    summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                     Mean     SD Naive SE Time-series SE
event_coef[1,1] -0.082036 0.7164 0.004005        0.04156
event_coef[2,1] -0.008615 0.7161 0.004003        0.03920
event_coef[3,1] -0.059768 0.7160 0.004002        0.04069
event_coef[4,1] -0.025302 0.7159 0.004002        0.03941

2. Quantiles for each variable:

                   2.5%     25%      50%    75%  97.5%
event_coef[1,1] -0.9668 -0.7673 -0.11450 0.7007 0.8163
event_coef[2,1] -0.8937 -0.6911 -0.04060 0.7725 0.8886
event_coef[3,1] -0.9440 -0.7418 -0.08983 0.7228 0.8397
event_coef[4,1] -0.9097 -0.7100 -0.05920 0.7554 0.8746</code></pre>
<pre class="r"><code>    mcmc_intervals(draws, prob= .66, prob_outer = .95)+scale_y_discrete(labels=c(&#39;standard&#39;,&#39;pitch oddball&#39;,&#39;length oddball&#39;,&#39;pitch &amp; length oddball&#39;))+coord_flip()+theme_bw()</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_SEPR_Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_SEPR_Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/stimulus_on_SEPR_Bayesian-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    #posterior predictive checking
    coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

                Point est. Upper C.I.
event_coef[1,1]       14.2       30.8
event_coef[2,1]       14.1       30.3
event_coef[3,1]       14.1       30.6
event_coef[4,1]       14.2       30.7

Multivariate psrf

11.6</code></pre>
<pre class="r"><code>    coda::effectiveSize(draws) #ESS</code></pre>
<pre><code>event_coef[1,1] event_coef[2,1] event_coef[3,1] event_coef[4,1] 
       15.92108        17.22336        16.62716        15.83413 </code></pre>
<pre class="r"><code>    #save model
    draws_SEPR_taskcondition&lt;-draws
    save(draws_SEPR_taskcondition,file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_taskcondition.Rdata&#39;))</code></pre>
<pre class="r"><code>## include trial characteristics - TRIAL CONDITION
lmm&lt;-lmer(scale(mmn)~EventData+
            (1|id),data=df_trial)

anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
          Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
EventData 98.902  32.967     3 45450  37.531 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>emmeans(lmm,~EventData)</code></pre>
<pre><code> EventData  emmean     SE  df asymp.LCL asymp.UCL
 201        0.0473 0.0247 Inf  -0.00103   0.09571
 202       -0.0314 0.0249 Inf  -0.08020   0.01738
 203       -0.0763 0.0249 Inf  -0.12505  -0.02747
 204       -0.0531 0.0248 Inf  -0.10184  -0.00445

Degrees-of-freedom method: asymptotic 
Results are given on the scale(-11.2, 9.21) (not the response) scale. 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>confint(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                    estimate     SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202   0.0788 0.0125 Inf    0.0466   0.11095
 EventData201 - EventData203   0.1236 0.0125 Inf    0.0915   0.15573
 EventData201 - EventData204   0.1005 0.0124 Inf    0.0686   0.13239
 EventData202 - EventData203   0.0448 0.0128 Inf    0.0120   0.07774
 EventData202 - EventData204   0.0217 0.0127 Inf   -0.0110   0.05442
 EventData203 - EventData204  -0.0231 0.0127 Inf   -0.0558   0.00958

Note: contrasts are still on the scale(-11.2, 9.21) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.129
     Marginal R2: 0.002</code></pre>
<pre class="r"><code>#BIC Bayes Factor  
lmm_ML&lt;-lmer(scale(mmn)~EventData+
          (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~1+
                 (1|id),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
BF_BIC</code></pre>
<pre><code>[1] 2.705976e+17</code></pre>
</div>
<div id="task-progression-effect" class="section level2">
<h2>task progression effect</h2>
<pre class="r"><code>## include trial characteristics - TASK PROGRESSION
  lmm&lt;-lmer(scale(pd_baseline)~stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial)
  
  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                             Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
stats::poly(EventCounter, 3) 832.22  277.41     3 298717  1077.7 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  cbind(round(fixef(lmm)[&#39;EventCounter&#39;],9),
                round(confint(lmm,parm = &#39;EventCounter&#39;),9))</code></pre>
<pre><code>      2.5 % 97.5 %</code></pre>
<pre class="r"><code>  confint(contrast(emmeans(lmm,~EventCounter,at=list(EventCounter =     seq(1,1400,699))),&#39;revpairwise&#39;))</code></pre>
<pre><code> contrast                           estimate      SE  df asymp.LCL asymp.UCL
 EventCounter700 - EventCounter1      0.1620 0.00415 Inf    0.1523   0.17178
 EventCounter1399 - EventCounter1    -0.0184 0.00589 Inf   -0.0322  -0.00463
 EventCounter1399 - EventCounter700  -0.1805 0.00445 Inf   -0.1909  -0.17005

Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<pre class="r"><code>r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.766
     Marginal R2: 0.003</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(pd_baseline)~stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(pd_baseline)~1+
                   (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] Inf</code></pre>
<pre class="r"><code> # data - create greta arrays
    y &lt;- as_data(scale(df_trial$pd_baseline))
    trials &lt;- as_data(scale(df_trial$EventCounter))
    subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

    
    # variables and priors
    int &lt;- normal(0, 1)
    coef &lt;- normal(0, 1)
    sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
    a_subject &lt;- normal(0, 1, dim = max(subject_id))

    # operations
    mean &lt;- int + coef * trials + a_subject[subject_id]

    # likelihood - distribution over data
    distribution(y) &lt;- normal(mean, sd)

    # defining the model
    m &lt;- model(int, coef, sd)

    # sampling
    draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups)</code></pre>
<pre class="r"><code>    summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

         Mean        SD  Naive SE Time-series SE
int   0.01263 0.0322684 1.804e-04      7.223e-03
coef -0.01174 0.0009458 5.287e-06      9.280e-06
sd    0.51048 0.0006656 3.721e-06      8.040e-06

2. Quantiles for each variable:

         2.5%       25%      50%      75%     97.5%
int  -0.05481 -0.009174  0.01325  0.03174  0.074534
coef -0.01357 -0.012376 -0.01174 -0.01111 -0.009867
sd    0.50918  0.510022  0.51048  0.51093  0.511783</code></pre>
<pre class="r"><code>    #diangostics
    mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/task%20progression%20on%20BPS%20-%20Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/task%20progression%20on%20BPS%20-%20Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    #posterior predictive checking
    coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

     Point est. Upper C.I.
int        1.68       2.69
coef       1.00       1.00
sd         1.00       1.00

Multivariate psrf

1.55</code></pre>
<pre class="r"><code>    coda::effectiveSize(draws) #ESS</code></pre>
<pre><code>        int        coef          sd 
   23.98781 10398.14669  6896.99115 </code></pre>
<pre class="r"><code>    #save model
    draws_BPS_taskprogression&lt;-draws
    save(draws_BPS_taskprogression,file=paste0(project_path,&#39;/data/Bayesian_model_BPS_taskprogression.Rdata&#39;))</code></pre>
<pre class="r"><code>## include trial characteristics - TASK PROGRESSION
  lmm&lt;-lmer(scale(rpd_auc)~EventCounter+
              (1|subjects)+(1|wave),data=df_trial)
  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
             Sum Sq Mean Sq NumDF  DenDF F value   Pr(&gt;F)   
EventCounter 6.9817  6.9817     1 289236  7.0011 0.008147 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  cbind(round(fixef(lmm)[&#39;EventCounter&#39;],9),
                round(confint(lmm,parm = &#39;EventCounter&#39;),9))</code></pre>
<pre><code>                               2.5 %     97.5 %
EventCounter -1.2017e-05 -2.0906e-05 -3.102e-06</code></pre>
<pre class="r"><code>  confint(contrast(emmeans(lmm,~EventCounter,at=list(EventCounter =   seq(1,1400,1399))),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1 - EventCounter1400   0.0168 0.00635 Inf   0.00436    0.0293

Note: contrasts are still on the scale(-0.00104, 0.0336) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.003
     Marginal R2: 0.000</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(rpd_auc)~EventCounter+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(rpd_auc)~1+
                   (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] 0.06010518</code></pre>
<pre class="r"><code> # data - create greta arrays
    y &lt;- as_data(scale(df_trial$rpd_auc))
    trials &lt;- as_data(scale(df_trial$EventCounter))
    subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

    
    # variables and priors
    int &lt;- normal(0, 1)
    coef &lt;- normal(0, 1)
    sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
    a_subject &lt;- normal(0, 1, dim = max(subject_id))

    # operations
    mean &lt;- coef * trials + a_subject[subject_id]

    # likelihood - distribution over data
    distribution(y) &lt;- normal(mean, sd)

    # defining the model
    m &lt;- model(coef)

    # sampling
    draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups)</code></pre>
<pre class="r"><code>    summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

          Mean             SD       Naive SE Time-series SE 
    -5.038e-03      1.865e-03      1.043e-05      2.390e-05 

2. Quantiles for each variable:

     2.5%       25%       50%       75%     97.5% 
-0.008667 -0.006303 -0.005054 -0.003770 -0.001400 </code></pre>
<pre class="r"><code>    mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/task%20progression%20on%20SEPR%20-%20Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/task%20progression%20on%20SEPR%20-%20Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    #posterior predictive checking
    coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

     Point est. Upper C.I.
coef          1          1</code></pre>
<pre class="r"><code>    coda::effectiveSize(draws) #ESS</code></pre>
<pre><code>    coef 
6172.232 </code></pre>
<pre class="r"><code>    #save model
    draws_SEPR_taskprogression&lt;-draws
    save(draws_SEPR_taskprogression,file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_taskprogression.Rdata&#39;))</code></pre>
<pre class="r"><code>## include trial characteristics - TASK PROGRESSION
  lmm&lt;-lmer(scale(mmn)~EventCounter+
              (1|id),data=df_trial)
  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
             Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  
EventCounter 5.5172  5.5172     1 45566  6.2667 0.01231 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  cbind(round(fixef(lmm)[&#39;EventCounter&#39;],9),
                round(confint(lmm,parm = &#39;EventCounter&#39;),9))</code></pre>
<pre><code>                          2.5 %     97.5 %
EventCounter 2.73e-05 5.923e-06 4.8672e-05</code></pre>
<pre class="r"><code>  confint(contrast(emmeans(lmm,~EventCounter,at=list(EventCounter =   seq(1,1400,1399))),&#39;pairwise&#39;))</code></pre>
<pre><code> contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1 - EventCounter1400  -0.0382 0.0153 Inf   -0.0681  -0.00829

Note: contrasts are still on the scale(-11.2, 9.21) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>r2_nakagawa(lmm)  </code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.127
     Marginal R2: 0.000</code></pre>
<pre class="r"><code>#BIC Bayes Factor
lmm_ML&lt;-lmer(scale(mmn)~EventCounter+
              (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~1+
                   (1|id),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  
BF_BIC  </code></pre>
<pre><code>[1] 0.1073706</code></pre>
<p>create a combined figure of stimulus and task progression effects on
BPS, SEPR, MMN</p>
<pre class="r"><code>#y-axis limitation for combined plot
y_axis_limitation&lt;-c(-0.1, 0.15)

#BPS
lmm&lt;-lmer(scale(pd_baseline)~EventData+
              (1|subjects)+(1|wave),data=df_trial)

#create plot --&gt; of contrasts
plot_task_effect&lt;-plot(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))[[&#39;data&#39;]]

#modify plot
g1&lt;-ggplot(plot_task_effect,aes(x=contrast,y=the.emmean))+
  #conventional error bar
  geom_errorbar(aes(min=asymp.LCL,max=asymp.UCL),width=0.2)+
  
  # #overplot predicted values
  # geom_jitter(data=df_plot_predicted_bps[complete.cases(df_plot_predicted_bps),],
  #             aes(x=predicted_bps_eventdata,
  #                 y=predicted_bps_mean,color=predicted_bps_eventdata),alpha=0.3,width=0.4,show.legend=F)+
  #boxplot
  geom_boxplot(aes(fill=contrast,
                   middle=the.emmean,
                   lower=the.emmean-1.5*SE,
                   upper=the.emmean+1.5*SE,
                   ymin=asymp.LCL,
                   ymax=asymp.UCL),stat = &quot;identity&quot;,alpha=0.7)+
  scale_fill_manual(values = custom_contrast_colors,labels = c(&#39;standard - pitch&#39;,&#39;standard - length&#39;,&#39;standard - pitch &amp; length&#39;,&#39;pitch - length&#39;,&#39;pitch - pitch &amp; length&#39;,&#39;length - pitch &amp; length&#39;))+
  scale_x_discrete(labels = NULL, breaks = NULL)+ #remove x-axis tick labels
  coord_cartesian(ylim = y_axis_limitation)+
  labs(x=&#39;contrast of stimuli&#39;,y=&#39;BPS difference (z)&#39;)
  

#SEPR -pupillary response - technical model
lmm&lt;-lmer(scale(rpd_auc)~EventData+
              (1|subjects)+(1|wave),data=df_trial)

#create plot --&gt; of contrasts
plot_task_effect&lt;-plot(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))[[&#39;data&#39;]]

#modify plot
g2&lt;-ggplot(plot_task_effect,aes(x=contrast,y=the.emmean))+
  #conventional error bar
  geom_errorbar(aes(min=asymp.LCL,max=asymp.UCL),width=0.2)+
  
    #boxplot
  geom_boxplot(aes(fill=contrast,
                   middle=the.emmean,
                   lower=the.emmean-1.5*SE,
                   upper=the.emmean+1.5*SE,
                   ymin=asymp.LCL,
                   ymax=asymp.UCL),stat = &quot;identity&quot;,alpha=0.7)+
  scale_fill_manual(values = custom_contrast_colors,labels = c(&#39;standard - pitch&#39;,&#39;standard - length&#39;,&#39;standard - pitch &amp; length&#39;,&#39;pitch - length&#39;,&#39;pitch - pitch &amp; length&#39;,&#39;length - pitch &amp; length&#39;))+
  scale_x_discrete(labels = NULL, breaks = NULL)+ #remove x-axis tick labels
  coord_cartesian(ylim = y_axis_limitation)+
  labs(x=&#39;contrast of stimuli&#39;,y=&#39;SEPR difference (z)&#39;)

##MMN
lmm&lt;-lmer(scale(mmn)~EventData+(1|id),df_trial)

      #create plot --&gt; of contrasts
      plot_task_effect&lt;-plot(contrast(emmeans(lmm,~EventData),&#39;pairwise&#39;))[[&#39;data&#39;]]

      #modify plot
      g3&lt;-ggplot(plot_task_effect,aes(x=contrast,y=the.emmean))+
        #conventional error bar
        geom_errorbar(aes(min=asymp.LCL,max=asymp.UCL),width=0.2)+
        geom_boxplot(aes(fill=contrast,
                         middle=the.emmean,
                         lower=the.emmean-1.5*SE,
                         upper=the.emmean+1.5*SE,
                         ymin=asymp.LCL,
                         ymax=asymp.UCL),stat = &quot;identity&quot;,alpha=0.7)+
        scale_fill_manual(values = custom_contrast_colors,labels = c(&#39;standard - pitch&#39;,&#39;standard - length&#39;,&#39;standard - pitch &amp; length&#39;,&#39;pitch - length&#39;,&#39;pitch - pitch &amp; length&#39;,&#39;length - pitch &amp; length&#39;))+
        scale_x_discrete(labels = NULL, breaks = NULL)+ #remove x-axis tick labels
        coord_cartesian(ylim = y_axis_limitation)+
        labs(x=&#39;contrast of stimuli&#39;,y=&#39;MMN difference (z)&#39;)


###task progression BPS
BPS_progression&lt;-lmer(scale(pd_baseline)~stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial)
      
model_plot_data_BPS&lt;-as.data.frame(emmeans(BPS_progression,~EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
g4&lt;-ggplot(model_plot_data_BPS,aes(x=EventCounter,y=emmean))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE),alpha=0.8,position=&#39;dodge&#39;,fill=&#39;grey35&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  coord_cartesian(ylim = c(-0.2,0.25))+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;baseline pupil size (BPS, z)&#39;)

###task progression SEPR
SEPR_progression&lt;-lmer(scale(rpd_auc)~EventCounter+
              (1|subjects)+(1|wave),data=df_trial)
      
      
model_plot_data_SEPR&lt;-as.data.frame(emmeans(SEPR_progression,~EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
g5&lt;-ggplot(model_plot_data_SEPR,aes(x=EventCounter,y=emmean))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE),alpha=0.8,position=&#39;dodge&#39;,fill=&#39;grey35&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  coord_cartesian(ylim = c(-0.2,0.25))+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;pupillary response (SEPR, z)&#39;)

###task progression MMN
MMN_progression&lt;-lmer(scale(mmn)~EventCounter+
              (1|id),data=df_trial)
      
model_plot_data_MMN&lt;-as.data.frame(emmeans(MMN_progression,~EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
g6&lt;-ggplot(model_plot_data_MMN,aes(x=EventCounter,y=emmean))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE),alpha=0.8,position=&#39;dodge&#39;,fill=&#39;grey35&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  coord_cartesian(ylim = c(-0.2,0.25))+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;mismatch negativity (MMN, z)&#39;)

#extract legend
g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}

mylegend_contrast&lt;-g_legend(g3)

      
###composite figure layout
lay &lt;- rbind(c(1,2,3,7),
             c(4,5,6,7))


#plot in markdown
grid.arrange(g1+theme(legend.position=&quot;none&quot;)+xlab(&#39;&#39;),
             g2+theme(legend.position=&quot;none&quot;),
             g3+theme(legend.position=&quot;none&quot;)+xlab(&#39;&#39;),
             g4+xlab(&#39;&#39;),
             g5,
             g6+xlab(&#39;&#39;),
             mylegend_contrast,layout_matrix=lay)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure_task_effects-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#save to file
tiff(file=paste0(project_path,&quot;/output/figures/task_effects_contrasts_progression.tiff&quot;), # create a file in tiff format in 
  width=8, height=5, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(g1+theme(legend.position=&quot;none&quot;)+xlab(&#39;&#39;),
             g2+theme(legend.position=&quot;none&quot;),
             g3+theme(legend.position=&quot;none&quot;)+xlab(&#39;&#39;),
             g4+xlab(&#39;&#39;),
             g5,
             g6+xlab(&#39;&#39;),
             mylegend_contrast,layout_matrix=lay)
      

dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="group-differences" class="section level1">
<h1>group differences</h1>
<div id="baseline-pupil-size-bps" class="section level2">
<h2>baseline pupil size (BPS)</h2>
<pre class="r"><code>#main model
lmm_REML&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial)

#fixed effect significances
anova(lmm_REML)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                     Sum Sq Mean Sq NumDF
EventData                                             7.841   2.614     3
t1_diagnosis                                          0.497   0.497     1
stats::poly(EventCounter, 3)                        211.127  70.376     3
EventData:t1_diagnosis                                2.018   0.673     3
EventData:stats::poly(EventCounter, 3)               23.009   2.557     9
t1_diagnosis:stats::poly(EventCounter, 3)             9.641   3.214     3
EventData:t1_diagnosis:stats::poly(EventCounter, 3)   1.134   0.126     9
                                                     DenDF  F value    Pr(&gt;F)
EventData                                           298682  10.1635 1.089e-06
t1_diagnosis                                           219   1.9320   0.16595
stats::poly(EventCounter, 3)                        298684 273.6541 &lt; 2.2e-16
EventData:t1_diagnosis                              298682   2.6152   0.04932
EventData:stats::poly(EventCounter, 3)              298682   9.9410 2.093e-15
t1_diagnosis:stats::poly(EventCounter, 3)           298684  12.4959 3.632e-08
EventData:t1_diagnosis:stats::poly(EventCounter, 3) 298682   0.4900   0.88241
                                                       
EventData                                           ***
t1_diagnosis                                           
stats::poly(EventCounter, 3)                        ***
EventData:t1_diagnosis                              *  
EventData:stats::poly(EventCounter, 3)              ***
t1_diagnosis:stats::poly(EventCounter, 3)           ***
EventData:t1_diagnosis:stats::poly(EventCounter, 3)    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#model fit
r2_nakagawa(lmm_REML)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.767
     Marginal R2: 0.010</code></pre>
<pre class="r"><code>#POST-HOC
contrast(emmeans(lmm_REML,~EventData|t1_diagnosis),&#39;pairwise&#39;)</code></pre>
<pre><code>t1_diagnosis = ASD:
 contrast                    estimate      SE  df z.ratio p.value
 EventData201 - EventData202  0.02203 0.00886 Inf   2.487  0.0619
 EventData201 - EventData203  0.02341 0.00759 Inf   3.082  0.0111
 EventData201 - EventData204  0.01703 0.00838 Inf   2.031  0.1764
 EventData202 - EventData203  0.00138 0.01132 Inf   0.122  0.9994
 EventData202 - EventData204 -0.00500 0.01187 Inf  -0.421  0.9749
 EventData203 - EventData204 -0.00638 0.01096 Inf  -0.582  0.9375

t1_diagnosis = Control:
 contrast                    estimate      SE  df z.ratio p.value
 EventData201 - EventData202 -0.00324 0.01070 Inf  -0.303  0.9903
 EventData201 - EventData203  0.00636 0.00918 Inf   0.693  0.8998
 EventData201 - EventData204  0.01364 0.01010 Inf   1.351  0.5302
 EventData202 - EventData203  0.00960 0.01368 Inf   0.702  0.8964
 EventData202 - EventData204  0.01689 0.01431 Inf   1.180  0.6397
 EventData203 - EventData204  0.00728 0.01322 Inf   0.551  0.9463

Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>##--&gt; lower BPS in ASD for length versus standards

#Post-hoc - between group
emtrends(lmm_REML,~t1_diagnosis,var=&#39;EventCounter&#39;)</code></pre>
<pre><code> t1_diagnosis EventCounter.trend       SE  df asymp.LCL asymp.UCL
 ASD                   -6.61e-05 1.37e-05 Inf -9.29e-05 -3.92e-05
 Control               -4.29e-05 1.66e-05 Inf -7.55e-05 -1.03e-05

Results are averaged over the levels of: EventData 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>#emmeans(lmm_REML,~t1_diagnosis|EventCounter,at=list(EventCounter = seq(1,1400,1399)))
emmeans(lmm_REML,~t1_diagnosis|EventCounter,at=list(EventCounter = seq(1,1400,699)))</code></pre>
<pre><code>EventCounter =    1:
 t1_diagnosis  emmean     SE  df asymp.LCL asymp.UCL
 ASD          -0.0426 0.0861 Inf    -0.211    0.1260
 Control      -0.1399 0.1039 Inf    -0.344    0.0638

EventCounter =  700:
 t1_diagnosis  emmean     SE  df asymp.LCL asymp.UCL
 ASD           0.1559 0.0857 Inf    -0.012    0.3239
 Control      -0.0315 0.1035 Inf    -0.234    0.1713

EventCounter = 1399:
 t1_diagnosis  emmean     SE  df asymp.LCL asymp.UCL
 ASD          -0.0198 0.0862 Inf    -0.189    0.1492
 Control      -0.2296 0.1041 Inf    -0.434   -0.0256

Results are averaged over the levels of: EventData 
Degrees-of-freedom method: asymptotic 
Results are given on the scale(3.41, 0.55) (not the response) scale. 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>  confint(contrast(emmeans(lmm_REML,~EventCounter|t1_diagnosis,at=list(EventCounter =   seq(1,1400,699))),&#39;revpairwise&#39;))</code></pre>
<pre><code>t1_diagnosis = ASD:
 contrast                           estimate     SE  df asymp.LCL asymp.UCL
 EventCounter700 - EventCounter1      0.1986 0.0102 Inf    0.1745    0.2226
 EventCounter1399 - EventCounter1     0.0228 0.0150 Inf   -0.0123    0.0579
 EventCounter1399 - EventCounter700  -0.1757 0.0117 Inf   -0.2031   -0.1483

t1_diagnosis = Control:
 contrast                           estimate     SE  df asymp.LCL asymp.UCL
 EventCounter700 - EventCounter1      0.1084 0.0124 Inf    0.0795    0.1374
 EventCounter1399 - EventCounter1    -0.0897 0.0181 Inf   -0.1322   -0.0473
 EventCounter1399 - EventCounter700  -0.1981 0.0141 Inf   -0.2313   -0.1650

Results are averaged over the levels of: EventData 
Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<pre class="r"><code>#Bayes factor - group x task progression
lmm_ML&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(pd_baseline)~EventData+t1_diagnosis+stats::poly(EventCounter,3)+
                   EventData:EventCounter+EventData:t1_diagnosis+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
BF_BIC</code></pre>
<pre><code>[1] 51194908852</code></pre>
<pre class="r"><code>### compare full model for influence of covariates

#full model
lmm_full&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*EventCounter+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|subjects)+(1|wave),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model

anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                    Sum Sq Mean Sq NumDF  DenDF   F value
EventData                             8.61    2.87     3 298680   11.1288
t1_diagnosis                          0.00    0.00     1    207    0.0064
EventCounter                         23.18   23.18     1 298692   89.8678
scale(ageyrs)                        65.93   65.93     1    211  255.5886
scale(t1_piq)                         0.53    0.53     1    207    2.0387
sex                                   0.37    0.37     1    205    1.4238
scale(center_dev)                    40.51   40.51     1 239997  157.0436
as.factor(sampling_rate)            382.21  382.21     1 207692 1481.6454
scale(missing_data_trial)           123.76  123.76     1 298708  479.7477
EventData:t1_diagnosis                0.11    0.04     3 298680    0.1444
EventData:EventCounter                5.68    1.89     3 298680    7.3358
t1_diagnosis:EventCounter             5.01    5.01     1 298702   19.4122
EventData:t1_diagnosis:EventCounter   0.90    0.30     3 298680    1.1588
                                       Pr(&gt;F)    
EventData                           2.672e-07 ***
t1_diagnosis                           0.9362    
EventCounter                        &lt; 2.2e-16 ***
scale(ageyrs)                       &lt; 2.2e-16 ***
scale(t1_piq)                          0.1548    
sex                                    0.2342    
scale(center_dev)                   &lt; 2.2e-16 ***
as.factor(sampling_rate)            &lt; 2.2e-16 ***
scale(missing_data_trial)           &lt; 2.2e-16 ***
EventData:t1_diagnosis                 0.9333    
EventData:EventCounter              6.503e-05 ***
t1_diagnosis:EventCounter           1.054e-05 ***
EventData:t1_diagnosis:EventCounter    0.3238    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>####--&gt; reun with more iterations

# A. translate data - make greta arrays
y &lt;- as_data(scale(df_trial$pd_baseline))
design &lt;- as.matrix(cbind(ifelse(df_trial$t1_diagnosis==&#39;ASD&#39;,T,F),df_trial$EventCounter))
subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)

#define priors
int &lt;- normal(0, 1)
design_coef&lt;- normal(0, 1, dim=ncol(design))
sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
#sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- int + design %*% design_coef + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
m &lt;- model(design_coef)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups,) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 1.888851 hours</code></pre>
<pre class="r"><code>#save model
draws_BPS_twoway&lt;-draws
save(draws_BPS_twoway,file=paste0(project_path,&#39;/data/Bayesian_model_BPS_twoway.Rdata&#39;))

#posterior estimates
point_estimate(draws_BPS_twoway)</code></pre>
<pre><code>Point Estimate

Parameter        |    Median |      Mean |       MAP
----------------------------------------------------
design_coef[1,1] |      0.20 |      0.19 |      0.20
design_coef[2,1] | -2.52e-05 | -2.52e-05 | -2.51e-05</code></pre>
<pre class="r"><code>ci(draws_BPS_twoway,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter        |        89% ETI
---------------------------------
design_coef[1,1] | [ 0.18,  0.21]
design_coef[2,1] | [ 0.00,  0.00]</code></pre>
<pre class="r"><code>  with(df_trial,table(sequence_position,EventData))</code></pre>
<pre><code>                 EventData
sequence_position   201   202   203   204
               1  48392   659  1348     1
               2  35348  2573  5059  5295
               3  30366  1477  1478  2122
               4  24598  2189  1037  2593
               5  20401  1262  1274  1704
               6  15167  1431  2358  1494
               7  12472  1057   845  1101
               8   9711  1068   628   883
               9   8474   840   193   193
               10  7032   668   610   231
               11  6125     0   449   454
               12  5227   206   229   421
               13  4797     0   447     0
               14  3630   453     0   699
               15  2989   206   432     0
               16  2324     0   426   241
               17  1896   237     0   206
               18  1684     0   201     0
               19  1720     0     0     0
               20  1490   213     0     0
               21  1479     0     0     0
               22  1060   219     0   213
               23   643     0   212   206
               24   633     0     0     0
               25   209     0   193   239
               26   200     0     0     0
               27   193     0     0     0
               28     0     0     0   201</code></pre>
<pre class="r"><code>  ###--&gt; weird distribution?

  #recoding
  df_trial$sequence_position_z&lt;-scale(df_trial$sequence_position)

          #figure
        df_trial$standardtrial&lt;-with(df_trial,ifelse(EventData==201,T,F))
        ggplot(df_trial[df_trial$sequence_position&lt;=10,],
               aes(x=sequence_position,y=scale(pd_baseline),group=interaction(standardtrial,t1_diagnosis),
                   color=standardtrial,linetype=t1_diagnosis))+
          geom_smooth()+labs(x=&#39;sequence position&#39;,y=&#39;BPS (z)&#39;)+scale_x_continuous(breaks=1:10)+
          theme_bw()</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/BPS%20habituation%20between%20groups%20-%20LMM-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>        ggplot(df_trial[df_trial$sequence_position&lt;=10,],
               aes(x=sequence_position,y=scale(rpd_response),group=interaction(standardtrial,t1_diagnosis),
                   color=t1_diagnosis,linetype=standardtrial))+
          geom_smooth()+labs(x=&#39;sequence position&#39;,y=&#39;SEPR (z)&#39;)+scale_x_continuous(breaks=1:10)+
          theme_bw()</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/BPS%20habituation%20between%20groups%20-%20LMM-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  #BPS - continuous
  lmm&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(sequence_position_z,2)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,])

  #model fit
  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                           Sum Sq Mean Sq NumDF
EventData                                                  24.323  8.1077     3
t1_diagnosis                                                0.473  0.4726     1
stats::poly(sequence_position_z, 2)                        20.020 10.0102     2
EventData:t1_diagnosis                                      0.949  0.3163     3
EventData:stats::poly(sequence_position_z, 2)              42.694  7.1157     6
t1_diagnosis:stats::poly(sequence_position_z, 2)            0.887  0.4436     2
EventData:t1_diagnosis:stats::poly(sequence_position_z, 2)  1.129  0.1882     6
                                                            DenDF F value
EventData                                                  246847 30.7967
t1_diagnosis                                                  219  1.7950
stats::poly(sequence_position_z, 2)                        246847 38.0233
EventData:t1_diagnosis                                     246847  1.2016
EventData:stats::poly(sequence_position_z, 2)              246847 27.0286
t1_diagnosis:stats::poly(sequence_position_z, 2)           246847  1.6850
EventData:t1_diagnosis:stats::poly(sequence_position_z, 2) 246847  0.7147
                                                           Pr(&gt;F)    
EventData                                                  &lt;2e-16 ***
t1_diagnosis                                               0.1817    
stats::poly(sequence_position_z, 2)                        &lt;2e-16 ***
EventData:t1_diagnosis                                     0.3074    
EventData:stats::poly(sequence_position_z, 2)              &lt;2e-16 ***
t1_diagnosis:stats::poly(sequence_position_z, 2)           0.1854    
EventData:t1_diagnosis:stats::poly(sequence_position_z, 2) 0.6377    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>        ### supplementary analysis
        lmm&lt;-lmer(scale(pd_baseline)~t1_diagnosis*sequence_position_z+
                    (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;10,])

        #model fit
        anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                  Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
t1_diagnosis                     0.54918 0.54918     1    219  2.0759 0.15107  
sequence_position_z              0.20687 0.20687     1 204705  0.7820 0.37654  
t1_diagnosis:sequence_position_z 1.02396 1.02396     1 204705  3.8706 0.04914 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>        r2_nakagawa(lmm)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.761
     Marginal R2: 0.007</code></pre>
<pre class="r"><code>        #BIC Bayes Factor
        lmm_ML&lt;-lmer(scale(pd_baseline)~t1_diagnosis*sequence_position_z+
                       (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;10,],REML=F)

        null_lmm_ML &lt;- lmer(scale(pd_baseline)~sequence_position_z+
                              (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;10,],REML=F)

        BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)
        BF_BIC</code></pre>
<pre><code>[1] 9.181512e-05</code></pre>
<pre class="r"><code>  #BPS categorical
  lmm&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*as.factor(sequence_position)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,])

  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                    Sum Sq Mean Sq NumDF  DenDF
EventData                                            0.547  0.1823     3 133876
t1_diagnosis                                         0.429  0.4286     1    219
as.factor(sequence_position)                         1.316  0.6581     2 133876
EventData:t1_diagnosis                               0.364  0.1212     3 133876
EventData:as.factor(sequence_position)              49.588  8.2647     6 133876
t1_diagnosis:as.factor(sequence_position)            0.063  0.0314     2 133876
EventData:t1_diagnosis:as.factor(sequence_position)  1.076  0.2151     5 133876
                                                    F value Pr(&gt;F)    
EventData                                            0.6981 0.5531    
t1_diagnosis                                         1.6411 0.2015    
as.factor(sequence_position)                         2.5196 0.0805 .  
EventData:t1_diagnosis                               0.4642 0.7073    
EventData:as.factor(sequence_position)              31.6439 &lt;2e-16 ***
t1_diagnosis:as.factor(sequence_position)            0.1203 0.8867    
EventData:t1_diagnosis:as.factor(sequence_position)  0.8236 0.5326    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  contrast(emmeans(lmm,~as.factor(sequence_position)),&#39;pairwise&#39;)</code></pre>
<pre><code> contrast                                estimate      SE  df z.ratio p.value
 sequence_position1 - sequence_position2   nonEst      NA  NA      NA      NA
 sequence_position1 - sequence_position3   nonEst      NA  NA      NA      NA
 sequence_position2 - sequence_position3   -0.015 0.00671 Inf  -2.234  0.0655

Results are averaged over the levels of: EventData, t1_diagnosis 
Note: contrasts are still on the scale(3.41, 0.55) scale 
Degrees-of-freedom method: asymptotic 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<pre class="r"><code>  ###-&gt; 1-3 effect
  ###inclusion of covariates leads to boundary singular

  lmm&lt;-lmer(scale(pd_baseline)~t1_diagnosis*as.factor(sequence_position)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;4,])</code></pre>
<pre class="r"><code>df_bps_bayesian_habituation&lt;-df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;10,]

# A. translate data - make greta arrays
y &lt;- as_data(scale(df_bps_bayesian_habituation$pd_baseline))
design &lt;- as.matrix(cbind(ifelse(df_bps_bayesian_habituation$t1_diagnosis==&#39;ASD&#39;,T,F),df_bps_bayesian_habituation$sequence_position))
subject_id &lt;- as.integer(factor(df_bps_bayesian_habituation$subjects)) #random intercept (in LMM)

#define priors
int &lt;- normal(0, 1)
design_coef&lt;- normal(0, 1, dim=ncol(design))
sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
#sd &lt;- student(3, 0, 1, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- int + design %*% design_coef + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
m &lt;- model(design_coef)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups,) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 1.279341 hours</code></pre>
<pre class="r"><code>#save model
draws_BPS_supp&lt;-draws
save(draws_BPS_supp,file=paste0(project_path,&#39;/data/Bayesian_model_BPS_supp.Rdata&#39;))

#posterior estimates
point_estimate(draws_BPS_supp)</code></pre>
<pre><code>Point Estimate

Parameter        |    Median |      Mean |       MAP
----------------------------------------------------
design_coef[1,1] |      0.19 |      0.21 |      0.20
design_coef[2,1] | -2.69e-04 | -2.67e-04 | -2.34e-04</code></pre>
<pre class="r"><code>ci(draws_BPS_supp,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter        |       89% ETI
--------------------------------
design_coef[1,1] | [ 0.05, 0.49]
design_coef[2,1] | [ 0.00, 0.00]</code></pre>
</div>
<div id="stimulus-evoked-pupillary-response" class="section level2">
<h2>stimulus-evoked pupillary response</h2>
<pre class="r"><code>#MAIN MODEL - pupillary response by group - random intercept
lmm_REML&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
            (1|subjects)+(1|wave),data=df_trial)
            #--&gt; group effect (interaction) is robust in reduced and full model

#fixed effect significances
anova(lmm_REML)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF  DenDF F value
EventData                           21.8918  7.2973     3 298696  7.3207
t1_diagnosis                         0.0168  0.0168     1   1795  0.0168
EventCounter                         0.1145  0.1145     1 298690  0.1149
EventData:t1_diagnosis               7.5554  2.5185     3 298696  2.5266
EventData:EventCounter               2.3525  0.7842     3 298697  0.7867
t1_diagnosis:EventCounter            0.2500  0.2500     1 298705  0.2508
EventData:t1_diagnosis:EventCounter  9.8345  3.2782     3 298697  3.2887
                                       Pr(&gt;F)    
EventData                           6.645e-05 ***
t1_diagnosis                          0.89674    
EventCounter                          0.73467    
EventData:t1_diagnosis                0.05555 .  
EventData:EventCounter                0.50111    
t1_diagnosis:EventCounter             0.61648    
EventData:t1_diagnosis:EventCounter   0.01974 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#Bayes factor - group x task progression
lmm_ML&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
                (1|subjects)+(1|wave),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(rpd_auc)~EventData+EventCounter+
                 EventData:EventCounter+EventData:t1_diagnosis:EventCounter+
                (1|subjects)+(1|wave),data=df_trial,REML=F)

  BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
  BF_BIC</code></pre>
<pre><code>[1] 5.045063e-10</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|subjects)+(1|wave),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model

anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF  DenDF  F value
EventData                            21.908   7.303     3 298694   7.3318
t1_diagnosis                          0.045   0.045     1   1867   0.0453
EventCounter                          0.028   0.028     1 297217   0.0281
scale(ageyrs)                         0.147   0.147     1    192   0.1471
scale(t1_piq)                         1.088   1.088     1    184   1.0928
sex                                   0.313   0.313     1    183   0.3139
scale(center_dev)                     0.283   0.283     1   3427   0.2837
as.factor(sampling_rate)              2.002   2.002     1    720   2.0099
scale(missing_data_trial)           252.632 252.632     1 225913 253.6393
EventData:t1_diagnosis                7.956   2.652     3 298694   2.6624
EventData:EventCounter                2.233   0.744     3 298695   0.7472
t1_diagnosis:EventCounter             0.282   0.282     1 298635   0.2834
EventData:t1_diagnosis:EventCounter  10.146   3.382     3 298695   3.3954
                                       Pr(&gt;F)    
EventData                            6.54e-05 ***
t1_diagnosis                          0.83139    
EventCounter                          0.86693    
scale(ageyrs)                         0.70173    
scale(t1_piq)                         0.29722    
sex                                   0.57597    
scale(center_dev)                     0.59429    
as.factor(sampling_rate)              0.15671    
scale(missing_data_trial)           &lt; 2.2e-16 ***
EventData:t1_diagnosis                0.04628 *  
EventData:EventCounter                0.52377    
t1_diagnosis:EventCounter             0.59448    
EventData:t1_diagnosis:EventCounter   0.01705 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(contrast(emmeans(lmm_full,~EventData|t1_diagnosis),&#39;revpairwise&#39;))</code></pre>
<pre><code>t1_diagnosis = ASD:
 contrast                    estimate      SE  df asymp.LCL asymp.UCL
 EventData202 - EventData201   0.0705 0.01105 Inf  0.042156   0.09894
 EventData203 - EventData201   0.0259 0.01018 Inf -0.000221   0.05210
 EventData203 - EventData202  -0.0446 0.01457 Inf -0.082043  -0.00717
 EventData204 - EventData201   0.0534 0.00994 Inf  0.027896   0.07896
 EventData204 - EventData202  -0.0171 0.01440 Inf -0.054117   0.01988
 EventData204 - EventData203   0.0275 0.01375 Inf -0.007829   0.06281

t1_diagnosis = Control:
 contrast                    estimate      SE  df asymp.LCL asymp.UCL
 EventData202 - EventData201   0.0759 0.01341 Inf  0.041484   0.11040
 EventData203 - EventData201   0.0172 0.01237 Inf -0.014608   0.04897
 EventData203 - EventData202  -0.0588 0.01770 Inf -0.104219  -0.01330
 EventData204 - EventData201   0.0615 0.01200 Inf  0.030641   0.09230
 EventData204 - EventData202  -0.0145 0.01744 Inf -0.059264   0.03032
 EventData204 - EventData203   0.0443 0.01665 Inf  0.001509   0.08706

Results are averaged over the levels of: sex, sampling_rate 
Note: contrasts are still on the scale(-0.00104, 0.0336) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>#coefficient of determination
r2_nakagawa(lmm_full)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.004
     Marginal R2: 0.001</code></pre>
<pre class="r"><code>#post hoc effects
confint(contrast(emtrends(lmm_REML,~t1_diagnosis|EventData,var=&#39;EventCounter&#39;),&#39;pairwise&#39;))</code></pre>
<pre><code>EventData = 201:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control -6.05e-06 1.02e-05 Inf -2.60e-05  1.39e-05

EventData = 202:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control  8.85e-05 3.97e-05 Inf  1.07e-05  1.66e-04

EventData = 203:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control -7.90e-05 3.93e-05 Inf -1.56e-04 -1.92e-06

EventData = 204:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control -3.71e-05 3.59e-05 Inf -1.08e-04  3.33e-05

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>      plot(emtrends(lmm_REML,~t1_diagnosis|EventData,var=&#39;EventCounter&#39;))</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/SEPR%20task%20progression%20between%20groups%20LMM-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>confint(contrast(emmeans(lmm_REML,~EventCounter|t1_diagnosis+EventData,at=list(EventCounter =   seq(1,1400,1399))),&#39;revpairwise&#39;))</code></pre>
<pre><code>t1_diagnosis = ASD, EventData = 201:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1 -0.02499 0.00906 Inf   -0.0427  -0.00724

t1_diagnosis = Control, EventData = 201:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1 -0.01652 0.01099 Inf   -0.0381   0.00502

t1_diagnosis = ASD, EventData = 202:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1  0.05478 0.03529 Inf   -0.0144   0.12395

t1_diagnosis = Control, EventData = 202:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1 -0.06901 0.04282 Inf   -0.1529   0.01492

t1_diagnosis = ASD, EventData = 203:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1 -0.05947 0.03493 Inf   -0.1279   0.00899

t1_diagnosis = Control, EventData = 203:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1  0.05104 0.04250 Inf   -0.0323   0.13432

t1_diagnosis = ASD, EventData = 204:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1 -0.00985 0.03207 Inf   -0.0727   0.05301

t1_diagnosis = Control, EventData = 204:
 contrast                         estimate      SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1  0.04212 0.03873 Inf   -0.0338   0.11803

Note: contrasts are still on the scale(-0.00104, 0.0336) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code># A. translate data - make greta arrays
y &lt;- as_data(scale(df_trial$rpd_auc))
trials &lt;- as_data(scale(df_trial$EventCounter))
subject_id &lt;- as.integer(factor(df_trial$subjects)) #random intercept (in LMM)
events &lt;- as_data(model.matrix(~ EventData - 1, df_trial)) #alternative to dummy coding?
interaction_variable&lt;-with(df_trial,interaction(t1_diagnosis,EventData))
group_by_events &lt;- as_data(model.matrix(~interaction_variable-1, df_trial)) #alternative to dummy coding - remove intercept (-1)
#table(group_by_events[,1],group_by_events[,9])

#define priors
event_coefs&lt;- normal(0, 1, dim=ncol(events))
group_event_coefs &lt;- normal(0,1, dim=ncol(group_by_events))

sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- trials * group_by_events %*% group_event_coefs + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
#m &lt;- model(int, coef_201, coef_202, coef_203, coef_204, sd)
m &lt;- model(group_event_coefs)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 1.954119 hours</code></pre>
<pre class="r"><code>#save model
draws_SEPR_threeway&lt;-draws
save(draws_SEPR_threeway,file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_threewayinteraction.Rdata&#39;))

#posterior estimates
table(interaction_variable) #names of coefficients</code></pre>
<pre><code>interaction_variable
    ASD.201 Control.201     ASD.202 Control.202     ASD.203 Control.203 
     147969      100291        8778        5980       10380        7039 
    ASD.204 Control.204 
      10977        7520 </code></pre>
<pre class="r"><code>point_estimate(draws_SEPR_threeway)</code></pre>
<pre><code>Point Estimate

Parameter              |    Median |      Mean |       MAP
----------------------------------------------------------
group_event_coefs[1,1] | -7.27e-03 | -7.28e-03 | -6.94e-03
group_event_coefs[2,1] | -5.05e-03 | -5.05e-03 | -4.89e-03
group_event_coefs[3,1] |      0.02 |      0.02 |      0.02
group_event_coefs[4,1] |     -0.01 |     -0.01 |     -0.01
group_event_coefs[5,1] |     -0.02 |     -0.02 |     -0.01
group_event_coefs[6,1] |      0.02 |      0.02 |      0.02
group_event_coefs[7,1] | -8.24e-03 | -8.25e-03 | -8.22e-03
group_event_coefs[8,1] |  6.38e-03 |  6.43e-03 |  5.48e-03</code></pre>
<pre class="r"><code>ci(draws_SEPR_threeway,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter              |        89% ETI
---------------------------------------
group_event_coefs[1,1] | [-0.01,  0.00]
group_event_coefs[2,1] | [-0.01,  0.00]
group_event_coefs[3,1] | [ 0.01,  0.04]
group_event_coefs[4,1] | [-0.03,  0.01]
group_event_coefs[5,1] | [-0.03,  0.00]
group_event_coefs[6,1] | [ 0.00,  0.04]
group_event_coefs[7,1] | [-0.02,  0.01]
group_event_coefs[8,1] | [-0.01,  0.02]</code></pre>
<pre class="r"><code>  #SEPR - continuous habituation
  lmm&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*sequence_position_z+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,])

  #fixed effect significance
  anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                            Sum Sq Mean Sq NumDF  DenDF F value
EventData                                  110.388  36.796     3 246859 36.9080
t1_diagnosis                                 0.183   0.183     1    665  0.1832
sequence_position_z                         37.276  37.276     1 246857 37.3893
EventData:t1_diagnosis                       0.706   0.235     3 246859  0.2360
EventData:sequence_position_z               20.738   6.913     3 246856  6.9336
t1_diagnosis:sequence_position_z             2.100   2.100     1 246857  2.1066
EventData:t1_diagnosis:sequence_position_z   2.576   0.859     3 246856  0.8613
                                              Pr(&gt;F)    
EventData                                  &lt; 2.2e-16 ***
t1_diagnosis                               0.6687965    
sequence_position_z                         9.69e-10 ***
EventData:t1_diagnosis                     0.8713367    
EventData:sequence_position_z              0.0001158 ***
t1_diagnosis:sequence_position_z           0.1466665    
EventData:t1_diagnosis:sequence_position_z 0.4603034    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  #model fit
  r2_nakagawa(lmm)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.004
     Marginal R2: 0.001</code></pre>
<pre class="r"><code>        ##with covariates
        lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*sequence_position_z+
                      scale(ageyrs)+scale(t1_piq)+sex+
                       scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
                    (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,])
          
        anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                            Sum Sq Mean Sq NumDF  DenDF
EventData                                  110.410  36.803     3 246861
t1_diagnosis                                 0.211   0.211     1    675
sequence_position_z                         37.511  37.511     1 246859
scale(ageyrs)                                0.087   0.087     1    189
scale(t1_piq)                                0.879   0.879     1    179
sex                                          0.465   0.465     1    177
scale(center_dev)                            0.440   0.440     1   2410
as.factor(sampling_rate)                     1.764   1.764     1    605
scale(missing_data_trial)                  225.997 225.997     1 175122
EventData:t1_diagnosis                       0.649   0.216     3 246857
EventData:sequence_position_z               20.985   6.995     3 246858
t1_diagnosis:sequence_position_z             1.888   1.888     1 246856
EventData:t1_diagnosis:sequence_position_z   2.544   0.848     3 246855
                                            F value    Pr(&gt;F)    
EventData                                   36.9460 &lt; 2.2e-16 ***
t1_diagnosis                                 0.2114  0.645845    
sequence_position_z                         37.6565 8.449e-10 ***
scale(ageyrs)                                0.0875  0.767708    
scale(t1_piq)                                0.8823  0.348843    
sex                                          0.4669  0.495312    
scale(center_dev)                            0.4419  0.506262    
as.factor(sampling_rate)                     1.7705  0.183815    
scale(missing_data_trial)                  226.8729 &lt; 2.2e-16 ***
EventData:t1_diagnosis                       0.2172  0.884548    
EventData:sequence_position_z                7.0222  0.000102 ***
t1_diagnosis:sequence_position_z             1.8951  0.168626    
EventData:t1_diagnosis:sequence_position_z   0.8513  0.465639    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>        ###--&gt; if an oddballs follows an oddball - higehr response in ASD
        ###--&gt; if oddball follows a standard - higher response in TD
        

  #SEPR - categorical habituation
  lmm&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*as.factor(sequence_position)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,])

   anova(lmm)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                     Sum Sq Mean Sq NumDF
EventData                                           12.0613  4.0204     3
t1_diagnosis                                         0.0062  0.0062     1
as.factor(sequence_position)                         1.1397  0.5698     2
EventData:t1_diagnosis                               0.2776  0.0925     3
EventData:as.factor(sequence_position)              15.0582  2.5097     6
t1_diagnosis:as.factor(sequence_position)            6.8464  3.4232     2
EventData:t1_diagnosis:as.factor(sequence_position)  8.7711  1.7542     5
                                                     DenDF F value   Pr(&gt;F)   
EventData                                           133929  4.0307 0.007076 **
t1_diagnosis                                          1365  0.0062 0.937233   
as.factor(sequence_position)                        133954  0.5713 0.564800   
EventData:t1_diagnosis                              133894  0.0928 0.964062   
EventData:as.factor(sequence_position)              133909  2.5161 0.019522 * 
t1_diagnosis:as.factor(sequence_position)           133893  3.4320 0.032326 * 
EventData:t1_diagnosis:as.factor(sequence_position) 133889  1.7587 0.117594   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>      #BIC Bayes Factor
      lmm_ML&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*as.factor(sequence_position)+
                     (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,],REML=F)

      null_lmm_ML &lt;- lmer(scale(rpd_auc)~1+
                            (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,],REML=F)

      BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)
      BF_BIC</code></pre>
<pre><code>[1] 6.250107e-47</code></pre>
<pre class="r"><code>      BIC(null_lmm_ML)</code></pre>
<pre><code>[1] 380541.8</code></pre>
<pre class="r"><code>      BIC(lmm_ML)</code></pre>
<pre><code>[1] 380754.5</code></pre>
<pre class="r"><code>  #full model with covariates
  lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*as.factor(sequence_position)+
                 scale(ageyrs)+scale(t1_piq)+sex+
                 scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
                (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,])
                #--&gt; group effect (interaction) is robust in reduced and full model

  anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                     Sum Sq Mean Sq NumDF
EventData                                            12.158   4.053     3
t1_diagnosis                                          0.025   0.025     1
as.factor(sequence_position)                          1.067   0.534     2
scale(ageyrs)                                         0.025   0.025     1
scale(t1_piq)                                         1.701   1.701     1
sex                                                   1.018   1.018     1
scale(center_dev)                                     2.469   2.469     1
as.factor(sampling_rate)                              1.009   1.009     1
scale(missing_data_trial)                           127.094 127.094     1
EventData:t1_diagnosis                                0.280   0.093     3
EventData:as.factor(sequence_position)               15.177   2.529     6
t1_diagnosis:as.factor(sequence_position)             6.895   3.447     2
EventData:t1_diagnosis:as.factor(sequence_position)   8.784   1.757     5
                                                     DenDF  F value    Pr(&gt;F)
EventData                                           133932   4.0665  0.006732
t1_diagnosis                                          1381   0.0248  0.874993
as.factor(sequence_position)                        133961   0.5353  0.585490
scale(ageyrs)                                          182   0.0247  0.875187
scale(t1_piq)                                          168   1.7068  0.193183
sex                                                    166   1.0214  0.313658
scale(center_dev)                                     1332   2.4770  0.115760
as.factor(sampling_rate)                               448   1.0123  0.314889
scale(missing_data_trial)                            89910 127.5241 &lt; 2.2e-16
EventData:t1_diagnosis                              133892   0.0936  0.963595
EventData:as.factor(sequence_position)              133911   2.5380  0.018560
t1_diagnosis:as.factor(sequence_position)           133891   3.4589  0.031466
EventData:t1_diagnosis:as.factor(sequence_position) 133887   1.7628  0.116719
                                                       
EventData                                           ** 
t1_diagnosis                                           
as.factor(sequence_position)                           
scale(ageyrs)                                          
scale(t1_piq)                                          
sex                                                    
scale(center_dev)                                      
as.factor(sampling_rate)                               
scale(missing_data_trial)                           ***
EventData:t1_diagnosis                                 
EventData:as.factor(sequence_position)              *  
t1_diagnosis:as.factor(sequence_position)           *  
EventData:t1_diagnosis:as.factor(sequence_position)    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  contrast(emmeans(lmm,~t1_diagnosis|EventData+as.factor(sequence_position)),&#39;pairwise&#39;)</code></pre>
<pre><code>EventData = 201, sequence_position = 1:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.01597 0.0118 Inf  -1.350  0.1769

EventData = 202, sequence_position = 1:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control  0.10702 0.0795 Inf   1.346  0.1782

EventData = 203, sequence_position = 1:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control  0.05509 0.0559 Inf   0.985  0.3247

EventData = 204, sequence_position = 1:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control   nonEst     NA  NA      NA      NA

EventData = 201, sequence_position = 2:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.00380 0.0131 Inf  -0.290  0.7715

EventData = 202, sequence_position = 2:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.10209 0.0407 Inf  -2.507  0.0122

EventData = 203, sequence_position = 2:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.02069 0.0295 Inf  -0.700  0.4837

EventData = 204, sequence_position = 2:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.03305 0.0289 Inf  -1.142  0.2533

EventData = 201, sequence_position = 3:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control  0.00513 0.0138 Inf   0.372  0.7101

EventData = 202, sequence_position = 3:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control  0.01503 0.0534 Inf   0.282  0.7783

EventData = 203, sequence_position = 3:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.01525 0.0534 Inf  -0.285  0.7753

EventData = 204, sequence_position = 3:
 contrast      estimate     SE  df z.ratio p.value
 ASD - Control -0.00938 0.0448 Inf  -0.210  0.8340

Note: contrasts are still on the scale(-0.00149, 0.0335) scale 
Degrees-of-freedom method: asymptotic </code></pre>
<pre class="r"><code>  confint(contrast(emmeans(lmm,~t1_diagnosis|EventData+as.factor(sequence_position)),&#39;revpairwise&#39;))</code></pre>
<pre><code>EventData = 201, sequence_position = 1:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.01597 0.0118 Inf  -0.00721    0.0391

EventData = 202, sequence_position = 1:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD -0.10702 0.0795 Inf  -0.26284    0.0488

EventData = 203, sequence_position = 1:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD -0.05509 0.0559 Inf  -0.16472    0.0545

EventData = 204, sequence_position = 1:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD   nonEst     NA  NA        NA        NA

EventData = 201, sequence_position = 2:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.00380 0.0131 Inf  -0.02187    0.0295

EventData = 202, sequence_position = 2:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.10209 0.0407 Inf   0.02228    0.1819

EventData = 203, sequence_position = 2:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.02069 0.0295 Inf  -0.03722    0.0786

EventData = 204, sequence_position = 2:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.03305 0.0289 Inf  -0.02366    0.0898

EventData = 201, sequence_position = 3:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD -0.00513 0.0138 Inf  -0.03219    0.0219

EventData = 202, sequence_position = 3:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD -0.01503 0.0534 Inf  -0.11962    0.0896

EventData = 203, sequence_position = 3:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.01525 0.0534 Inf  -0.08943    0.1199

EventData = 204, sequence_position = 3:
 contrast      estimate     SE  df asymp.LCL asymp.UCL
 Control - ASD  0.00938 0.0448 Inf  -0.07838    0.0971

Note: contrasts are still on the scale(-0.00149, 0.0335) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>df_sepr_bayesian_habituation&lt;-df_trial[df_trial$sequence_position&lt;4,]

# A. translate data - make greta arrays
y &lt;- as_data(scale(df_sepr_bayesian_habituation$rpd_auc))
interaction_variable&lt;-with(df_sepr_bayesian_habituation,interaction(t1_diagnosis,sequence_position))
group_by_events &lt;- as_data(model.matrix(~interaction_variable-1, df_sepr_bayesian_habituation)) #alternative to dummy coding - remove intercept (-1)
subject_id &lt;- as.integer(factor(df_sepr_bayesian_habituation$subjects)) #random intercept (in LMM)

#define priors
int &lt;- normal(0, 1)
design_coef&lt;- normal(0, 1, dim=ncol(group_by_events))
sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- int + group_by_events %*% design_coef + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
m &lt;- model(design_coef)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups,) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 53.30438 mins</code></pre>
<pre class="r"><code>#save model
draws_SEPR_habituation&lt;-draws
save(draws_SEPR_habituation,file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_habituation.Rdata&#39;))

#posterior estimates
table(interaction_variable) #names of coefficients</code></pre>
<pre><code>interaction_variable
    ASD.1 Control.1     ASD.2 Control.2     ASD.3 Control.3 
    30019     20381     28749     19526     21081     14362 </code></pre>
<pre class="r"><code>point_estimate(draws_SEPR_habituation)</code></pre>
<pre><code>Point Estimate

Parameter        | Median | Mean |  MAP
---------------------------------------
design_coef[1,1] |   0.14 | 0.07 | 0.25
design_coef[2,1] |   0.15 | 0.10 | 0.41
design_coef[3,1] |   0.14 | 0.07 | 0.25
design_coef[4,1] |   0.15 | 0.10 | 0.27
design_coef[5,1] |   0.15 | 0.08 | 0.26
design_coef[6,1] |   0.14 | 0.09 | 0.26</code></pre>
<pre class="r"><code>ci(draws_SEPR_habituation,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter        |       89% ETI
--------------------------------
design_coef[1,1] | [-0.66, 0.64]
design_coef[2,1] | [-0.62, 0.69]
design_coef[3,1] | [-0.66, 0.64]
design_coef[4,1] | [-0.62, 0.70]
design_coef[5,1] | [-0.66, 0.64]
design_coef[6,1] | [-0.63, 0.68]</code></pre>
</div>
<div id="mismatch-negativity-between-groups" class="section level2">
<h2>mismatch negativity between groups</h2>
<pre class="r"><code>#MAIN MODEL - MN by group - random intercept
lmm_REML&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
            (1|id),data=df_trial)

#fixed effect significances
anova(lmm_REML)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF DenDF F value
EventData                           28.0534  9.3511     3 45389 10.6508
t1_diagnosis                         2.4324  2.4324     1   288  2.7705
EventCounter                         2.7991  2.7991     1 45553  3.1881
EventData:t1_diagnosis               3.9472  1.3157     3 45389  1.4986
EventData:EventCounter               3.8321  1.2774     3 45406  1.4549
t1_diagnosis:EventCounter            3.8420  3.8420     1 45553  4.3760
EventData:t1_diagnosis:EventCounter  7.1449  2.3816     3 45406  2.7126
                                       Pr(&gt;F)    
EventData                           5.384e-07 ***
t1_diagnosis                          0.09710 .  
EventCounter                          0.07418 .  
EventData:t1_diagnosis                0.21268    
EventData:EventCounter                0.22470    
t1_diagnosis:EventCounter             0.03645 *  
EventData:t1_diagnosis:EventCounter   0.04326 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#Bayes factor - group x task progression
lmm_ML&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
                (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~EventData+EventCounter+
                 EventData:EventCounter+EventData:t1_diagnosis:EventCounter+
                (1|id),data=df_trial,REML=F)

  BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
  BF_BIC</code></pre>
<pre><code>[1] 1.663145e-08</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|id),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model

anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF DenDF  F value
EventData                            27.812   9.271     3 45392  10.5588
t1_diagnosis                          1.077   1.077     1   302   1.2268
EventCounter                          3.724   3.724     1 45383   4.2416
scale(ageyrs)                       108.521 108.521     1   230 123.5999
scale(t1_piq)                         0.102   0.102     1   230   0.1166
sex                                   1.701   1.701     1   229   1.9373
scale(center_dev)                     1.606   1.606     1 10137   1.8294
as.factor(sampling_rate)              2.567   2.567     1   226   2.9234
scale(missing_data_trial)             3.715   3.715     1 45575   4.2309
EventData:t1_diagnosis                3.883   1.294     3 45391   1.4742
EventData:EventCounter                3.714   1.238     3 45417   1.4100
t1_diagnosis:EventCounter             3.584   3.584     1 45587   4.0825
EventData:t1_diagnosis:EventCounter   7.187   2.396     3 45417   2.7284
                                       Pr(&gt;F)    
EventData                           6.155e-07 ***
t1_diagnosis                          0.26892    
EventCounter                          0.03945 *  
scale(ageyrs)                       &lt; 2.2e-16 ***
scale(t1_piq)                         0.73312    
sex                                   0.16531    
scale(center_dev)                     0.17623    
as.factor(sampling_rate)              0.08867 .  
scale(missing_data_trial)             0.03970 *  
EventData:t1_diagnosis                0.21931    
EventData:EventCounter                0.23770    
t1_diagnosis:EventCounter             0.04334 *  
EventData:t1_diagnosis:EventCounter   0.04235 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#coefficient of determination
r2_nakagawa(lmm_full)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.128
     Marginal R2: 0.049</code></pre>
<pre class="r"><code>confint(contrast(emtrends(lmm_REML,~t1_diagnosis|EventData,var=&#39;EventCounter&#39;),&#39;pairwise&#39;))</code></pre>
<pre><code>EventData = 201:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control  9.96e-05 4.17e-05 Inf  1.79e-05  1.81e-04

EventData = 202:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control -4.21e-05 4.40e-05 Inf -1.28e-04  4.42e-05

EventData = 203:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control  1.13e-04 4.75e-05 Inf  2.01e-05  2.06e-04

EventData = 204:
 contrast       estimate       SE  df asymp.LCL asymp.UCL
 ASD - Control  1.65e-05 4.44e-05 Inf -7.05e-05  1.04e-04

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>      plot(emtrends(lmm_REML,~t1_diagnosis|EventData,var=&#39;EventCounter&#39;))</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/MMN%20task%20progression%20-%20LLM-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>##translate to changes across the task
confint(contrast(emmeans(lmm_REML,~EventCounter|t1_diagnosis+EventData,at=list(EventCounter =   seq(1,1400,1399))),&#39;revpairwise&#39;))</code></pre>
<pre><code>t1_diagnosis = ASD, EventData = 201:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.0699 0.0382 Inf  -0.00498    0.1449

t1_diagnosis = Control, EventData = 201:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1  -0.0694 0.0441 Inf  -0.15573    0.0170

t1_diagnosis = ASD, EventData = 202:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.0486 0.0389 Inf  -0.02769    0.1249

t1_diagnosis = Control, EventData = 202:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.1074 0.0477 Inf   0.01396    0.2009

t1_diagnosis = ASD, EventData = 203:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.0783 0.0418 Inf  -0.00370    0.1602

t1_diagnosis = Control, EventData = 203:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1  -0.0801 0.0516 Inf  -0.18133    0.0211

t1_diagnosis = ASD, EventData = 204:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.0460 0.0393 Inf  -0.03092    0.1230

t1_diagnosis = Control, EventData = 204:
 contrast                         estimate     SE  df asymp.LCL asymp.UCL
 EventCounter1400 - EventCounter1   0.0229 0.0481 Inf  -0.07146    0.1173

Note: contrasts are still on the scale(-11.2, 9.21) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 </code></pre>
<pre class="r"><code>#remove NA
df_bayesian_mmn&lt;-df_trial[!is.na(df_trial$mmn),]

# A. translate data - make greta arrays
y &lt;- as_data(scale(df_bayesian_mmn$mmn))
trials &lt;- as_data(scale(df_bayesian_mmn$EventCounter))
subject_id &lt;- as.integer(factor(df_bayesian_mmn$subjects)) #random intercept (in LMM)
events &lt;- as_data(model.matrix(~ EventData - 1, df_bayesian_mmn)) #alternative to dummy coding?
interaction_variable&lt;-with(df_bayesian_mmn,interaction(t1_diagnosis,EventData))
group_by_events &lt;- as_data(model.matrix(~interaction_variable-1, df_bayesian_mmn)) #alternative to dummy coding - remove intercept (-1)
#table(group_by_events[,1],group_by_events[,9])

#define priors
event_coefs&lt;- normal(0, 1, dim=ncol(events))
group_event_coefs &lt;- normal(0,1, dim=ncol(group_by_events))

sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- trials * group_by_events %*% group_event_coefs + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
#m &lt;- model(int, coef_201, coef_202, coef_203, coef_204, sd)
m &lt;- model(group_event_coefs)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 22.76704 mins</code></pre>
<pre class="r"><code>#estimator convergence
mcmc_trace(draws) #see whether chains converge and are stationary</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/MMN%20task%20progression%20-%20Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>mcmc_dens(draws) # + stable estimates</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/MMN%20task%20progression%20-%20Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>##results
mcmc_areas(draws, prob= .66, prob_outer = .95)+scale_y_discrete(labels=c(&#39;ASD-standard&#39;,&#39;TD-standard &#39;,&#39;ASD-pitch&#39;,&#39;TD-pitch&#39;,&#39;ASD-length &#39;,&#39;TD-length&#39;,&#39;ASD-pitch+length&#39;,&#39;TD-pitch+length&#39;))+coord_flip()+theme_bw()</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/MMN%20task%20progression%20-%20Bayesian-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#analyse
summary(draws)</code></pre>
<pre><code>
Iterations = 1:8000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 8000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

                           Mean      SD  Naive SE Time-series SE
group_event_coefs[1,1]  0.02172 0.01111 6.213e-05      9.737e-05
group_event_coefs[2,1] -0.01737 0.01280 7.153e-05      1.932e-04
group_event_coefs[3,1]  0.01354 0.01121 6.266e-05      9.009e-05
group_event_coefs[4,1]  0.03375 0.01405 7.854e-05      1.212e-04
group_event_coefs[5,1]  0.02034 0.01235 6.903e-05      1.025e-04
group_event_coefs[6,1] -0.02313 0.01510 8.443e-05      1.350e-04
group_event_coefs[7,1]  0.01843 0.01166 6.518e-05      9.694e-05
group_event_coefs[8,1]  0.01258 0.01378 7.704e-05      1.141e-04

2. Quantiles for each variable:

                             2.5%       25%      50%       75%    97.5%
group_event_coefs[1,1] -0.0002802  0.014147  0.02190  0.029176 0.043493
group_event_coefs[2,1] -0.0426913 -0.025872 -0.01736 -0.008814 0.007732
group_event_coefs[3,1] -0.0085864  0.006096  0.01356  0.020941 0.035771
group_event_coefs[4,1]  0.0061819  0.024292  0.03374  0.043205 0.061152
group_event_coefs[5,1] -0.0040494  0.012032  0.02038  0.028608 0.044365
group_event_coefs[6,1] -0.0528317 -0.033333 -0.02312 -0.012751 0.006048
group_event_coefs[7,1] -0.0045748  0.010725  0.01846  0.026105 0.041675
group_event_coefs[8,1] -0.0144356  0.003109  0.01273  0.021982 0.039558</code></pre>
<pre class="r"><code>#posterior predictive checking
coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator</code></pre>
<pre><code>Potential scale reduction factors:

                       Point est. Upper C.I.
group_event_coefs[1,1]          1       1.00
group_event_coefs[2,1]          1       1.01
group_event_coefs[3,1]          1       1.00
group_event_coefs[4,1]          1       1.00
group_event_coefs[5,1]          1       1.00
group_event_coefs[6,1]          1       1.00
group_event_coefs[7,1]          1       1.00
group_event_coefs[8,1]          1       1.00

Multivariate psrf

1</code></pre>
<pre class="r"><code>coda::effectiveSize(draws) #ESS - the higher the better</code></pre>
<pre><code>group_event_coefs[1,1] group_event_coefs[2,1] group_event_coefs[3,1] 
             13104.187               4537.384              15590.606 
group_event_coefs[4,1] group_event_coefs[5,1] group_event_coefs[6,1] 
             13503.386              14714.368              12729.302 
group_event_coefs[7,1] group_event_coefs[8,1] 
             14642.194              14703.406 </code></pre>
<pre class="r"><code>#save model
draws_MMN_threeway&lt;-draws
save(draws_MMN_threeway,file=paste0(project_path,&#39;/data/Bayesian_model_MMN_threewayinteraction.Rdata&#39;))

#posterior estimate
table(interaction_variable) #names of coefficients</code></pre>
<pre><code>interaction_variable
    ASD.201 Control.201     ASD.202 Control.202     ASD.203 Control.203 
       7347        5801        6486        4252        6504        4226 
    ASD.204 Control.204 
       6624        4380 </code></pre>
<pre class="r"><code>point_estimate(draws_MMN_threeway)</code></pre>
<pre><code>Point Estimate

Parameter              | Median |  Mean |   MAP
-----------------------------------------------
group_event_coefs[1,1] |   0.02 |  0.02 |  0.02
group_event_coefs[2,1] |  -0.02 | -0.02 | -0.02
group_event_coefs[3,1] |   0.01 |  0.01 |  0.01
group_event_coefs[4,1] |   0.03 |  0.03 |  0.03
group_event_coefs[5,1] |   0.02 |  0.02 |  0.02
group_event_coefs[6,1] |  -0.02 | -0.02 | -0.02
group_event_coefs[7,1] |   0.02 |  0.02 |  0.02
group_event_coefs[8,1] |   0.01 |  0.01 |  0.01</code></pre>
<pre class="r"><code>ci(draws_MMN_threeway,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter              |       89% ETI
--------------------------------------
group_event_coefs[1,1] | [ 0.00, 0.04]
group_event_coefs[2,1] | [-0.04, 0.00]
group_event_coefs[3,1] | [ 0.00, 0.03]
group_event_coefs[4,1] | [ 0.01, 0.06]
group_event_coefs[5,1] | [ 0.00, 0.04]
group_event_coefs[6,1] | [-0.05, 0.00]
group_event_coefs[7,1] | [ 0.00, 0.04]
group_event_coefs[8,1] | [-0.01, 0.03]</code></pre>
<pre class="r"><code>#MMN - continuous habituation
lmm_REML&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*sequence_position_z+
            (1|id),data=df_trial[df_trial$sequence_position&lt;10,])

anova(lmm_REML)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                           Sum Sq Mean Sq NumDF DenDF F value
EventData                                  36.880 12.2932     3 37901 13.9780
t1_diagnosis                                1.390  1.3900     1   253  1.5805
sequence_position_z                         2.014  2.0140     1 37939  2.2900
EventData:t1_diagnosis                      7.076  2.3586     3 37901  2.6819
EventData:sequence_position_z               6.717  2.2389     3 37920  2.5457
t1_diagnosis:sequence_position_z            2.849  2.8493     1 37939  3.2398
EventData:t1_diagnosis:sequence_position_z  2.464  0.8212     3 37920  0.9338
                                              Pr(&gt;F)    
EventData                                  4.189e-09 ***
t1_diagnosis                                 0.20985    
sequence_position_z                          0.13022    
EventData:t1_diagnosis                       0.04509 *  
EventData:sequence_position_z                0.05415 .  
t1_diagnosis:sequence_position_z             0.07188 .  
EventData:t1_diagnosis:sequence_position_z   0.42330    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#coefficient of determination
r2_nakagawa(lmm_REML)</code></pre>
<pre><code># R2 for Mixed Models

  Conditional R2: 0.127
     Marginal R2: 0.003</code></pre>
<pre class="r"><code>#Bayes factor - group x sequence position
lmm_ML&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*sequence_position_z+
                (1|id),data=df_trial,REML=F)

null_lmm_ML &lt;- lmer(scale(mmn)~EventData+EventCounter+
                 EventData:EventCounter+EventData:t1_diagnosis:EventCounter+
                (1|id),data=df_trial,REML=F)

  BF_BIC &lt;- exp((BIC(null_lmm_ML) - BIC(lmm_ML))/2)  # BICs to Bayes factor
  BF_BIC</code></pre>
<pre><code>[1] 1.470514e-11</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*sequence_position_z+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|id),data=df_trial[df_trial$sequence_position&lt;10,])
              


anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                            Sum Sq Mean Sq NumDF DenDF  F value
EventData                                   36.371  12.124     3 37907  13.7848
t1_diagnosis                                 0.378   0.378     1   249   0.4298
sequence_position_z                          2.009   2.009     1 37962   2.2837
scale(ageyrs)                              104.984 104.984     1   231 119.3684
scale(t1_piq)                                0.025   0.025     1   231   0.0283
sex                                          1.828   1.828     1   229   2.0790
scale(center_dev)                            0.954   0.954     1  8571   1.0852
as.factor(sampling_rate)                     1.651   1.651     1   227   1.8772
scale(missing_data_trial)                    3.305   3.305     1 38093   3.7573
EventData:t1_diagnosis                       7.070   2.357     3 37906   2.6795
EventData:sequence_position_z                6.624   2.208     3 37932   2.5105
t1_diagnosis:sequence_position_z             2.900   2.900     1 37960   3.2974
EventData:t1_diagnosis:sequence_position_z   2.493   0.831     3 37930   0.9449
                                              Pr(&gt;F)    
EventData                                   5.56e-09 ***
t1_diagnosis                                 0.51268    
sequence_position_z                          0.13075    
scale(ageyrs)                              &lt; 2.2e-16 ***
scale(t1_piq)                                0.86657    
sex                                          0.15070    
scale(center_dev)                            0.29756    
as.factor(sampling_rate)                     0.17201    
scale(missing_data_trial)                    0.05258 .  
EventData:t1_diagnosis                       0.04524 *  
EventData:sequence_position_z                0.05677 .  
t1_diagnosis:sequence_position_z             0.06940 .  
EventData:t1_diagnosis:sequence_position_z   0.41784    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(contrast(emmeans(lmm_REML,~EventData|t1_diagnosis),&#39;pairwise&#39;))</code></pre>
<pre><code>t1_diagnosis = ASD:
 contrast                    estimate     SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202   0.1083 0.0182 Inf  0.061427    0.1552
 EventData201 - EventData203   0.1486 0.0180 Inf  0.102410    0.1948
 EventData201 - EventData204   0.1192 0.0178 Inf  0.073348    0.1650
 EventData202 - EventData203   0.0403 0.0184 Inf -0.007108    0.0877
 EventData202 - EventData204   0.0109 0.0183 Inf -0.036180    0.0579
 EventData203 - EventData204  -0.0294 0.0181 Inf -0.075831    0.0170

t1_diagnosis = Control:
 contrast                    estimate     SE  df asymp.LCL asymp.UCL
 EventData201 - EventData202   0.0234 0.0222 Inf -0.033533    0.0803
 EventData201 - EventData203   0.0736 0.0219 Inf  0.017390    0.1299
 EventData201 - EventData204   0.0549 0.0216 Inf -0.000549    0.1104
 EventData202 - EventData203   0.0503 0.0228 Inf -0.008371    0.1089
 EventData202 - EventData204   0.0315 0.0225 Inf -0.026390    0.0895
 EventData203 - EventData204  -0.0187 0.0224 Inf -0.076184    0.0387

Note: contrasts are still on the scale(-11.2, 9.21) scale 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>#MMN - categorical habituation
lmm_REML&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*as.factor(sequence_position)+
            (1|id),data=df_trial[df_trial$sequence_position&lt;4,])

anova(lmm_REML)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                    Sum Sq Mean Sq NumDF
EventData                                           49.723 16.5743     3
t1_diagnosis                                         0.587  0.5873     1
as.factor(sequence_position)                         3.429  1.7147     2
EventData:t1_diagnosis                               4.121  1.3736     3
EventData:as.factor(sequence_position)              21.742  4.3484     5
t1_diagnosis:as.factor(sequence_position)            0.410  0.2049     2
EventData:t1_diagnosis:as.factor(sequence_position)  0.829  0.1658     5
                                                      DenDF F value    Pr(&gt;F)
EventData                                           19272.6 18.8919 3.138e-12
t1_diagnosis                                          253.3  0.6694 0.4140236
as.factor(sequence_position)                        19260.7  1.9544 0.1416747
EventData:t1_diagnosis                              19272.6  1.5656 0.1954198
EventData:as.factor(sequence_position)              19245.2  4.9564 0.0001545
t1_diagnosis:as.factor(sequence_position)           19260.7  0.2336 0.7917048
EventData:t1_diagnosis:as.factor(sequence_position) 19245.2  0.1889 0.9669030
                                                       
EventData                                           ***
t1_diagnosis                                           
as.factor(sequence_position)                           
EventData:t1_diagnosis                                 
EventData:as.factor(sequence_position)              ***
t1_diagnosis:as.factor(sequence_position)              
EventData:t1_diagnosis:as.factor(sequence_position)    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#remove NA
df_mmn_bayesian_habituation&lt;-df_trial[!is.na(df_trial$mmn) &amp; df_trial$sequence_position&lt;10,]

# A. translate data - make greta arrays
y &lt;- as_data(scale(df_mmn_bayesian_habituation$mmn))
subject_id &lt;- as.integer(factor(df_mmn_bayesian_habituation$subjects)) #random intercept (in LMM)
events &lt;- as_data(model.matrix(~ EventData - 1, df_trial)) #alternative to dummy coding?
interaction_variable&lt;-with(df_mmn_bayesian_habituation,interaction(t1_diagnosis,EventData))
group_by_events &lt;- as_data(model.matrix(~interaction_variable-1, df_mmn_bayesian_habituation)) #alternative to dummy coding - remove intercept (-1)
#table(group_by_events[,1],group_by_events[,9])

#define priors
event_coefs&lt;- normal(0, 1, dim=ncol(events))
group_event_coefs &lt;- normal(0,1, dim=ncol(group_by_events))

sd &lt;- cauchy(0, 3, truncation = c(0, Inf))
a_subject &lt;- normal(0, 1, dim = max(subject_id))

#OPERATIONS - MODEL
mean &lt;- group_by_events %*% group_event_coefs + a_subject[subject_id]

# likelihood - distribution over data
distribution(y) &lt;- normal(mean, sd)

# defining the model
#m &lt;- model(int, coef_201, coef_202, coef_203, coef_204, sd)
m &lt;- model(group_event_coefs)

# sampling
start &lt;-Sys.time()
draws &lt;- mcmc(m, n_samples = number_of_iterations, warmup = number_of_warmups) ###--&gt; test</code></pre>
<pre class="r"><code>Sys.time() - start</code></pre>
<pre><code>Time difference of 19.77386 mins</code></pre>
<pre class="r"><code># #estimator convergence
# mcmc_trace(draws) #see whether chains converge and are stationary
# mcmc_dens(draws) # + stable estimates
# 
# ##results
# mcmc_areas(draws, prob= .66, prob_outer = .89)+scale_y_discrete(labels=c(&#39;ASD-standard&#39;,&#39;TD-standard &#39;,&#39;ASD-pitch&#39;,&#39;TD-pitch&#39;,&#39;ASD-length &#39;,&#39;TD-length&#39;,&#39;ASD-pitch+length&#39;,&#39;TD-pitch+length&#39;))+coord_flip()+theme_bw()
# 
# #analyse
# summary(draws)
# 
# #posterior predictive checking
# coda::gelman.diag(draws) #Rhat &lt;= 1.01 is cutoff for reliable estimator
# coda::effectiveSize(draws) #ESS - the higher the better

#save model
draws_MMN_habituation&lt;-draws
save(draws_MMN_habituation,file=paste0(project_path,&#39;/data/Bayesian_model_MMN_habituation_continuous.Rdata&#39;))

#posterior estimate
table(interaction_variable) #names of coefficients</code></pre>
<pre><code>interaction_variable
    ASD.201 Control.201     ASD.202 Control.202     ASD.203 Control.203 
       6082        5022        5503        3603        5331        3456 
    ASD.204 Control.204 
       5506        3625 </code></pre>
<pre class="r"><code>point_estimate(draws_MMN_habituation)</code></pre>
<pre><code>Point Estimate

Parameter              |   Median |     Mean |      MAP
-------------------------------------------------------
group_event_coefs[1,1] |     0.02 |     0.02 |     0.02
group_event_coefs[2,1] |     0.06 |     0.06 |     0.05
group_event_coefs[3,1] |    -0.09 |    -0.09 |    -0.09
group_event_coefs[4,1] |     0.04 |     0.04 |     0.03
group_event_coefs[5,1] |    -0.12 |    -0.13 |    -0.12
group_event_coefs[6,1] |    -0.01 |    -0.01 |    -0.01
group_event_coefs[7,1] |    -0.10 |    -0.10 |    -0.10
group_event_coefs[8,1] | 9.09e-03 | 9.06e-03 | 8.74e-03</code></pre>
<pre class="r"><code>ci(draws_MMN_habituation,ci=credible_interval)</code></pre>
<pre><code>Equal-Tailed Interval

Parameter              |       89% ETI
--------------------------------------
group_event_coefs[1,1] | [-0.13, 0.17]
group_event_coefs[2,1] | [-0.13, 0.24]
group_event_coefs[3,1] | [-0.24, 0.06]
group_event_coefs[4,1] | [-0.15, 0.22]
group_event_coefs[5,1] | [-0.28, 0.02]
group_event_coefs[6,1] | [-0.20, 0.17]
group_event_coefs[7,1] | [-0.25, 0.05]
group_event_coefs[8,1] | [-0.18, 0.19]</code></pre>
</div>
<div id="computational-modelling---pcdm---neural-gain"
class="section level2">
<h2>computational modelling - PCDM - neural gain</h2>
<pre class="r"><code>#data quality for neural gain
with(df_timepoint,table(Rsq_pcdm&gt;=0.2,t1_diagnosis))</code></pre>
<pre><code>       t1_diagnosis
        ASD Control
  FALSE  91      66
  TRUE   95      65</code></pre>
<pre class="r"><code>chisq.test(with(df_timepoint,table(Rsq_pcdm&gt;=0.2,t1_diagnosis)))</code></pre>
<pre><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  with(df_timepoint, table(Rsq_pcdm &gt;= 0.2, t1_diagnosis))
X-squared = 0.019998, df = 1, p-value = 0.8875</code></pre>
<pre class="r"><code>#higher gain for standards in ASD
lm_gain&lt;-lm(scale(gain_pcdm)~t1_diagnosis,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])
summary(lm_gain) #higher gain in ASD for standards</code></pre>
<pre><code>
Call:
lm(formula = scale(gain_pcdm) ~ t1_diagnosis, data = df_timepoint[df_timepoint$Rsq_pcdm &gt; 
    0.2, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1775 -0.3402 -0.1553  0.1973  3.1694 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)           0.1628     0.1152   1.413   0.1601  
t1_diagnosisControl  -0.4005     0.1807  -2.217   0.0285 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9843 on 121 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.03902,   Adjusted R-squared:  0.03108 
F-statistic: 4.913 on 1 and 121 DF,  p-value: 0.02852</code></pre>
<pre class="r"><code>anova(lm_gain) #higher gain in ASD for standards</code></pre>
<pre><code>Analysis of Variance Table

Response: scale(gain_pcdm)
              Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
t1_diagnosis   1   4.761  4.7607  4.9134 0.02852 *
Residuals    121 117.239  0.9689                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>t.test(scale(gain_pcdm)~t1_diagnosis,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  scale(gain_pcdm) by t1_diagnosis
t = 2.3063, df = 117.65, p-value = 0.02284
alternative hypothesis: true difference in means between group ASD and group Control is not equal to 0
95 percent confidence interval:
 0.05661438 0.74445625
sample estimates:
    mean in group ASD mean in group Control 
            0.1628192            -0.2377161 </code></pre>
<pre class="r"><code>cohens_d(x=scale(gain_pcdm)~t1_diagnosis,data=df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])</code></pre>
<pre><code>Cohen&#39;s d |       95% CI
------------------------
0.41      | [0.04, 0.77]

- Estimated using pooled SD.</code></pre>
<pre class="r"><code>#--&gt; d=0.4 in ASD

#visualize
ggplot(df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2, ],aes(x=scale(gain_pcdm),fill=t1_diagnosis))+geom_histogram(aes(y = after_stat(density)),position=&#39;dodge&#39;,bins=20)+theme_bw()</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/PCDM_neural_gain_analysis-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###scaling with demographic data
summary(lm(scale(gain_pcdm)~ageyrs,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))</code></pre>
<pre><code>
Call:
lm(formula = scale(gain_pcdm) ~ ageyrs, data = df_timepoint[df_timepoint$Rsq_pcdm &gt; 
    0.2, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0882 -0.3376 -0.1195  0.1849  3.2269 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  0.31982    0.31523   1.015    0.312
ageyrs      -0.01759    0.01662  -1.059    0.292

Residual standard error: 0.9995 on 121 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.009179,  Adjusted R-squared:  0.0009906 
F-statistic: 1.121 on 1 and 121 DF,  p-value: 0.2918</code></pre>
<pre class="r"><code>summary(lm(scale(gain_pcdm)~t1_piq,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))</code></pre>
<pre><code>
Call:
lm(formula = scale(gain_pcdm) ~ t1_piq, data = df_timepoint[df_timepoint$Rsq_pcdm &gt; 
    0.2, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1583 -0.3146 -0.1220  0.1224  3.2992 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  0.193999   0.401211   0.484    0.630
t1_piq      -0.001963   0.003955  -0.496    0.621

Residual standard error: 1.003 on 121 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.002032,  Adjusted R-squared:  -0.006216 
F-statistic: 0.2463 on 1 and 121 DF,  p-value: 0.6206</code></pre>
<pre class="r"><code>summary(lm(scale(gain_pcdm)~sex,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))</code></pre>
<pre><code>
Call:
lm(formula = scale(gain_pcdm) ~ sex, data = df_timepoint[df_timepoint$Rsq_pcdm &gt; 
    0.2, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1526 -0.3197 -0.1336  0.1068  3.3304 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.003952   0.160788  -0.025    0.980
sexMale      0.005787   0.194566   0.030    0.976

Residual standard error: 1.004 on 121 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  7.312e-06, Adjusted R-squared:  -0.008257 
F-statistic: 0.0008847 on 1 and 121 DF,  p-value: 0.9763</code></pre>
<pre class="r"><code># summary(lm(scale(gain_pcdm)~rpd_auc.201,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))
# summary(lm(scale(gain_pcdm)~rpd_auc.202,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))
# summary(lm(scale(gain_pcdm)~rpd_auc.203,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))
# summary(lm(scale(gain_pcdm)~rpd_auc.204,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))
# summary(lm(scale(gain_pcdm)~pd_baseline,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))

#not altered by covariates
lmm_full&lt;-lm(scale(gain_pcdm)~t1_diagnosis+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)
               ,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])

anova(lmm_full) #higher gain in ASD for standards</code></pre>
<pre><code>Analysis of Variance Table

Response: scale(gain_pcdm)
                           Df  Sum Sq Mean Sq F value Pr(&gt;F)  
t1_diagnosis                1   4.761  4.7607  4.7179 0.0319 *
scale(ageyrs)               1   0.636  0.6356  0.6298 0.4290  
scale(t1_piq)               1   0.054  0.0540  0.0535 0.8175  
sex                         1   0.099  0.0990  0.0981 0.7547  
scale(center_dev)           1   0.224  0.2236  0.2216 0.6387  
as.factor(sampling_rate)    1   0.000  0.0004  0.0004 0.9845  
scale(missing_data_trial)   1   0.183  0.1832  0.1816 0.6708  
Residuals                 115 116.044  1.0091                 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="figure-group-differences-lmm" class="section level2">
<h2>figure group differences LMM</h2>
<p>added to a compostie figure - not evaluated</p>
<pre class="r"><code>#main models
BPS_progression&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial)

BPS_habituation&lt;-lmer(scale(pd_baseline)~t1_diagnosis*sequence_position+
                    (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;=10,])

SEPR_progression&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
              (1|subjects)+(1|wave),data=df_trial)

MMN_progression&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
              (1|id),data=df_trial)
  

#plot interaction
model_plot_data_BPS1&lt;-as.data.frame(emmeans(BPS_progression,~t1_diagnosis+EventCounter,
                                       at=list(EventCounter = seq(1,1400,140))))

g1&lt;-ggplot(model_plot_data_BPS1,aes(x=EventCounter,y=emmean,group=t1_diagnosis,color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  labs(x=&#39;task progression (trial)&#39;)+
  theme(axis.title.y=element_blank(),legend.position = &#39;none&#39;)

model_plot_data_BPS2&lt;-as.data.frame(emmeans(BPS_habituation,~t1_diagnosis+sequence_position,
                                       at=list(sequence_position = seq(1,10))))

g2&lt;-ggplot(model_plot_data_BPS2,aes(x=sequence_position,y=emmean,group=t1_diagnosis,color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_x_continuous(breaks=seq(0,10,1))+
  labs(x=&#39;sequence position&#39;)+
  theme(axis.title.y=element_blank(),legend.position = &#39;none&#39;)


model_plot_data_SEPR&lt;-as.data.frame(emmeans(SEPR_progression,~t1_diagnosis+EventData+EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
    labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball&quot;, &quot;204&quot; = &quot;pitch &amp; length oddball&quot;)
g3&lt;-ggplot(model_plot_data_SEPR,aes(x=EventCounter,y=emmean,
                           group=interaction(EventData,t1_diagnosis),color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  facet_wrap(~EventData,labeller=labeller(EventData = labels))+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;stimulus-evoked pupillary response - SEPR (z)&#39;)


model_plot_data_MMN&lt;-as.data.frame(emmeans(MMN_progression,~t1_diagnosis+EventData+EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
    labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball&quot;, &quot;204&quot; = &quot;pitch &amp; length oddball&quot;)
g4&lt;-ggplot(model_plot_data_MMN,aes(x=EventCounter,y=emmean,
                           group=interaction(EventData,t1_diagnosis),color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  facet_wrap(~EventData,labeller=labeller(EventData = labels))+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;mismatch negativity - MMN (z)&#39;)

  
lay &lt;- rbind(c(1,1,3,3,3,5),
             c(1,1,3,3,3,5),
             c(1,1,3,3,3,5),
             c(2,2,4,4,4,5),
             c(2,2,4,4,4,5),
             c(2,2,4,4,4,5))


g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}

mylegend_group&lt;-g_legend(g4)


#plot in markdown
grid.arrange(g1,g2,
             g3+theme(legend.position = &#39;none&#39;),
             g4+theme(legend.position = &#39;none&#39;),
             mylegend_group, left=&#39;baseline pupil size (z)&#39;, layout_matrix=lay)


#save to file
tiff(file=paste0(project_path,&quot;/output/figures/group_differences.tiff&quot;), # create a file in tiff format in current working directory
  width=9, height=7, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure
      
grid.arrange(g1,g2,
             g3+theme(legend.position = &#39;none&#39;),
             g4+theme(legend.position = &#39;none&#39;),
             mylegend_group, left=&#39;baseline pupil size (z)&#39;, layout_matrix=lay)

dev.off() #close operation and save file</code></pre>
</div>
<div id="figure-group-differences-bayesian" class="section level2">
<h2>figure group differences Bayesian</h2>
<p>added to a compostie figure - not evaluated</p>
<pre class="r"><code>#load Bayesian models
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_twoway.Rdata&#39;)) #draws_BPS_twoway
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_supp.Rdata&#39;)) #draws_BPS_supp
load(file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_threewayinteraction.Rdata&#39;)) #draws_SEPR_threeway
load(file=paste0(project_path,&#39;/data/Bayesian_model_MMN_threewayinteraction.Rdata&#39;)) #draws_MMN_threeway

# #posterior predictive checking
# coda::gelman.diag(draws_BPS_twoway) #Rhat &lt;= 1.01 is cutoff for reliable estimator
# coda::effectiveSize(draws_BPS_twoway) #ESS
# 
# coda::gelman.diag(draws_BPS_supp) #Rhat &lt;= 1.01 is cutoff for reliable estimator
# coda::effectiveSize(draws_BPS_supp) #ESS
# 
# coda::gelman.diag(draws_SEPR_threeway) #Rhat &lt;= 1.01 is cutoff for reliable estimator
# coda::effectiveSize(draws_SEPR_threeway) #ESS
# 
# coda::gelman.diag(draws_MMN_threeway) #Rhat &lt;= 1.01 is cutoff for reliable estimator
# coda::effectiveSize(draws_MMN_threeway) #ESS

#posterior estimates
# point_estimate(draws_BPS_twoway)
# ci(draws_BPS_twoway,ci=credible_interval)
# 
# point_estimate(draws_BPS_supp)
# ci(draws_BPS_supp,ci=credible_interval)
# 
# point_estimate(draws_SEPR_threeway)
# ci(draws_SEPR_threeway,ci=credible_interval)
# 
# point_estimate(draws_MMN_threeway)
# ci(draws_MMN_threeway,ci=credible_interval)


#draws_BPS_twoway
plot_data&lt;-mcmc_areas_data(draws_BPS_twoway,prob_outer = credible_interval)
g1a&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[1,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;AUT&#39;))+
  labs(y=&#39;posterior sampling: BPS - task progression&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[1],
                    labels=c(&#39;autistic&#39;))
g1b&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[2,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;NON-AUT&#39;))+
  labs(y=&#39;&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[2],
                    labels=c(&#39;non-autistic&#39;))
g1&lt;-grid.arrange(g1a,g1b,ncol=2)

#draws_BPS_supp
plot_data&lt;-mcmc_areas_data(draws_BPS_supp,prob_outer = credible_interval)
g2a&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[1,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;AUT&#39;))+
  labs(y=&#39;posterior sampling: BPS - sequence position&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[1],
                    labels=c(&#39;autistic&#39;))
g2b&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[2,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;NON-AUT&#39;))+
  labs(y=&#39;&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[2],
                    labels=c(&#39;non-autistic&#39;))
g2&lt;-grid.arrange(g2a,g2b,ncol=2)


#draws_SEPR_threeway
plot_data&lt;-mcmc_areas_data(draws_SEPR_threeway,prob_outer = credible_interval)
g3&lt;-ggplot(plot_data,aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75),scale=&#39;width&#39;)+
  scale_x_discrete(labels=rep(c(&#39;AUT&#39;,&#39;NON-AUT&#39;),4))+
  labs(y=&#39;posterior sampling: SEPR trend&#39;,x=&#39;&#39;)+
  scale_fill_manual(name = &#39;parameter: group x stimulus&#39;,
                    values = rep(custom_condition_colors,each=2),
                    labels=c(&#39;autistic - standard trial&#39;,&#39;non-autistic - standard trial&#39;,
                            &#39;autistic - pitch oddball&#39;,&#39;non-autistic - pitch oddball&#39;,
                            &#39;autistic - length oddball&#39;,&#39;non-autistic - length oddball&#39;,
                            &#39;autistic - pitch+length oddball&#39;,&#39;non-autistic - pitch+length oddball&#39;))
  

#draws_MMN_threeway 
plot_data&lt;-mcmc_areas_data(draws_MMN_threeway,prob_outer = credible_interval)
g4&lt;-ggplot(plot_data,aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75),scale=&#39;width&#39;)+
  scale_x_discrete(labels=rep(c(&#39;AUT&#39;,&#39;NON-AUT&#39;),4))+
  labs(y=&#39;posterior sampling: MMN trend&#39;,x=&#39;&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = rep(custom_condition_colors,each=2),
                    labels=c(&#39;standard trial&#39;,&#39;standard trial&#39;,
                            &#39;pitch oddball&#39;,&#39;pitch oddball&#39;,
                            &#39;length oddball&#39;,&#39;length oddball&#39;,
                            &#39;pitch+length oddball&#39;,&#39;pitch+length oddball&#39;))

###extract legends
#extract legend
g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}


plot_data&lt;-mcmc_areas_data(draws_BPS_supp,prob_outer = credible_interval)
g2_legend&lt;-ggplot(plot_data,aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;AUT&#39;,&#39;NON-AUT&#39;))+
  labs(y=&#39;posterior sampling: BPS - sequence position&#39;,x=&#39;&#39;)+
  scale_fill_manual(name = &#39;parameter: group&#39;,
                    values = custom_group_color,
                    labels=c(&#39;autistic&#39;,&#39;non-autistic&#39;))

mylegend_group&lt;-g_legend(g2_legend)
mylegend_stimulus&lt;-g_legend(g3)


grid.arrange(g1,
             g2,
             mylegend_group,
             g3+theme(legend.position = &#39;none&#39;),
             g4+theme(legend.position = &#39;none&#39;),
             mylegend_stimulus,
             nrow=2,
             ncol=3,
             widths=c(1,1,0.5))


#save to file
tiff(file=paste0(project_path,&quot;/output/figures/group_differences_Bayesian.tiff&quot;), # create a file in tiff format in current working directory
  width=12, height=8, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure
      
grid.arrange(g1,
             g2,
             mylegend_group,
             g3+theme(legend.position = &#39;none&#39;),
             g4+theme(legend.position = &#39;none&#39;),
             mylegend_stimulus,
             nrow=2,
             ncol=3,
             widths=c(1,1,0.5))

dev.off() #close operation and save file</code></pre>
</div>
<div id="figure-group-differences-lmm-bayesian" class="section level2">
<h2>figure group differences LMM + Bayesian</h2>
<pre class="r"><code>#main models - LMM --&gt; calculate
BPS_progression&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
              (1|subjects)+(1|wave),data=df_trial)

BPS_habituation&lt;-lmer(scale(pd_baseline)~t1_diagnosis*sequence_position+
                    (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;=10,])

SEPR_progression&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
              (1|subjects)+(1|wave),data=df_trial)

MMN_progression&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
              (1|id),data=df_trial)

#main models - Bayesian --&gt; load
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_twoway.Rdata&#39;)) #draws_BPS_twoway
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_supp.Rdata&#39;)) #draws_BPS_supp
load(file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_threewayinteraction.Rdata&#39;)) #draws_SEPR_threeway
load(file=paste0(project_path,&#39;/data/Bayesian_model_MMN_threewayinteraction.Rdata&#39;)) #draws_MMN_threeway

#figure BPS task progression ####

## figure BPS - LMM
model_plot_data_BPS1&lt;-as.data.frame(emmeans(BPS_progression,~t1_diagnosis+EventCounter,
                                       at=list(EventCounter = seq(1,1400,140))))
g1a&lt;-ggplot(model_plot_data_BPS1,aes(x=EventCounter,y=emmean,group=t1_diagnosis,color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;marginalized mean&#39;)
  
#figure BPS task progression - draws_BPS_twoway
plot_data&lt;-mcmc_areas_data(draws_BPS_twoway,prob_outer = credible_interval)
g1b1&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[1,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;autistic&#39;))+
  labs(y=&#39;posterior estimate of trend&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[1],
                    labels=c(&#39;autistic&#39;))

g1b2&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[2,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;non-autistic&#39;))+
  labs(y=&#39;&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[2],
                    labels=c(&#39;non-autistic&#39;))


#figure BPS habituation ####
 
# BPS habituation --&gt; LMM
model_plot_data_BPS2&lt;-as.data.frame(emmeans(BPS_habituation,~t1_diagnosis+sequence_position,
                                       at=list(sequence_position = seq(1,10))))

g2a&lt;-ggplot(model_plot_data_BPS2,aes(x=sequence_position,y=emmean,group=t1_diagnosis,color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_x_continuous(breaks=seq(0,10,1))+
  labs(x=&#39;sequence position&#39;,y=&#39;marginalized mean&#39;)

#draws_BPS_supp
plot_data&lt;-mcmc_areas_data(draws_BPS_supp,prob_outer = credible_interval)
g2b1&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[1,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;autistic&#39;))+
  labs(y=&#39;posterior estimate&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[1],
                    labels=c(&#39;autistic&#39;))
g2b2&lt;-ggplot(plot_data[plot_data$parameter==&quot;design_coef[2,1]&quot;,],aes(x=parameter,y=x,group=parameter,fill=parameter))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75))+
  scale_x_discrete(labels=c(&#39;non-autistic&#39;))+
  labs(y=&#39;&#39;,x=&#39;&#39;)+
  theme(legend.position = &#39;none&#39;)+
  scale_fill_manual(name = &#39;parameter: stimulus&#39;,
                    values = custom_group_color[2],
                    labels=c(&#39;non-autistic&#39;))


#figure SEPR ####

##SEPR LMM
model_plot_data_SEPR&lt;-as.data.frame(emmeans(SEPR_progression,~t1_diagnosis+EventData+EventCounter,
                                            at=list(EventCounter = seq(1,1400,140))))
labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, 
            &quot;202&quot; = &quot;pitch oddball&quot;, 
            &quot;203&quot; = &quot;length oddball&quot;, 
            &quot;204&quot; = &quot;pitch &amp; length oddball&quot;)
    
g3a&lt;-ggplot(model_plot_data_SEPR,aes(x=EventCounter,y=emmean,
                           group=interaction(EventData,t1_diagnosis),color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  facet_wrap(~EventData,labeller=labeller(EventData = labels),ncol=4)+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;marginalized mean&#39;)

#SEPR Bayesian
#draws_SEPR_threeway
plot_data&lt;-mcmc_areas_data(draws_SEPR_threeway,prob_outer = credible_interval)

plot_data$group&lt;-with(plot_data,
                         dplyr::case_when(
                           parameter %in% c(&quot;group_event_coefs[1,1]&quot;,
                                            &quot;group_event_coefs[3,1]&quot;,
                                            &quot;group_event_coefs[5,1]&quot;,
                                            &quot;group_event_coefs[7,1]&quot;) ~ &quot;autistic&quot;,
                           parameter %in% c(&quot;group_event_coefs[2,1]&quot;,
                                            &quot;group_event_coefs[4,1]&quot;,
                                            &quot;group_event_coefs[6,1]&quot;,
                                            &quot;group_event_coefs[8,1]&quot;) ~ &quot;non-autistic&quot;))
                           
plot_data$stimulus&lt;-with(plot_data,
                         dplyr::case_when(
                           parameter %in% c(&quot;group_event_coefs[1,1]&quot;,
                                            &quot;group_event_coefs[2,1]&quot;) ~ &quot;standard&quot;,
                           parameter %in% c(&quot;group_event_coefs[3,1]&quot;,
                                            &quot;group_event_coefs[4,1]&quot;) ~ &quot;pitch oddball&quot;,
                           parameter %in% c(&quot;group_event_coefs[5,1]&quot;,
                                            &quot;group_event_coefs[6,1]&quot;) ~ &quot;length oddball&quot;,
                           parameter %in% c(&quot;group_event_coefs[7,1]&quot;,
                                            &quot;group_event_coefs[8,1]&quot;) ~ &quot;pitch+length oddball&quot;))

plot_data$stimulus&lt;-factor(plot_data$stimulus,levels=c(&#39;standard&#39;,&#39;pitch oddball&#39;,&#39;length oddball&#39;,&#39;pitch+length oddball&#39;))

g3b&lt;-ggplot(plot_data,aes(x=group,y=x,fill=group))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75),scale=&#39;width&#39;)+
  labs(y=&#39;posterior estimate of trend&#39;,x=&#39;&#39;)+
  scale_fill_manual(name = &#39;group&#39;,
                    values = custom_group_color)+
  facet_wrap(~stimulus,ncol=4)
  

#figure MMN ####

#MMN LMM
model_plot_data_MMN&lt;-as.data.frame(emmeans(MMN_progression,~t1_diagnosis+EventData+EventCounter,at=list(EventCounter = seq(1,1400,140))))
    
labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, 
            &quot;202&quot; = &quot;pitch oddball&quot;, 
            &quot;203&quot; = &quot;length oddball&quot;, 
            &quot;204&quot; = &quot;pitch &amp; length oddball&quot;)
    
g4a&lt;-ggplot(model_plot_data_MMN,aes(x=EventCounter,y=emmean,
                           group=interaction(EventData,t1_diagnosis),color=t1_diagnosis))+
  geom_crossbar(aes(ymin=emmean-1*SE,ymax=emmean+1*SE,fill=t1_diagnosis),alpha=0.8,position=&#39;dodge&#39;)+
  geom_errorbar(aes(ymin=asymp.LCL,ymax=asymp.UCL),position=&#39;dodge&#39;)+
  scale_color_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  scale_fill_manual(name = &quot;groups&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
  facet_wrap(~EventData,labeller=labeller(EventData = labels),ncol=4)+
  labs(x=&#39;task progression (trial)&#39;,y=&#39;marginalized mean&#39;)

#MMN Bayesian
#draws_MMN_threeway
plot_data&lt;-mcmc_areas_data(draws_MMN_threeway,prob_outer = credible_interval)

plot_data$group&lt;-with(plot_data,
                         dplyr::case_when(
                           parameter %in% c(&quot;group_event_coefs[1,1]&quot;,
                                            &quot;group_event_coefs[3,1]&quot;,
                                            &quot;group_event_coefs[5,1]&quot;,
                                            &quot;group_event_coefs[7,1]&quot;) ~ &quot;autistic&quot;,
                           parameter %in% c(&quot;group_event_coefs[2,1]&quot;,
                                            &quot;group_event_coefs[4,1]&quot;,
                                            &quot;group_event_coefs[6,1]&quot;,
                                            &quot;group_event_coefs[8,1]&quot;) ~ &quot;non-autistic&quot;))
                           
plot_data$stimulus&lt;-with(plot_data,
                         dplyr::case_when(
                           parameter %in% c(&quot;group_event_coefs[1,1]&quot;,
                                            &quot;group_event_coefs[2,1]&quot;) ~ &quot;standard&quot;,
                           parameter %in% c(&quot;group_event_coefs[3,1]&quot;,
                                            &quot;group_event_coefs[4,1]&quot;) ~ &quot;pitch oddball&quot;,
                           parameter %in% c(&quot;group_event_coefs[5,1]&quot;,
                                            &quot;group_event_coefs[6,1]&quot;) ~ &quot;length oddball&quot;,
                           parameter %in% c(&quot;group_event_coefs[7,1]&quot;,
                                            &quot;group_event_coefs[8,1]&quot;) ~ &quot;pitch+length oddball&quot;))

plot_data$stimulus&lt;-factor(plot_data$stimulus,levels=c(&#39;standard&#39;,&#39;pitch oddball&#39;,&#39;length oddball&#39;,&#39;pitch+length oddball&#39;))

g4b&lt;-ggplot(plot_data,aes(x=group,y=x,fill=group))+
  geom_violin(draw_quantiles = c(0.25,0.5,0.75),scale=&#39;width&#39;)+
  labs(y=&#39;posterior estimate of trend&#39;,x=&#39;&#39;)+
  scale_fill_manual(name = &#39;group&#39;,
                    values = custom_group_color)+
  facet_wrap(~stimulus,ncol=4)


#create composite figure - formatting####
g1b&lt;-grid.arrange(g1b1,g1b2,ncol=2)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g1&lt;-grid.arrange(g1a+theme(legend.position = &#39;none&#39;),
             g1b,
                 left=&#39;baseline pupil size (BPS, z)&#39;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g2b&lt;-grid.arrange(g2b1,g2b2,ncol=2)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g2&lt;-grid.arrange(g2a+theme(legend.position = &#39;none&#39;),
                 g2b,
                 left=&#39;baseline pupil size (BPS, z)&#39;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g3&lt;-grid.arrange(g3a+theme(legend.position = &#39;none&#39;),
                 g3b+theme(legend.position = &#39;none&#39;),
                 nrow=2,left=&#39;stimulus-evoked pupillary response (SEPR, z)&#39;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g4&lt;-grid.arrange(g4a+theme(legend.position = &#39;none&#39;),
                 g4b+theme(legend.position = &#39;none&#39;),
                 nrow=2,left=&#39;mismatch-negativity-associated amplitude (MMN-amp, z)&#39;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>lay &lt;- rbind(c(1,1,2,2),
             c(3,3,3,3),
             c(4,4,4,4))

grid.arrange(g1,g2,g3,g4,layout_matrix=lay)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20group%20differences%20LMM%20and%20Bayesian-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#save to file ####
tiff(file=paste0(project_path,&quot;/output/figures/group_differences_LMM_Bayesian_combined.tiff&quot;), # create a file in tiff format in current working directory
  width=8, height=16, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(g1,g2,g3,g4,layout_matrix=lay)

dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="supplementary-analyses" class="section level1">
<h1>supplementary analyses</h1>
<div id="descriptives-per-participant" class="section level2">
<h2>descriptives per participant</h2>
<div
id="descriptive-statistics-of-dependent-variables---per-participant"
class="section level3">
<h3>descriptive statistics of dependent variables - per participant</h3>
<pre class="r"><code>descriptive_table_data&lt;-
  
  rbind(
    psych::describe(df_timepoint$pd)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$rpd_auc.201)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$rpd_auc.202)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$rpd_auc.203)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$rpd_auc.204)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$mmn.201)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$mmn.202)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$mmn.203)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$mmn.204)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
    psych::describe(df_timepoint$gain_pcdm)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)]
    )


descriptive_table_data&lt;-round(descriptive_table_data,3)

  variable&lt;-c(&#39;BPS&#39;,
    &#39;SEPR - standard&#39;,&#39;SEPR - pitch oddball&#39;,
    &#39;SEPR - length oddball&#39;,&#39;SEPR - pitch+length oddball&#39;,
    &#39;MMN - standard&#39;,&#39;MMN - pitch oddball&#39;,
    &#39;MMN - length oddball&#39;,&#39;MMN - pitch+length oddball&#39;,
    &#39;NG&#39;)

descriptive_table_data&lt;-cbind(variable,descriptive_table_data)

#produce table
descriptive_table_format&lt;-descriptive_table_data %&gt;%
    kbl(caption = &quot;Per-participant level: Descriptive statistics of baseline pupil size (BPS), stimulus-evoked pupillary response (SEPR), mismatch negativity (MMN), and neural gain (NG)&quot;,row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

descriptive_table_format</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per-participant level: Descriptive statistics of baseline pupil size
(BPS), stimulus-evoked pupillary response (SEPR), mismatch negativity
(MMN), and neural gain (NG)
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
skew
</th>
<th style="text-align:right;">
kurtosis
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BPS
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
3.445
</td>
<td style="text-align:right;">
0.522
</td>
<td style="text-align:right;">
2.256
</td>
<td style="text-align:right;">
5.884
</td>
<td style="text-align:right;">
0.702
</td>
<td style="text-align:right;">
1.188
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - standard
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
-0.035
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
2.509
</td>
<td style="text-align:right;">
40.702
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch oddball
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.077
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
-3.937
</td>
<td style="text-align:right;">
31.571
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - length oddball
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.046
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
4.223
</td>
<td style="text-align:right;">
46.168
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch+length oddball
</td>
<td style="text-align:right;">
317
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
-0.033
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
-1.227
</td>
<td style="text-align:right;">
4.825
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - standard
</td>
<td style="text-align:right;">
241
</td>
<td style="text-align:right;">
-10.641
</td>
<td style="text-align:right;">
3.570
</td>
<td style="text-align:right;">
-23.246
</td>
<td style="text-align:right;">
-3.316
</td>
<td style="text-align:right;">
-0.766
</td>
<td style="text-align:right;">
0.559
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch oddball
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
-11.551
</td>
<td style="text-align:right;">
3.907
</td>
<td style="text-align:right;">
-21.863
</td>
<td style="text-align:right;">
-3.060
</td>
<td style="text-align:right;">
-0.536
</td>
<td style="text-align:right;">
-0.397
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - length oddball
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
-11.881
</td>
<td style="text-align:right;">
3.672
</td>
<td style="text-align:right;">
-22.399
</td>
<td style="text-align:right;">
-3.680
</td>
<td style="text-align:right;">
-0.500
</td>
<td style="text-align:right;">
-0.142
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch+length oddball
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
-11.741
</td>
<td style="text-align:right;">
3.852
</td>
<td style="text-align:right;">
-23.071
</td>
<td style="text-align:right;">
-0.170
</td>
<td style="text-align:right;">
-0.433
</td>
<td style="text-align:right;">
0.109
</td>
</tr>
<tr>
<td style="text-align:left;">
NG
</td>
<td style="text-align:right;">
267
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
-0.164
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
1.125
</td>
<td style="text-align:right;">
6.408
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(descriptive_table_format,file=paste0(project_path,&#39;/output/supplements/descriptivestatistics_DV_perparticipant.html&#39;))</code></pre>
</div>
<div id="histograms-of-dependent-variables---per-participant"
class="section level3">
<h3>histograms of dependent variables - per participant</h3>
<pre class="r"><code>grid.arrange(
  ggplot(df_timepoint,aes(x=pd))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;BPS (mm)&#39;),
  ggplot(df_timepoint,aes(x=gain_pcdm))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;neural gain (z)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.201))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - standard (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.202))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.203))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - length oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.204))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch+length oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=mmn.201))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - standard (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.202))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch oddball (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.203))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - length oddball (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.204))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch+length oddball (uV)&#39;),
  ncol=2)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/historgram%20of%20dependent%20variables%20-%20per%20participant-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#save to file
tiff(file=paste0(project_path,&quot;/output/supplements/histograms_dependentvariables_perparticipant.tiff&quot;), # create a file in tiff format in current working directory
  width=8, height=12, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(
  ggplot(df_timepoint,aes(x=pd))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;BPS (mm)&#39;),
  ggplot(df_timepoint,aes(x=gain_pcdm))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;neural gain (z)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.201))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - standard (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.202))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.203))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - length oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=rpd_auc.204))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch+length oddball (mm)&#39;),
  ggplot(df_timepoint,aes(x=mmn.201))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - standard (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.202))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch oddball (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.203))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - length oddball (uV)&#39;),
  ggplot(df_timepoint,aes(x=mmn.204))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch+length oddball (uV)&#39;),
  ncol=2)

dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="group-comparisons-per-participant" class="section level2">
<h2>group comparisons per-participant</h2>
<pre class="r"><code>### table

BPS_group&lt;-c(summary(lm&lt;-lm(scale(pd)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
  summary(lm&lt;-lm(scale(pd)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])

NG_group&lt;-c(summary(lm&lt;-lm(scale(gain_pcdm)~t1_diagnosis,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))[[&#39;fstatistic&#39;]],
             summary(lm&lt;-lm(scale(gain_pcdm)~t1_diagnosis,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,]))[[&#39;coefficients&#39;]][2,c(1,2,4)])

SEPR_201_group&lt;-c(summary(lm&lt;-lm(scale(rpd_auc.201)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
             summary(lm&lt;-lm(scale(rpd_auc.201)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
SEPR_202_group&lt;-c(summary(lm&lt;-lm(scale(rpd_auc.202)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(rpd_auc.202)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
SEPR_203_group&lt;-c(summary(lm&lt;-lm(scale(rpd_auc.203)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(rpd_auc.203)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
SEPR_204_group&lt;-c(summary(lm&lt;-lm(scale(rpd_auc.204)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(rpd_auc.204)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])

MMN_201_group&lt;-c(summary(lm&lt;-lm(scale(mmn.201)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(mmn.201)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
MMN_202_group&lt;-c(summary(lm&lt;-lm(scale(mmn.202)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(mmn.202)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
MMN_203_group&lt;-c(summary(lm&lt;-lm(scale(mmn.203)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(mmn.203)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])
MMN_204_group&lt;-c(summary(lm&lt;-lm(scale(mmn.204)~t1_diagnosis,df_timepoint))[[&#39;fstatistic&#39;]],
                  summary(lm&lt;-lm(scale(mmn.204)~t1_diagnosis,df_timepoint))[[&#39;coefficients&#39;]][2,c(1,2,4)])

group_comparison_table&lt;-round(rbind(BPS_group,NG_group,
      SEPR_201_group,SEPR_202_group,SEPR_203_group,SEPR_204_group,
      MMN_201_group,MMN_202_group,MMN_203_group,MMN_204_group),3)


row_names&lt;-c(&#39;BPS - across stimuli&#39;,&#39;NG - standards&#39;,
            &#39;SEPR - standards&#39;,&#39;SEPR - pitch oddball&#39;,&#39;SEPR - length oddball&#39;,&#39;SEPR - pitch+length oddball&#39;,
            &#39;MMN - standards&#39;,&#39;MMN - pitch oddball&#39;,&#39;MMN - length oddball&#39;,&#39;MMN - pitch+length oddball&#39;)

group_comparison_table&lt;-cbind(row_names,group_comparison_table)

#produce table
group_comparison_table_format&lt;-group_comparison_table %&gt;%
  kbl(caption = &quot;Per-participant level: Group comparisons of baseline pupil size (BPS), stimulus-evoked pupillary response (SEPR), mismatch negativity (MMN), and neural gain (NG)&quot;,
      row.names = F, col.names = c(&#39;&#39;,&#39;F&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;b&#39;,&#39;std. error&#39;,&#39;p&#39;)) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

group_comparison_table_format</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per-participant level: Group comparisons of baseline pupil size (BPS),
stimulus-evoked pupillary response (SEPR), mismatch negativity (MMN),
and neural gain (NG)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
F
</th>
<th style="text-align:left;">
df1
</th>
<th style="text-align:left;">
df2
</th>
<th style="text-align:left;">
b
</th>
<th style="text-align:left;">
std. error
</th>
<th style="text-align:left;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BPS - across stimuli
</td>
<td style="text-align:left;">
5.208
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:left;">
-0.257
</td>
<td style="text-align:left;">
0.113
</td>
<td style="text-align:left;">
0.023
</td>
</tr>
<tr>
<td style="text-align:left;">
NG - standards
</td>
<td style="text-align:left;">
4.913
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
121
</td>
<td style="text-align:left;">
-0.401
</td>
<td style="text-align:left;">
0.181
</td>
<td style="text-align:left;">
0.029
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - standards
</td>
<td style="text-align:left;">
0.14
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:left;">
-0.042
</td>
<td style="text-align:left;">
0.114
</td>
<td style="text-align:left;">
0.709
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch oddball
</td>
<td style="text-align:left;">
0.213
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
314
</td>
<td style="text-align:left;">
0.053
</td>
<td style="text-align:left;">
0.114
</td>
<td style="text-align:left;">
0.645
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - length oddball
</td>
<td style="text-align:left;">
0.535
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
316
</td>
<td style="text-align:left;">
0.083
</td>
<td style="text-align:left;">
0.114
</td>
<td style="text-align:left;">
0.465
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch+length oddball
</td>
<td style="text-align:left;">
0.071
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
315
</td>
<td style="text-align:left;">
0.03
</td>
<td style="text-align:left;">
0.114
</td>
<td style="text-align:left;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - standards
</td>
<td style="text-align:left;">
0.027
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
239
</td>
<td style="text-align:left;">
0.022
</td>
<td style="text-align:left;">
0.132
</td>
<td style="text-align:left;">
0.869
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch oddball
</td>
<td style="text-align:left;">
1.648
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
238
</td>
<td style="text-align:left;">
0.169
</td>
<td style="text-align:left;">
0.132
</td>
<td style="text-align:left;">
0.201
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - length oddball
</td>
<td style="text-align:left;">
1.552
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
238
</td>
<td style="text-align:left;">
0.164
</td>
<td style="text-align:left;">
0.132
</td>
<td style="text-align:left;">
0.214
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch+length oddball
</td>
<td style="text-align:left;">
0.83
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
238
</td>
<td style="text-align:left;">
0.12
</td>
<td style="text-align:left;">
0.132
</td>
<td style="text-align:left;">
0.363
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(group_comparison_table_format,file=paste0(project_path,&#39;/output/supplements/table_groupcomparison_perparticipant.html&#39;))</code></pre>
</div>
<div id="covariate-effects-on-group-comparisons-per-partiicpant"
class="section level2">
<h2>covariate effects on group comparisons per-partiicpant</h2>
<pre class="r"><code># significant covariate models ####
#full model - PD
lm&lt;-lm(scale(pd)~t1_diagnosis+
         scale(ageyrs)+scale(t1_piq)+sex+
         as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)
       ,df_timepoint)

  ##supplements - full table
  row_names&lt;-c(&#39;intercept&#39;,&#39;group&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;residuals&#39;)


  table_data_model&lt;-round(Anova(lm,type=3),3)
  table_data_model&lt;-cbind(row_names,table_data_model)

  table_data_model</code></pre>
<pre><code>                                      row_names  Sum Sq  Df F value Pr(&gt;F)
(Intercept)                           intercept   1.062   1   1.266  0.261
t1_diagnosis                              group   2.688   1   3.204  0.074
scale(ageyrs)                               age  48.850   1  58.222  0.000
scale(t1_piq)                     perceptual IQ   3.939   1   4.694  0.031
sex                                         sex   1.218   1   1.452  0.229
as.factor(sampling_rate)          sampling rate   0.049   1   0.058  0.810
scale(center_dev)         gaze center deviation   0.005   1   0.005  0.941
scale(missing_data_trial)          data quality   0.228   1   0.272  0.603
Residuals                             residuals 263.452 314      NA     NA</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Per participant: Full Linear model of baseline pupil size (BPS) with all potential covariates&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;df&#39;,&#39;F&#39;,&#39;p&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per participant: Full Linear model of baseline pupil size (BPS) with all
potential covariates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
1.062
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.266
</td>
<td style="text-align:right;">
0.261
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
2.688
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.204
</td>
<td style="text-align:right;">
0.074
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
48.850
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
58.222
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
3.939
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.694
</td>
<td style="text-align:right;">
0.031
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1.218
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.452
</td>
<td style="text-align:right;">
0.229
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.810
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.941
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
0.228
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.272
</td>
<td style="text-align:right;">
0.603
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:right;">
263.452
</td>
<td style="text-align:right;">
314
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_linearmodel_BPS_allcovariates.html&#39;))

#significant covariate model - PD
lm&lt;-lm(scale(pd)~t1_diagnosis+
         scale(ageyrs)+scale(t1_piq)
       ,df_timepoint)

  ##supplements - full table
  row_names&lt;-c(&#39;intercept&#39;,&#39;group&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;residuals&#39;)


  table_data_model&lt;-round(Anova(lm,type=3),3)
  table_data_model&lt;-cbind(row_names,table_data_model)

  table_data_model</code></pre>
<pre><code>                  row_names  Sum Sq  Df F value Pr(&gt;F)
(Intercept)       intercept   0.973   1   1.168  0.281
t1_diagnosis          group   2.349   1   2.819  0.094
scale(ageyrs)           age  49.387   1  59.272  0.000
scale(t1_piq) perceptual IQ   4.796   1   5.756  0.017
Residuals         residuals 264.967 318      NA     NA</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Per participant: Reduced Linear model of baseline pupil size (BPS) with significant covariates&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;df&#39;,&#39;F&#39;,&#39;p&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per participant: Reduced Linear model of baseline pupil size (BPS) with
significant covariates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.973
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.168
</td>
<td style="text-align:right;">
0.281
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
2.349
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.819
</td>
<td style="text-align:right;">
0.094
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
49.387
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
59.272
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
4.796
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.756
</td>
<td style="text-align:right;">
0.017
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:right;">
264.967
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_linearmodel_BPS_signcovariates.html&#39;))



# full modelNG
lm&lt;-lm(scale(gain_pcdm)~t1_diagnosis+
         scale(ageyrs)+scale(t1_piq)+sex+
         as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)
       ,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])

  ##supplements - full table
  row_names&lt;-c(&#39;intercept&#39;,&#39;group&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;residuals&#39;)


  table_data_model&lt;-round(Anova(lm,type=3),3)
  table_data_model&lt;-cbind(row_names,table_data_model)

  table_data_model</code></pre>
<pre><code>                                      row_names  Sum Sq  Df F value Pr(&gt;F)
(Intercept)                           intercept   0.592   1   0.587  0.445
t1_diagnosis                              group   3.753   1   3.719  0.056
scale(ageyrs)                               age   0.763   1   0.756  0.386
scale(t1_piq)                     perceptual IQ   0.108   1   0.108  0.744
sex                                         sex   0.074   1   0.073  0.787
as.factor(sampling_rate)          sampling rate   0.000   1   0.000  0.998
scale(center_dev)         gaze center deviation   0.253   1   0.251  0.618
scale(missing_data_trial)          data quality   0.183   1   0.182  0.671
Residuals                             residuals 116.044 115      NA     NA</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Per participant: Full Linear model of neural gain (NG) with all potential covariates&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;df&#39;,&#39;F&#39;,&#39;p&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per participant: Full Linear model of neural gain (NG) with all
potential covariates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.592
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.587
</td>
<td style="text-align:right;">
0.445
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
3.753
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.719
</td>
<td style="text-align:right;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.763
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.756
</td>
<td style="text-align:right;">
0.386
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
0.744
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:right;">
0.787
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.998
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
0.253
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.251
</td>
<td style="text-align:right;">
0.618
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
0.183
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
0.671
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:right;">
116.044
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_linearmodel_NG_allcovariates.html&#39;))



#significant covariate model - NG
lm&lt;-lm(scale(gain_pcdm)~t1_diagnosis
       ,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])

    ##supplements - full table
    row_names&lt;-c(&#39;intercept&#39;,&#39;group&#39;,&#39;residuals&#39;)

    table_data_model&lt;-round(Anova(lm,type=3),3)
    table_data_model&lt;-cbind(row_names,table_data_model)

    table_data_model</code></pre>
<pre><code>             row_names  Sum Sq  Df F value Pr(&gt;F)
(Intercept)  intercept   1.935   1   1.997  0.160
t1_diagnosis     group   4.761   1   4.913  0.029
Residuals    residuals 117.239 121      NA     NA</code></pre>
<pre class="r"><code>    table_model&lt;-table_data_model %&gt;%
      kbl(caption = &quot;Per participant: Reduced Linear model of neural gain (NG) with significant covariates&quot;,
          col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;df&#39;,&#39;F&#39;,&#39;p&#39;),
          row.names = F) %&gt;%
      kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

    table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per participant: Reduced Linear model of neural gain (NG) with
significant covariates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
1.935
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.997
</td>
<td style="text-align:right;">
0.160
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
4.761
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.913
</td>
<td style="text-align:right;">
0.029
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:right;">
117.239
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>    save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_linearmodel_NG_signcovariates.html&#39;))</code></pre>
</div>
<div id="descriptives-per-trial" class="section level2">
<h2>descriptives per trial</h2>
<div id="descriptive-statistics-of-dependent-variables---per-trial"
class="section level3">
<h3>descriptive statistics of dependent variables - per trial</h3>
<pre class="r"><code>descriptive_table_data&lt;-
  
rbind(
psych::describe(df_trial$pd_baseline)[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$rpd_auc[df_trial$EventData==&#39;201&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$rpd_auc[df_trial$EventData==&#39;202&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$rpd_auc[df_trial$EventData==&#39;203&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$rpd_auc[df_trial$EventData==&#39;204&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$mmn[df_trial$EventData==&#39;201&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$mmn[df_trial$EventData==&#39;202&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$mmn[df_trial$EventData==&#39;203&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)],
psych::describe(df_trial$mmn[df_trial$EventData==&#39;204&#39;])[c(&#39;n&#39;,&#39;mean&#39;,&#39;sd&#39;,&#39;min&#39;,&#39;max&#39;,&#39;skew&#39;,&#39;kurtosis&#39;)]

)


descriptive_table_data&lt;-round(descriptive_table_data,3)

  variable&lt;-c(&#39;BPS&#39;,
    &#39;SEPR - standard&#39;,&#39;SEPR - pitch oddball&#39;,
    &#39;SEPR - length oddball&#39;,&#39;SEPR - pitch+length oddball&#39;,
    &#39;MMN - standard&#39;,&#39;MMN - pitch oddball&#39;,
    &#39;MMN - length oddball&#39;,&#39;MMN - pitch+length oddball&#39;)

descriptive_table_data&lt;-cbind(variable,descriptive_table_data)

#produce table
descriptive_table_format&lt;-descriptive_table_data %&gt;%
    kbl(caption = &quot;Per-trial level: Descriptive statistics of baseline pupil size (BPS), stimulus-evoked pupillary response (SEPR), and mismatch negativity (MMN)&quot;,row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

descriptive_table_format</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Per-trial level: Descriptive statistics of baseline pupil size (BPS),
stimulus-evoked pupillary response (SEPR), and mismatch negativity (MMN)
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
skew
</th>
<th style="text-align:right;">
kurtosis
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BPS
</td>
<td style="text-align:right;">
298934
</td>
<td style="text-align:right;">
3.407
</td>
<td style="text-align:right;">
0.550
</td>
<td style="text-align:right;">
1.952
</td>
<td style="text-align:right;">
6.399
</td>
<td style="text-align:right;">
0.629
</td>
<td style="text-align:right;">
0.986
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - standard
</td>
<td style="text-align:right;">
248260
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-0.352
</td>
<td style="text-align:right;">
0.303
</td>
<td style="text-align:right;">
-0.536
</td>
<td style="text-align:right;">
3.585
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch oddball
</td>
<td style="text-align:right;">
14758
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-0.256
</td>
<td style="text-align:right;">
0.219
</td>
<td style="text-align:right;">
-0.514
</td>
<td style="text-align:right;">
3.597
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - length oddball
</td>
<td style="text-align:right;">
17419
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
-0.268
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
-0.517
</td>
<td style="text-align:right;">
3.154
</td>
</tr>
<tr>
<td style="text-align:left;">
SEPR - pitch+length oddball
</td>
<td style="text-align:right;">
18497
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-0.247
</td>
<td style="text-align:right;">
0.240
</td>
<td style="text-align:right;">
-0.494
</td>
<td style="text-align:right;">
3.093
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - standard
</td>
<td style="text-align:right;">
13148
</td>
<td style="text-align:right;">
-10.558
</td>
<td style="text-align:right;">
9.064
</td>
<td style="text-align:right;">
-69.143
</td>
<td style="text-align:right;">
50.221
</td>
<td style="text-align:right;">
-0.791
</td>
<td style="text-align:right;">
2.441
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch oddball
</td>
<td style="text-align:right;">
10738
</td>
<td style="text-align:right;">
-11.281
</td>
<td style="text-align:right;">
9.237
</td>
<td style="text-align:right;">
-94.139
</td>
<td style="text-align:right;">
24.670
</td>
<td style="text-align:right;">
-1.048
</td>
<td style="text-align:right;">
3.412
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - length oddball
</td>
<td style="text-align:right;">
10730
</td>
<td style="text-align:right;">
-11.701
</td>
<td style="text-align:right;">
9.355
</td>
<td style="text-align:right;">
-88.872
</td>
<td style="text-align:right;">
32.803
</td>
<td style="text-align:right;">
-0.865
</td>
<td style="text-align:right;">
2.678
</td>
</tr>
<tr>
<td style="text-align:left;">
MMN - pitch+length oddball
</td>
<td style="text-align:right;">
11004
</td>
<td style="text-align:right;">
-11.443
</td>
<td style="text-align:right;">
9.192
</td>
<td style="text-align:right;">
-87.129
</td>
<td style="text-align:right;">
68.538
</td>
<td style="text-align:right;">
-0.746
</td>
<td style="text-align:right;">
3.373
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(descriptive_table_format,file=paste0(project_path,&#39;/output/supplements/descriptivestatistics_DV_pertrial.html&#39;))</code></pre>
</div>
<div id="histograms-of-dependent-variables---per-trial"
class="section level3">
<h3>histograms of dependent variables - per trial</h3>
<pre class="r"><code>grid.arrange(
  ggplot(df_trial,aes(x=pd))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;BPS (mm)&#39;),
  ggplot()+theme_void(),
  ggplot(df_trial[df_trial$EventData==&#39;201&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - standard (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;202&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;203&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - length oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;204&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch+length oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;201&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - standard (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;202&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch oddball (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;203&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - length oddball (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;204&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch+length oddball (uV)&#39;),
  ncol=2)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/historgram%20of%20dependent%20variables%20-%20per%20trial-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#save to file
tiff(file=paste0(project_path,&quot;/output/supplements/histograms_dependentvariables_pertrial.tiff&quot;), # create a file in tiff format in current working directory
  width=8, height=12, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(
  ggplot(df_trial,aes(x=pd))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;BPS (mm)&#39;),
  ggplot()+theme_void(),
  ggplot(df_trial[df_trial$EventData==&#39;201&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - standard (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;202&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;203&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - length oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;204&#39;,],
         aes(x=rpd_auc))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;SEPR - pitch+length oddball (mm)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;201&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - standard (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;202&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch oddball (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;203&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - length oddball (uV)&#39;),
  ggplot(df_trial[df_trial$EventData==&#39;204&#39;,],
         aes(x=mmn))+geom_histogram(bins=30)+labs(x=&#39;&#39;,title=&#39;MMN - pitch+length oddball (uV)&#39;),
  ncol=2)

dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="linearity-of-effect-of-trial-number" class="section level2">
<h2>linearity of effect of trial number</h2>
<pre class="r"><code>###polynomial fit of trial counter
  linear_fit&lt;-lmer(scale(rpd_auc)~scale(EventCounter)+
          (1|subjects)+(1|wave),data=df_trial,REML=F)

  quadratic_fit&lt;-lmer(scale(rpd_auc)~stats::poly(scale(EventCounter),2)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

  cubic_fit&lt;-lmer(scale(rpd_auc)~stats::poly(scale(EventCounter),3)+
               (1|subjects)+(1|wave),data=df_trial,REML=F)
  
  anova(linear_fit,quadratic_fit,cubic_fit)</code></pre>
<pre><code>Data: df_trial
Models:
linear_fit: scale(rpd_auc) ~ scale(EventCounter) + (1 | subjects) + (1 | wave)
quadratic_fit: scale(rpd_auc) ~ stats::poly(scale(EventCounter), 2) + (1 | subjects) + (1 | wave)
cubic_fit: scale(rpd_auc) ~ stats::poly(scale(EventCounter), 3) + (1 | subjects) + (1 | wave)
              npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
linear_fit       5 847877 847930 -423934   847867                          
quadratic_fit    6 847876 847940 -423932   847864  3.2281  1    0.07238 .  
cubic_fit        7 847857 847932 -423922   847843 20.5582  1  5.785e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  table_model_compare&lt;-anova(linear_fit,quadratic_fit,cubic_fit)
  
  table_model_compare&lt;-cbind(c(&#39;linear fit&#39;,&#39;quadratic fit&#39;,&#39;cubic fit&#39;),table_model_compare)
  
  table_formatted&lt;-table_model_compare %&gt;%
  kbl(caption = &quot;Model comparison on the linearity of trial number on stimulus-evoked pupillary response (SEPR)&quot;,
      col.names = c(&#39;&#39;,&#39;number of parameters&#39;,&#39;AIC&#39;,&#39;BIC&#39;,&#39;log likelihood&#39;,&#39;deviance&#39;,&#39;Chi-squared&#39;,&#39;df&#39;,&#39;p-value&#39;),
      row.names = F) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

table_formatted</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model comparison on the linearity of trial number on stimulus-evoked
pupillary response (SEPR)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
number of parameters
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
log likelihood
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
Chi-squared
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
linear fit
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
847877.2
</td>
<td style="text-align:right;">
847930.3
</td>
<td style="text-align:right;">
-423933.6
</td>
<td style="text-align:right;">
847867.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
quadratic fit
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
847876.0
</td>
<td style="text-align:right;">
847939.6
</td>
<td style="text-align:right;">
-423932.0
</td>
<td style="text-align:right;">
847864.0
</td>
<td style="text-align:right;">
3.228135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0723831
</td>
</tr>
<tr>
<td style="text-align:left;">
cubic fit
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
847857.4
</td>
<td style="text-align:right;">
847931.7
</td>
<td style="text-align:right;">
-423921.7
</td>
<td style="text-align:right;">
847843.4
</td>
<td style="text-align:right;">
20.558183
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000058
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(table_formatted, file=paste0(project_path,&#39;/output/supplements/table_modelcomparison_linearity_SEPR.html&#39;))</code></pre>
<pre class="r"><code>###polynomial fit of trial counter
  linear_fit&lt;-lmer(scale(pd_baseline)~scale(EventCounter)+
          (1|subjects)+(1|wave),data=df_trial,REML=F)

  quadratic_fit&lt;-lmer(scale(pd_baseline)~stats::poly(scale(EventCounter),2)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

  cubic_fit&lt;-lmer(scale(pd_baseline)~stats::poly(scale(EventCounter),3)+
               (1|subjects)+(1|wave),data=df_trial,REML=F)
  
  anova(linear_fit,quadratic_fit,cubic_fit)</code></pre>
<pre><code>Data: df_trial
Models:
linear_fit: scale(pd_baseline) ~ scale(EventCounter) + (1 | subjects) + (1 | wave)
quadratic_fit: scale(pd_baseline) ~ stats::poly(scale(EventCounter), 2) + (1 | subjects) + (1 | wave)
cubic_fit: scale(pd_baseline) ~ stats::poly(scale(EventCounter), 3) + (1 | subjects) + (1 | wave)
              npar    AIC    BIC  logLik deviance    Chisq Df Pr(&gt;Chisq)    
linear_fit       5 447549 447602 -223770   447539                           
quadratic_fit    6 444544 444608 -222266   444532 3007.006  1  &lt; 2.2e-16 ***
cubic_fit        7 444502 444577 -222244   444488   43.807  1  3.624e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  table_model_compare&lt;-anova(linear_fit,quadratic_fit,cubic_fit)
  
  table_model_compare&lt;-cbind(c(&#39;linear fit&#39;,&#39;quadratic fit&#39;,&#39;cubic fit&#39;),table_model_compare)
  
  table_formatted&lt;-table_model_compare %&gt;%
  kbl(caption = &quot;Model comparison on the linearity of trial number on baseline pupil size (BPS)&quot;,
      col.names = c(&#39;&#39;,&#39;number of parameters&#39;,&#39;AIC&#39;,&#39;BIC&#39;,&#39;log likelihood&#39;,&#39;deviance&#39;,&#39;Chi-squared&#39;,&#39;df&#39;,&#39;p-value&#39;),
      row.names = F) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

table_formatted</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model comparison on the linearity of trial number on baseline pupil size
(BPS)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
number of parameters
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
log likelihood
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
Chi-squared
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
linear fit
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
447549.2
</td>
<td style="text-align:right;">
447602.2
</td>
<td style="text-align:right;">
-223769.6
</td>
<td style="text-align:right;">
447539.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
quadratic fit
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
444544.2
</td>
<td style="text-align:right;">
444607.8
</td>
<td style="text-align:right;">
-222266.1
</td>
<td style="text-align:right;">
444532.2
</td>
<td style="text-align:right;">
3007.00562
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cubic fit
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
444502.4
</td>
<td style="text-align:right;">
444576.6
</td>
<td style="text-align:right;">
-222244.2
</td>
<td style="text-align:right;">
444488.4
</td>
<td style="text-align:right;">
43.80701
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(table_formatted, file=paste0(project_path,&#39;/output/supplements/table_modelcomparison_linearity_BPS.html&#39;))</code></pre>
<pre class="r"><code>###polynomial fit of trial counter
  linear_fit&lt;-lmer(scale(mmn)~scale(EventCounter)+
          (1|subjects)+(1|wave),data=df_trial,REML=F)

  quadratic_fit&lt;-lmer(scale(mmn)~stats::poly(scale(EventCounter),2)+
              (1|subjects)+(1|wave),data=df_trial,REML=F)

  cubic_fit&lt;-lmer(scale(mmn)~stats::poly(scale(EventCounter),3)+
               (1|subjects)+(1|wave),data=df_trial,REML=F)
  
  anova(linear_fit,quadratic_fit,cubic_fit)</code></pre>
<pre><code>Data: df_trial
Models:
linear_fit: scale(mmn) ~ scale(EventCounter) + (1 | subjects) + (1 | wave)
quadratic_fit: scale(mmn) ~ stats::poly(scale(EventCounter), 2) + (1 | subjects) + (1 | wave)
cubic_fit: scale(mmn) ~ stats::poly(scale(EventCounter), 3) + (1 | subjects) + (1 | wave)
              npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)   
linear_fit       5 124241 124285 -62116   124231                        
quadratic_fit    6 124237 124289 -62112   124225 6.5932  1   0.010237 * 
cubic_fit        7 124231 124292 -62108   124217 8.0393  1   0.004577 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  table_model_compare&lt;-anova(linear_fit,quadratic_fit,cubic_fit)
  
  table_model_compare&lt;-cbind(c(&#39;linear fit&#39;,&#39;quadratic fit&#39;,&#39;cubic fit&#39;),table_model_compare)
  
  table_formatted&lt;-table_model_compare %&gt;%
  kbl(caption = &quot;Model comparison on the linearity of trial number on mismatch negativity (MMN)&quot;,
      col.names = c(&#39;&#39;,&#39;number of parameters&#39;,&#39;AIC&#39;,&#39;BIC&#39;,&#39;log likelihood&#39;,&#39;deviance&#39;,&#39;Chi-squared&#39;,&#39;df&#39;,&#39;p-value&#39;),
      row.names = F) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

table_formatted</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model comparison on the linearity of trial number on mismatch negativity
(MMN)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
number of parameters
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
log likelihood
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
Chi-squared
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
linear fit
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
124241.2
</td>
<td style="text-align:right;">
124284.8
</td>
<td style="text-align:right;">
-62115.59
</td>
<td style="text-align:right;">
124231.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
quadratic fit
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
124236.6
</td>
<td style="text-align:right;">
124289.0
</td>
<td style="text-align:right;">
-62112.30
</td>
<td style="text-align:right;">
124224.6
</td>
<td style="text-align:right;">
6.593229
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0102367
</td>
</tr>
<tr>
<td style="text-align:left;">
cubic fit
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
124230.6
</td>
<td style="text-align:right;">
124291.7
</td>
<td style="text-align:right;">
-62108.28
</td>
<td style="text-align:right;">
124216.6
</td>
<td style="text-align:right;">
8.039332
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0045772
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(table_formatted, file=paste0(project_path,&#39;/output/supplements/table_modelcomparison_linearity_MMN.html&#39;))</code></pre>
<pre class="r"><code>###polynomial fit of trial counter
  linear_fit&lt;-lmer(scale(pd_baseline)~scale(sequence_position)+
          (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,],REML=F)

  quadratic_fit&lt;-lmer(scale(pd_baseline)~stats::poly(scale(sequence_position),2)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,],REML=F)

  cubic_fit&lt;-lmer(scale(pd_baseline)~stats::poly(scale(sequence_position),3)+
               (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;10,],REML=F)
  
  anova(linear_fit,quadratic_fit,cubic_fit)</code></pre>
<pre><code>Data: df_trial[df_trial$sequence_position &lt; 10, ]
Models:
linear_fit: scale(pd_baseline) ~ scale(sequence_position) + (1 | subjects) + (1 | wave)
quadratic_fit: scale(pd_baseline) ~ stats::poly(scale(sequence_position), 2) + (1 | subjects) + (1 | wave)
cubic_fit: scale(pd_baseline) ~ stats::poly(scale(sequence_position), 3) + (1 | subjects) + (1 | wave)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
linear_fit       5 373463 373515 -186726   373453                         
quadratic_fit    6 373447 373509 -186717   373435 18.441  1  1.752e-05 ***
cubic_fit        7 373448 373521 -186717   373434  0.639  1     0.4241    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  table_model_compare&lt;-anova(linear_fit,quadratic_fit,cubic_fit)
  
  table_model_compare&lt;-cbind(c(&#39;linear fit&#39;,&#39;quadratic fit&#39;,&#39;cubic fit&#39;),table_model_compare)
  
  table_formatted&lt;-table_model_compare %&gt;%
  kbl(caption = &quot;Model comparison on the linearity of trial number on mismatch negativity (MMN)&quot;,
      col.names = c(&#39;&#39;,&#39;number of parameters&#39;,&#39;AIC&#39;,&#39;BIC&#39;,&#39;log likelihood&#39;,&#39;deviance&#39;,&#39;Chi-squared&#39;,&#39;df&#39;,&#39;p-value&#39;),
      row.names = F) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)

table_formatted</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model comparison on the linearity of trial number on mismatch negativity
(MMN)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
number of parameters
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
log likelihood
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
Chi-squared
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
linear fit
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
373463.0
</td>
<td style="text-align:right;">
373515.1
</td>
<td style="text-align:right;">
-186726.5
</td>
<td style="text-align:right;">
373453.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
quadratic fit
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
373446.6
</td>
<td style="text-align:right;">
373509.1
</td>
<td style="text-align:right;">
-186717.3
</td>
<td style="text-align:right;">
373434.6
</td>
<td style="text-align:right;">
18.4410647
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000175
</td>
</tr>
<tr>
<td style="text-align:left;">
cubic fit
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
373447.9
</td>
<td style="text-align:right;">
373520.8
</td>
<td style="text-align:right;">
-186717.0
</td>
<td style="text-align:right;">
373433.9
</td>
<td style="text-align:right;">
0.6389725
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4240831
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>save_kable(table_formatted, file=paste0(project_path,&#39;/output/supplements/table_modelcomparison_linearity_sequenceposition.html&#39;))</code></pre>
</div>
<div id="intraclass-correaltion-of-the-dependent-variables"
class="section level2">
<h2>intraclass correaltion of the dependent variables</h2>
<pre class="r"><code>#select only individuals that have both waves
subjects_with_both_waves&lt;-df_dem$subjects[df_dem$timepoints==&#39;wave1+2&#39;]
df_trial_wave12&lt;-df_trial[df_trial$subjects %in% subjects_with_both_waves,]

#BPS
baseline_pd_wave1&lt;-with(df_trial_wave12[df_trial_wave12$wave==&#39;wave1&#39;,],aggregate(pd_baseline,by=list(subjects),FUN=mean,na.rm=T))
baseline_pd_wave2&lt;-with(df_trial_wave12[df_trial_wave12$wave==&#39;wave2&#39;,],aggregate(pd_baseline,by=list(subjects),FUN=mean,na.rm=T))
names(baseline_pd_wave1)&lt;-c(&#39;subjects&#39;,&#39;wave1&#39;)
names(baseline_pd_wave2)&lt;-c(&#39;subjects&#39;,&#39;wave2&#39;)

baseline_pd_waves&lt;-merge(baseline_pd_wave1,baseline_pd_wave2,by=&#39;subjects&#39;)

cor.test(baseline_pd_waves$wave1,baseline_pd_waves$wave2)</code></pre>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  baseline_pd_waves$wave1 and baseline_pd_waves$wave2
t = 11.401, df = 74, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6985363 0.8675847
sample estimates:
      cor 
0.7982727 </code></pre>
<pre class="r"><code>psych::ICC(baseline_pd_waves[,-1])</code></pre>
<pre><code>Call: psych::ICC(x = baseline_pd_waves[, -1])

Intraclass correlation coefficients 
                         type  ICC   F df1 df2       p lower bound upper bound
Single_raters_absolute   ICC1 0.79 8.5  75  76 4.6e-18        0.69        0.86
Single_random_raters     ICC2 0.79 8.5  75  75 6.8e-18        0.69        0.86
Single_fixed_raters      ICC3 0.79 8.5  75  75 6.8e-18        0.69        0.86
Average_raters_absolute ICC1k 0.88 8.5  75  76 4.6e-18        0.82        0.93
Average_random_raters   ICC2k 0.88 8.5  75  75 6.8e-18        0.82        0.93
Average_fixed_raters    ICC3k 0.88 8.5  75  75 6.8e-18        0.81        0.93

 Number of subjects = 76     Number of Judges =  2
See the help file for a discussion of the other 4 McGraw and Wong estimates,</code></pre>
<pre class="r"><code>###--&gt; ICC: 0.88 [0.81, 0.93]


#SEPR
rpd204_wave1&lt;-with(df_trial_wave12[df_trial_wave12$EventData==&#39;204&#39; &amp; df_trial_wave12$wave==&#39;wave1&#39;,],aggregate(rpd_auc.204,by=list(subjects),FUN=mean,na.rm=T))
rpd204_wave2&lt;-with(df_trial_wave12[df_trial_wave12$EventData==&#39;204&#39; &amp; df_trial_wave12$wave==&#39;wave2&#39;,],aggregate(rpd_auc.204,by=list(subjects),FUN=mean,na.rm=T))

names(rpd204_wave1)&lt;-c(&#39;subjects&#39;,&#39;wave1&#39;)
names(rpd204_wave2)&lt;-c(&#39;subjects&#39;,&#39;wave2&#39;)

rpd_waves&lt;-merge(rpd204_wave1,rpd204_wave2,by=&#39;subjects&#39;)

cor.test(rpd_waves$wave1,rpd_waves$wave2)</code></pre>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  rpd_waves$wave1 and rpd_waves$wave2
t = 2.0793, df = 71, p-value = 0.0412
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.01006868 0.44511370
sample estimates:
     cor 
0.239581 </code></pre>
<pre class="r"><code>##--&gt; r =.23

psych::ICC(rpd_waves[,-1])</code></pre>
<pre><code>Call: psych::ICC(x = rpd_waves[, -1])

Intraclass correlation coefficients 
                         type  ICC   F df1 df2     p lower bound upper bound
Single_raters_absolute   ICC1 0.20 1.5  72  73 0.041     -0.0257        0.41
Single_random_raters     ICC2 0.22 1.6  72  72 0.028     -0.0042        0.42
Single_fixed_raters      ICC3 0.22 1.6  72  72 0.028     -0.0051        0.43
Average_raters_absolute ICC1k 0.34 1.5  72  73 0.041     -0.0528        0.58
Average_random_raters   ICC2k 0.36 1.6  72  72 0.028     -0.0084        0.59
Average_fixed_raters    ICC3k 0.37 1.6  72  72 0.028     -0.0103        0.60

 Number of subjects = 73     Number of Judges =  2
See the help file for a discussion of the other 4 McGraw and Wong estimates,</code></pre>
<pre class="r"><code>###--&gt; ICC: 0.37 [-0.01, 0.60]


names(df_timepoint)</code></pre>
<pre><code>  [1] &quot;id&quot;                             &quot;subjects&quot;                      
  [3] &quot;wave&quot;                           &quot;site&quot;                          
  [5] &quot;schedule_enrol&quot;                 &quot;sex&quot;                           
  [7] &quot;age&quot;                            &quot;ageyrs&quot;                        
  [9] &quot;iqtype&quot;                         &quot;iqwechrawscores_bd_raw&quot;        
 [11] &quot;iqwechrawscores_bd_t&quot;           &quot;iqwechrawscores_vo_raw&quot;        
 [13] &quot;iqwechrawscores_vo_t&quot;           &quot;iqwechrawscores_mr_raw&quot;        
 [15] &quot;iqwechrawscores_mr_t&quot;           &quot;iqwechrawscores_vp_raw&quot;        
 [17] &quot;iqwechrawscores_vp_t&quot;           &quot;iqwechrawscores_pc_raw&quot;        
 [19] &quot;iqwechrawscores_pc_t&quot;           &quot;iqwechrawscores_si_raw&quot;        
 [21] &quot;iqwechrawscores_si_t&quot;           &quot;med_use&quot;                       
 [23] &quot;drugclass_1&quot;                    &quot;drugclass_2&quot;                   
 [25] &quot;drugclass_3&quot;                    &quot;css_total&quot;                     
 [27] &quot;sa_css&quot;                         &quot;rrb_css&quot;                       
 [29] &quot;srs_tscore&quot;                     &quot;srs_tscore_self&quot;               
 [31] &quot;srs_rawscore&quot;                   &quot;srs_rawscore_self&quot;             
 [33] &quot;srs_tscore_combined&quot;            &quot;srs_rawscore_combined&quot;         
 [35] &quot;rbs_total&quot;                      &quot;ssp_tactile&quot;                   
 [37] &quot;ssp_taste&quot;                      &quot;ssp_move&quot;                      
 [39] &quot;ssp_underresp&quot;                  &quot;ssp_audfilt&quot;                   
 [41] &quot;ssp_lowenergy&quot;                  &quot;ssp_visualaudisens&quot;            
 [43] &quot;ssp_total&quot;                      &quot;ssp_prorated&quot;                  
 [45] &quot;ssp_hype&quot;                       &quot;ssp_underrespo_mod&quot;            
 [47] &quot;adhd_inattentiv_parent&quot;         &quot;adhd_hyperimpul_parent&quot;        
 [49] &quot;sdq_total_difficulties_p&quot;       &quot;sdq_emotional_p&quot;               
 [51] &quot;sdq_conduct_p&quot;                  &quot;sdq_hyperactivity_p&quot;           
 [53] &quot;sdq_peer_p&quot;                     &quot;sdq_prosocial_p&quot;               
 [55] &quot;sdq_impact_p&quot;                   &quot;sdq_internalising_p&quot;           
 [57] &quot;sdq_externalising_p&quot;            &quot;vabsdscoresc_dss&quot;              
 [59] &quot;vabsdscoresd_dss&quot;               &quot;vabsdscoress_dss&quot;              
 [61] &quot;vabsabcabc_standard&quot;            &quot;t1_group&quot;                      
 [63] &quot;t1_diagnosis&quot;                   &quot;t1_asd_thresh&quot;                 
 [65] &quot;t1_schedule_adj&quot;                &quot;t1_nat_speaker&quot;                
 [67] &quot;t1_viq&quot;                         &quot;t1_piq&quot;                        
 [69] &quot;t1_fsiq&quot;                        &quot;t1_ethnicity&quot;                  
 [71] &quot;t1_education_moth&quot;              &quot;t1_education_fath&quot;             
 [73] &quot;t1_handedness&quot;                  &quot;t1_handedness_score&quot;           
 [75] &quot;t1_adi_social_total&quot;            &quot;t1_adi_communication_total&quot;    
 [77] &quot;t1_adi_rrb_total&quot;               &quot;t1_css_total_imputed&quot;          
 [79] &quot;t1_sa_css_imputed&quot;              &quot;t1_rrb_css_imputed&quot;            
 [81] &quot;t1_css_total_all&quot;               &quot;t1_sa_css_all&quot;                 
 [83] &quot;t1_rrb_css_all&quot;                 &quot;t1_csbq_total_score&quot;           
 [85] &quot;t1_asbq_total_adult_parent&quot;     &quot;t1_asbq_total_adult_self&quot;      
 [87] &quot;t1_aq_child_total&quot;              &quot;t1_aq_adol_total&quot;              
 [89] &quot;t1_aq_adult_total&quot;              &quot;t1_adhd_inattentiv_self&quot;       
 [91] &quot;t1_adhd_hyperimpul_self&quot;        &quot;t1_adhd_cat_parent&quot;            
 [93] &quot;t1_adhd_cat_self&quot;               &quot;t1_adhd_cat_combined&quot;          
 [95] &quot;t1_beck_anx_adulta_self&quot;        &quot;t1_beck_anx_youthb_self&quot;       
 [97] &quot;t1_beck_anx_youthb_self_tscore&quot; &quot;t1_beck_anx_youthcd_parent&quot;    
 [99] &quot;t1_beck_anx_youthcd_parent_t&quot;   &quot;t1_beck_anx_adultd_parent&quot;     
[101] &quot;t1_beck_dep_adulta_self&quot;        &quot;t1_beck_dep_youthb&quot;            
[103] &quot;t1_beck_dep_youthb_self_tscore&quot; &quot;t1_beck_dep_youthcd&quot;           
[105] &quot;t1_beck_dep_youthcd_parent_t&quot;   &quot;t1_beck_dep_adultd_parent&quot;     
[107] &quot;t1_dawba_dep&quot;                   &quot;t1_dawba_adhd&quot;                 
[109] &quot;t1_dawba_anx&quot;                   &quot;t1_dawba_behavdis&quot;             
[111] &quot;t1_dawba_int&quot;                   &quot;t1_dawba_ext&quot;                  
[113] &quot;t2_absence&quot;                     &quot;t2_drugclass_4&quot;                
[115] &quot;t2_drugclass_5&quot;                 &quot;t2_cri_mbc&quot;                    
[117] &quot;t2_cri_ris&quot;                     &quot;t2_cri_total&quot;                  
[119] &quot;t2_cri_prorated&quot;                &quot;t2_seq_hyposirs&quot;               
[121] &quot;t2_seq_hyperep&quot;                 &quot;t2_seq_total&quot;                  
[123] &quot;t2_adhd_prorated&quot;               &quot;missing_data_trial&quot;            
[125] &quot;sampling_rate&quot;                  &quot;center_dev&quot;                    
[127] &quot;screen_dist&quot;                    &quot;pd&quot;                            
[129] &quot;pd_baseline&quot;                    &quot;rpd_auc&quot;                       
[131] &quot;rpd_response.201&quot;               &quot;rpd_response.202&quot;              
[133] &quot;rpd_response.203&quot;               &quot;rpd_response.204&quot;              
[135] &quot;rpd_auc.201&quot;                    &quot;rpd_auc.202&quot;                   
[137] &quot;rpd_auc.203&quot;                    &quot;rpd_auc.204&quot;                   
[139] &quot;gain_pcdm&quot;                      &quot;Rsq_pcdm&quot;                      
[141] &quot;offset_pcdm&quot;                    &quot;mmn.201&quot;                       
[143] &quot;mmn.202&quot;                        &quot;mmn.203&quot;                       
[145] &quot;mmn.204&quot;                       </code></pre>
<pre class="r"><code>#NG
gain_wave1&lt;-with(df_timepoint[df_timepoint$wave==&#39;wave1&#39;,],aggregate(gain_pcdm,by=list(subjects),FUN=mean,na.rm=T))
gain_wave2&lt;-with(df_timepoint[df_timepoint$wave==&#39;wave2&#39;,],aggregate(gain_pcdm,by=list(subjects),FUN=mean,na.rm=T))

names(gain_wave1)&lt;-c(&#39;subjects&#39;,&#39;wave1&#39;)
names(gain_wave2)&lt;-c(&#39;subjects&#39;,&#39;wave2&#39;)

gain_waves&lt;-merge(gain_wave1,gain_wave2,by=&#39;subjects&#39;)

cor.test(gain_waves$wave1,gain_waves$wave2)</code></pre>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  gain_waves$wave1 and gain_waves$wave2
t = 1.83, df = 51, p-value = 0.07309
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.0236472  0.4859236
sample estimates:
      cor 
0.2482332 </code></pre>
<pre class="r"><code>##--&gt; r =.23

psych::ICC(gain_waves[,-1])</code></pre>
<pre><code>Call: psych::ICC(x = gain_waves[, -1])

Intraclass correlation coefficients 
                         type  ICC   F df1 df2    p lower bound upper bound
Single_raters_absolute   ICC1 0.23 1.6  80  81 0.02       0.012        0.42
Single_random_raters     ICC2 0.23 1.6  80  80 0.02       0.011        0.42
Single_fixed_raters      ICC3 0.23 1.6  80  80 0.02       0.011        0.42
Average_raters_absolute ICC1k 0.37 1.6  80  81 0.02       0.023        0.59
Average_random_raters   ICC2k 0.37 1.6  80  80 0.02       0.022        0.59
Average_fixed_raters    ICC3k 0.37 1.6  80  80 0.02       0.021        0.60

 Number of subjects = 81     Number of Judges =  2
See the help file for a discussion of the other 4 McGraw and Wong estimates,</code></pre>
<pre class="r"><code>###--&gt; ICC: 0.37 [0.02, 0.59]</code></pre>
<p>For participants with both measurement timepoints, we estimated a
relative stability of BPS (intraclass correlation, ICC = 0.88 [0.81,
0.93]), while SEPR (ICC = 0.37 [-0.01, 0.60]) and NG (ICC = 0.37 [0.02,
0.59]) were variable across timepoints. EEG data was only available at
one timepoint.</p>
</div>
<div id="full-model-tables" class="section level2">
<h2>full model tables</h2>
<pre class="r"><code>#full model  - save to supplements      
lmm_full&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
      scale(ageyrs)+scale(t1_piq)+sex+
      as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)+
      (1|subjects)+(1|wave),data=df_trial)


##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;task progression (TP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;S x group&#39;,&#39;S x TP&#39;,&#39;group x TP&#39;,&#39;S x group x TP&#39;)
  
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                                row_names
EventData                                                    stimulus (S)
t1_diagnosis                                                        group
stats::poly(EventCounter, 3)                        task progression (TP)
scale(ageyrs)                                                         age
scale(t1_piq)                                               perceptual IQ
sex                                                                   sex
as.factor(sampling_rate)                                    sampling rate
scale(center_dev)                                   gaze center deviation
scale(missing_data_trial)                                    data quality
EventData:t1_diagnosis                                          S x group
EventData:stats::poly(EventCounter, 3)                             S x TP
t1_diagnosis:stats::poly(EventCounter, 3)                      group x TP
EventData:t1_diagnosis:stats::poly(EventCounter, 3)        S x group x TP
                                                     Sum Sq Mean Sq NumDF
EventData                                             7.716   2.572     3
t1_diagnosis                                          0.026   0.026     1
stats::poly(EventCounter, 3)                        217.440  72.480     3
scale(ageyrs)                                        65.497  65.497     1
scale(t1_piq)                                         0.514   0.514     1
sex                                                   0.372   0.372     1
as.factor(sampling_rate)                            384.515 384.515     1
scale(center_dev)                                    30.051  30.051     1
scale(missing_data_trial)                           122.061 122.061     1
EventData:t1_diagnosis                                1.861   0.620     3
EventData:stats::poly(EventCounter, 3)               23.246   2.583     9
t1_diagnosis:stats::poly(EventCounter, 3)             9.441   3.147     3
EventData:t1_diagnosis:stats::poly(EventCounter, 3)   1.110   0.123     9
                                                         DenDF  F value Pr(&gt;F)
EventData                                           298664.131   10.077  0.000
t1_diagnosis                                           206.697    0.102  0.750
stats::poly(EventCounter, 3)                        298670.314  283.965  0.000
scale(ageyrs)                                          225.068  256.607  0.000
scale(t1_piq)                                          206.874    2.015  0.157
sex                                                    205.630    1.456  0.229
as.factor(sampling_rate)                            212854.336 1506.465  0.000
scale(center_dev)                                   243201.221  117.733  0.000
scale(missing_data_trial)                           298692.298  478.215  0.000
EventData:t1_diagnosis                              298664.118    2.430  0.063
EventData:stats::poly(EventCounter, 3)              298664.319   10.119  0.000
t1_diagnosis:stats::poly(EventCounter, 3)           298673.812   12.329  0.000
EventData:t1_diagnosis:stats::poly(EventCounter, 3) 298664.299    0.483  0.887</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: baseline pupil size (BPS) - task progression&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: baseline pupil size (BPS) - task progression
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
7.716
</td>
<td style="text-align:right;">
2.572
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298664.131
</td>
<td style="text-align:right;">
10.077
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
206.697
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.750
</td>
</tr>
<tr>
<td style="text-align:left;">
task progression (TP)
</td>
<td style="text-align:right;">
217.440
</td>
<td style="text-align:right;">
72.480
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298670.314
</td>
<td style="text-align:right;">
283.965
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
65.497
</td>
<td style="text-align:right;">
65.497
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
225.068
</td>
<td style="text-align:right;">
256.607
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
0.514
</td>
<td style="text-align:right;">
0.514
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
206.874
</td>
<td style="text-align:right;">
2.015
</td>
<td style="text-align:right;">
0.157
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0.372
</td>
<td style="text-align:right;">
0.372
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
205.630
</td>
<td style="text-align:right;">
1.456
</td>
<td style="text-align:right;">
0.229
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
384.515
</td>
<td style="text-align:right;">
384.515
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
212854.336
</td>
<td style="text-align:right;">
1506.465
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
30.051
</td>
<td style="text-align:right;">
30.051
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
243201.221
</td>
<td style="text-align:right;">
117.733
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
122.061
</td>
<td style="text-align:right;">
122.061
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
298692.298
</td>
<td style="text-align:right;">
478.215
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
1.861
</td>
<td style="text-align:right;">
0.620
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298664.118
</td>
<td style="text-align:right;">
2.430
</td>
<td style="text-align:right;">
0.063
</td>
</tr>
<tr>
<td style="text-align:left;">
S x TP
</td>
<td style="text-align:right;">
23.246
</td>
<td style="text-align:right;">
2.583
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
298664.319
</td>
<td style="text-align:right;">
10.119
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group x TP
</td>
<td style="text-align:right;">
9.441
</td>
<td style="text-align:right;">
3.147
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298673.812
</td>
<td style="text-align:right;">
12.329
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x TP
</td>
<td style="text-align:right;">
1.110
</td>
<td style="text-align:right;">
0.123
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
298664.299
</td>
<td style="text-align:right;">
0.483
</td>
<td style="text-align:right;">
0.887
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_BPS.html&#39;))</code></pre>
<pre class="r"><code>#recoding
df_trial$sequence_position_z&lt;-scale(df_trial$sequence_position)


  ### supplementary analysis
lmm_full&lt;-lmer(scale(pd_baseline)~t1_diagnosis*sequence_position_z+
            scale(ageyrs)+scale(t1_piq)+sex+
            as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)+
            (1|subjects)+(1|wave),data=df_trial[df_trial$EventData==201 &amp; df_trial$sequence_position&lt;10,])

anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                  Sum Sq Mean Sq NumDF  DenDF   F value  Pr(&gt;F)
t1_diagnosis                       0.039   0.039     1    203    0.1493 0.69961
sequence_position_z                0.120   0.120     1 204684    0.4556 0.49970
scale(ageyrs)                     55.512  55.512     1     66  211.5120 &lt; 2e-16
scale(t1_piq)                      0.518   0.518     1    203    1.9719 0.16178
sex                                0.366   0.366     1    203    1.3937 0.23917
as.factor(sampling_rate)         280.262 280.262     1  87201 1067.8530 &lt; 2e-16
scale(center_dev)                 25.843  25.843     1 140835   98.4659 &lt; 2e-16
scale(missing_data_trial)         91.844  91.844     1 204712  349.9440 &lt; 2e-16
t1_diagnosis:sequence_position_z   1.048   1.048     1 204685    3.9922 0.04571
                                    
t1_diagnosis                        
sequence_position_z                 
scale(ageyrs)                    ***
scale(t1_piq)                       
sex                                 
as.factor(sampling_rate)         ***
scale(center_dev)                ***
scale(missing_data_trial)        ***
t1_diagnosis:sequence_position_z *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>##supplements - full table
  row_names&lt;-c(&#39;group&#39;,&#39;sequence position - continuous (SP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;group x SP&#39;)
  
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                           row_names  Sum Sq
t1_diagnosis                                                   group   0.039
sequence_position_z              sequence position - continuous (SP)   0.120
scale(ageyrs)                                                    age  55.512
scale(t1_piq)                                          perceptual IQ   0.518
sex                                                              sex   0.366
as.factor(sampling_rate)                               sampling rate 280.262
scale(center_dev)                              gaze center deviation  25.843
scale(missing_data_trial)                               data quality  91.844
t1_diagnosis:sequence_position_z                          group x SP   1.048
                                 Mean Sq NumDF      DenDF  F value Pr(&gt;F)
t1_diagnosis                       0.039     1    203.357    0.149  0.700
sequence_position_z                0.120     1 204683.934    0.456  0.500
scale(ageyrs)                     55.512     1     66.261  211.512  0.000
scale(t1_piq)                      0.518     1    203.466    1.972  0.162
sex                                0.366     1    202.854    1.394  0.239
as.factor(sampling_rate)         280.262     1  87200.771 1067.853  0.000
scale(center_dev)                 25.843     1 140835.465   98.466  0.000
scale(missing_data_trial)         91.844     1 204711.585  349.944  0.000
t1_diagnosis:sequence_position_z   1.048     1 204684.867    3.992  0.046</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: baseline pupil size (BPS) - habituation&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: baseline pupil size (BPS) - habituation
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
203.357
</td>
<td style="text-align:right;">
0.149
</td>
<td style="text-align:right;">
0.700
</td>
</tr>
<tr>
<td style="text-align:left;">
sequence position - continuous (SP)
</td>
<td style="text-align:right;">
0.120
</td>
<td style="text-align:right;">
0.120
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
204683.934
</td>
<td style="text-align:right;">
0.456
</td>
<td style="text-align:right;">
0.500
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
55.512
</td>
<td style="text-align:right;">
55.512
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
66.261
</td>
<td style="text-align:right;">
211.512
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
0.518
</td>
<td style="text-align:right;">
0.518
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
203.466
</td>
<td style="text-align:right;">
1.972
</td>
<td style="text-align:right;">
0.162
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0.366
</td>
<td style="text-align:right;">
0.366
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202.854
</td>
<td style="text-align:right;">
1.394
</td>
<td style="text-align:right;">
0.239
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
280.262
</td>
<td style="text-align:right;">
280.262
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
87200.771
</td>
<td style="text-align:right;">
1067.853
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
25.843
</td>
<td style="text-align:right;">
25.843
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
140835.465
</td>
<td style="text-align:right;">
98.466
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
91.844
</td>
<td style="text-align:right;">
91.844
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
204711.585
</td>
<td style="text-align:right;">
349.944
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group x SP
</td>
<td style="text-align:right;">
1.048
</td>
<td style="text-align:right;">
1.048
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
204684.867
</td>
<td style="text-align:right;">
3.992
</td>
<td style="text-align:right;">
0.046
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_BPS_habituation.html&#39;))</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|subjects)+(1|wave),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model


##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;task progression (TP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;S x group&#39;,&#39;S x TP&#39;,&#39;group x TP&#39;,&#39;S x group x TP&#39;)
   
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                row_names  Sum Sq Mean Sq NumDF
EventData                                    stimulus (S)  21.908   7.303     3
t1_diagnosis                                        group   0.045   0.045     1
EventCounter                        task progression (TP)   0.028   0.028     1
scale(ageyrs)                                         age   0.147   0.147     1
scale(t1_piq)                               perceptual IQ   1.088   1.088     1
sex                                                   sex   0.313   0.313     1
scale(center_dev)                           sampling rate   0.283   0.283     1
as.factor(sampling_rate)            gaze center deviation   2.002   2.002     1
scale(missing_data_trial)                    data quality 252.632 252.632     1
EventData:t1_diagnosis                          S x group   7.956   2.652     3
EventData:EventCounter                             S x TP   2.233   0.744     3
t1_diagnosis:EventCounter                      group x TP   0.282   0.282     1
EventData:t1_diagnosis:EventCounter        S x group x TP  10.146   3.382     3
                                         DenDF F value Pr(&gt;F)
EventData                           298694.067   7.332  0.000
t1_diagnosis                          1867.099   0.045  0.831
EventCounter                        297216.936   0.028  0.867
scale(ageyrs)                          192.082   0.147  0.702
scale(t1_piq)                          183.975   1.093  0.297
sex                                    182.635   0.314  0.576
scale(center_dev)                     3426.834   0.284  0.594
as.factor(sampling_rate)               720.042   2.010  0.157
scale(missing_data_trial)           225912.957 253.639  0.000
EventData:t1_diagnosis              298693.869   2.662  0.046
EventData:EventCounter              298695.326   0.747  0.524
t1_diagnosis:EventCounter           298634.746   0.283  0.594
EventData:t1_diagnosis:EventCounter 298694.753   3.395  0.017</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: stimulus-evoked pupillary response (SEPR) - task progression&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: stimulus-evoked pupillary response (SEPR) - task
progression
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
21.908
</td>
<td style="text-align:right;">
7.303
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298694.067
</td>
<td style="text-align:right;">
7.332
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1867.099
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
0.831
</td>
</tr>
<tr>
<td style="text-align:left;">
task progression (TP)
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
297216.936
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.867
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.147
</td>
<td style="text-align:right;">
0.147
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
192.082
</td>
<td style="text-align:right;">
0.147
</td>
<td style="text-align:right;">
0.702
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
1.088
</td>
<td style="text-align:right;">
1.088
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
183.975
</td>
<td style="text-align:right;">
1.093
</td>
<td style="text-align:right;">
0.297
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0.313
</td>
<td style="text-align:right;">
0.313
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
182.635
</td>
<td style="text-align:right;">
0.314
</td>
<td style="text-align:right;">
0.576
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3426.834
</td>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.594
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
2.002
</td>
<td style="text-align:right;">
2.002
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
720.042
</td>
<td style="text-align:right;">
2.010
</td>
<td style="text-align:right;">
0.157
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
252.632
</td>
<td style="text-align:right;">
252.632
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
225912.957
</td>
<td style="text-align:right;">
253.639
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
7.956
</td>
<td style="text-align:right;">
2.652
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298693.869
</td>
<td style="text-align:right;">
2.662
</td>
<td style="text-align:right;">
0.046
</td>
</tr>
<tr>
<td style="text-align:left;">
S x TP
</td>
<td style="text-align:right;">
2.233
</td>
<td style="text-align:right;">
0.744
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298695.326
</td>
<td style="text-align:right;">
0.747
</td>
<td style="text-align:right;">
0.524
</td>
</tr>
<tr>
<td style="text-align:left;">
group x TP
</td>
<td style="text-align:right;">
0.282
</td>
<td style="text-align:right;">
0.282
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
298634.746
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.594
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x TP
</td>
<td style="text-align:right;">
10.146
</td>
<td style="text-align:right;">
3.382
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298694.753
</td>
<td style="text-align:right;">
3.395
</td>
<td style="text-align:right;">
0.017
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_SEPR.html&#39;))</code></pre>
<pre class="r"><code>#SEPR - categorical habituation
  lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*as.factor(sequence_position)+
            scale(ageyrs)+scale(t1_piq)+sex+
             scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|subjects)+(1|wave),data=df_trial[df_trial$sequence_position&lt;4,])

   anova(lmm_full)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                                     Sum Sq Mean Sq NumDF
EventData                                            12.158   4.053     3
t1_diagnosis                                          0.025   0.025     1
as.factor(sequence_position)                          1.067   0.534     2
scale(ageyrs)                                         0.025   0.025     1
scale(t1_piq)                                         1.701   1.701     1
sex                                                   1.018   1.018     1
scale(center_dev)                                     2.469   2.469     1
as.factor(sampling_rate)                              1.009   1.009     1
scale(missing_data_trial)                           127.094 127.094     1
EventData:t1_diagnosis                                0.280   0.093     3
EventData:as.factor(sequence_position)               15.177   2.529     6
t1_diagnosis:as.factor(sequence_position)             6.895   3.447     2
EventData:t1_diagnosis:as.factor(sequence_position)   8.784   1.757     5
                                                     DenDF  F value    Pr(&gt;F)
EventData                                           133932   4.0665  0.006732
t1_diagnosis                                          1381   0.0248  0.874993
as.factor(sequence_position)                        133961   0.5353  0.585490
scale(ageyrs)                                          182   0.0247  0.875187
scale(t1_piq)                                          168   1.7068  0.193183
sex                                                    166   1.0214  0.313658
scale(center_dev)                                     1332   2.4770  0.115760
as.factor(sampling_rate)                               448   1.0123  0.314889
scale(missing_data_trial)                            89910 127.5241 &lt; 2.2e-16
EventData:t1_diagnosis                              133892   0.0936  0.963595
EventData:as.factor(sequence_position)              133911   2.5380  0.018560
t1_diagnosis:as.factor(sequence_position)           133891   3.4589  0.031466
EventData:t1_diagnosis:as.factor(sequence_position) 133887   1.7628  0.116719
                                                       
EventData                                           ** 
t1_diagnosis                                           
as.factor(sequence_position)                           
scale(ageyrs)                                          
scale(t1_piq)                                          
sex                                                    
scale(center_dev)                                      
as.factor(sampling_rate)                               
scale(missing_data_trial)                           ***
EventData:t1_diagnosis                                 
EventData:as.factor(sequence_position)              *  
t1_diagnosis:as.factor(sequence_position)           *  
EventData:t1_diagnosis:as.factor(sequence_position)    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;sequence position - categorical (SP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;S x group&#39;,&#39;S x SP&#39;,&#39;group x SP&#39;,&#39;S x group x SP&#39;)
   
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                                               row_names
EventData                                                                   stimulus (S)
t1_diagnosis                                                                       group
as.factor(sequence_position)                        sequence position - categorical (SP)
scale(ageyrs)                                                                        age
scale(t1_piq)                                                              perceptual IQ
sex                                                                                  sex
scale(center_dev)                                                          sampling rate
as.factor(sampling_rate)                                           gaze center deviation
scale(missing_data_trial)                                                   data quality
EventData:t1_diagnosis                                                         S x group
EventData:as.factor(sequence_position)                                            S x SP
t1_diagnosis:as.factor(sequence_position)                                     group x SP
EventData:t1_diagnosis:as.factor(sequence_position)                       S x group x SP
                                                     Sum Sq Mean Sq NumDF
EventData                                            12.158   4.053     3
t1_diagnosis                                          0.025   0.025     1
as.factor(sequence_position)                          1.067   0.534     2
scale(ageyrs)                                         0.025   0.025     1
scale(t1_piq)                                         1.701   1.701     1
sex                                                   1.018   1.018     1
scale(center_dev)                                     2.469   2.469     1
as.factor(sampling_rate)                              1.009   1.009     1
scale(missing_data_trial)                           127.094 127.094     1
EventData:t1_diagnosis                                0.280   0.093     3
EventData:as.factor(sequence_position)               15.177   2.529     6
t1_diagnosis:as.factor(sequence_position)             6.895   3.447     2
EventData:t1_diagnosis:as.factor(sequence_position)   8.784   1.757     5
                                                         DenDF F value Pr(&gt;F)
EventData                                           133932.010   4.066  0.007
t1_diagnosis                                          1380.862   0.025  0.875
as.factor(sequence_position)                        133961.039   0.535  0.585
scale(ageyrs)                                          181.831   0.025  0.875
scale(t1_piq)                                          167.970   1.707  0.193
sex                                                    166.423   1.021  0.314
scale(center_dev)                                     1331.542   2.477  0.116
as.factor(sampling_rate)                               447.577   1.012  0.315
scale(missing_data_trial)                            89909.980 127.524  0.000
EventData:t1_diagnosis                              133892.441   0.094  0.964
EventData:as.factor(sequence_position)              133911.067   2.538  0.019
t1_diagnosis:as.factor(sequence_position)           133891.238   3.459  0.031
EventData:t1_diagnosis:as.factor(sequence_position) 133887.203   1.763  0.117</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: stimulus-evoked pupillary response (SEPR) - habituation&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: stimulus-evoked pupillary response (SEPR) -
habituation
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
12.158
</td>
<td style="text-align:right;">
4.053
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
133932.010
</td>
<td style="text-align:right;">
4.066
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1380.862
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.875
</td>
</tr>
<tr>
<td style="text-align:left;">
sequence position - categorical (SP)
</td>
<td style="text-align:right;">
1.067
</td>
<td style="text-align:right;">
0.534
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
133961.039
</td>
<td style="text-align:right;">
0.535
</td>
<td style="text-align:right;">
0.585
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
181.831
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.875
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
1.701
</td>
<td style="text-align:right;">
1.701
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
167.970
</td>
<td style="text-align:right;">
1.707
</td>
<td style="text-align:right;">
0.193
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1.018
</td>
<td style="text-align:right;">
1.018
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
166.423
</td>
<td style="text-align:right;">
1.021
</td>
<td style="text-align:right;">
0.314
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
2.469
</td>
<td style="text-align:right;">
2.469
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1331.542
</td>
<td style="text-align:right;">
2.477
</td>
<td style="text-align:right;">
0.116
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
1.009
</td>
<td style="text-align:right;">
1.009
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
447.577
</td>
<td style="text-align:right;">
1.012
</td>
<td style="text-align:right;">
0.315
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
127.094
</td>
<td style="text-align:right;">
127.094
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
89909.980
</td>
<td style="text-align:right;">
127.524
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
0.280
</td>
<td style="text-align:right;">
0.093
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
133892.441
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.964
</td>
</tr>
<tr>
<td style="text-align:left;">
S x SP
</td>
<td style="text-align:right;">
15.177
</td>
<td style="text-align:right;">
2.529
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
133911.067
</td>
<td style="text-align:right;">
2.538
</td>
<td style="text-align:right;">
0.019
</td>
</tr>
<tr>
<td style="text-align:left;">
group x SP
</td>
<td style="text-align:right;">
6.895
</td>
<td style="text-align:right;">
3.447
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
133891.238
</td>
<td style="text-align:right;">
3.459
</td>
<td style="text-align:right;">
0.031
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x SP
</td>
<td style="text-align:right;">
8.784
</td>
<td style="text-align:right;">
1.757
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
133887.203
</td>
<td style="text-align:right;">
1.763
</td>
<td style="text-align:right;">
0.117
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_SEPR_habituation.html&#39;))</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|id),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model


##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;task progression (TP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;S x group&#39;,&#39;S x TP&#39;,&#39;group x TP&#39;,&#39;S x group x TP&#39;)
   
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                row_names  Sum Sq Mean Sq NumDF
EventData                                    stimulus (S)  27.812   9.271     3
t1_diagnosis                                        group   1.077   1.077     1
EventCounter                        task progression (TP)   3.724   3.724     1
scale(ageyrs)                                         age 108.521 108.521     1
scale(t1_piq)                               perceptual IQ   0.102   0.102     1
sex                                                   sex   1.701   1.701     1
scale(center_dev)                           sampling rate   1.606   1.606     1
as.factor(sampling_rate)            gaze center deviation   2.567   2.567     1
scale(missing_data_trial)                    data quality   3.715   3.715     1
EventData:t1_diagnosis                          S x group   3.883   1.294     3
EventData:EventCounter                             S x TP   3.714   1.238     3
t1_diagnosis:EventCounter                      group x TP   3.584   3.584     1
EventData:t1_diagnosis:EventCounter        S x group x TP   7.187   2.396     3
                                        DenDF F value Pr(&gt;F)
EventData                           45391.757  10.559  0.000
t1_diagnosis                          302.409   1.227  0.269
EventCounter                        45382.911   4.242  0.039
scale(ageyrs)                         229.741 123.600  0.000
scale(t1_piq)                         229.560   0.117  0.733
sex                                   228.781   1.937  0.165
scale(center_dev)                   10137.119   1.829  0.176
as.factor(sampling_rate)              226.455   2.923  0.089
scale(missing_data_trial)           45575.232   4.231  0.040
EventData:t1_diagnosis              45391.262   1.474  0.219
EventData:EventCounter              45416.556   1.410  0.238
t1_diagnosis:EventCounter           45586.756   4.083  0.043
EventData:t1_diagnosis:EventCounter 45416.859   2.728  0.042</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: mismatch negativity - task progression&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: mismatch negativity - task progression
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
27.812
</td>
<td style="text-align:right;">
9.271
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45391.757
</td>
<td style="text-align:right;">
10.559
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
1.077
</td>
<td style="text-align:right;">
1.077
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
302.409
</td>
<td style="text-align:right;">
1.227
</td>
<td style="text-align:right;">
0.269
</td>
</tr>
<tr>
<td style="text-align:left;">
task progression (TP)
</td>
<td style="text-align:right;">
3.724
</td>
<td style="text-align:right;">
3.724
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45382.911
</td>
<td style="text-align:right;">
4.242
</td>
<td style="text-align:right;">
0.039
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
108.521
</td>
<td style="text-align:right;">
108.521
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
229.741
</td>
<td style="text-align:right;">
123.600
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
229.560
</td>
<td style="text-align:right;">
0.117
</td>
<td style="text-align:right;">
0.733
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1.701
</td>
<td style="text-align:right;">
1.701
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
228.781
</td>
<td style="text-align:right;">
1.937
</td>
<td style="text-align:right;">
0.165
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
1.606
</td>
<td style="text-align:right;">
1.606
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10137.119
</td>
<td style="text-align:right;">
1.829
</td>
<td style="text-align:right;">
0.176
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
2.567
</td>
<td style="text-align:right;">
2.567
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
226.455
</td>
<td style="text-align:right;">
2.923
</td>
<td style="text-align:right;">
0.089
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
3.715
</td>
<td style="text-align:right;">
3.715
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45575.232
</td>
<td style="text-align:right;">
4.231
</td>
<td style="text-align:right;">
0.040
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
3.883
</td>
<td style="text-align:right;">
1.294
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45391.262
</td>
<td style="text-align:right;">
1.474
</td>
<td style="text-align:right;">
0.219
</td>
</tr>
<tr>
<td style="text-align:left;">
S x TP
</td>
<td style="text-align:right;">
3.714
</td>
<td style="text-align:right;">
1.238
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45416.556
</td>
<td style="text-align:right;">
1.410
</td>
<td style="text-align:right;">
0.238
</td>
</tr>
<tr>
<td style="text-align:left;">
group x TP
</td>
<td style="text-align:right;">
3.584
</td>
<td style="text-align:right;">
3.584
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45586.756
</td>
<td style="text-align:right;">
4.083
</td>
<td style="text-align:right;">
0.043
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x TP
</td>
<td style="text-align:right;">
7.187
</td>
<td style="text-align:right;">
2.396
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45416.859
</td>
<td style="text-align:right;">
2.728
</td>
<td style="text-align:right;">
0.042
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_MMN.html&#39;))</code></pre>
<pre class="r"><code>#full model
lmm_full&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*sequence_position_z+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)+
              (1|id),data=df_trial)
              #--&gt; group effect (interaction) is robust in reduced and full model


##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;sequence position - continuous (SP)&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;sampling rate&#39;,&#39;gaze center deviation&#39;,&#39;data quality&#39;,
               &#39;S x group&#39;,&#39;S x SP&#39;,&#39;group x SP&#39;,&#39;S x group x SP&#39;)
   
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                                     row_names
EventData                                                         stimulus (S)
t1_diagnosis                                                             group
sequence_position_z                        sequence position - continuous (SP)
scale(ageyrs)                                                              age
scale(t1_piq)                                                    perceptual IQ
sex                                                                        sex
scale(center_dev)                                                sampling rate
as.factor(sampling_rate)                                 gaze center deviation
scale(missing_data_trial)                                         data quality
EventData:t1_diagnosis                                               S x group
EventData:sequence_position_z                                           S x SP
t1_diagnosis:sequence_position_z                                    group x SP
EventData:t1_diagnosis:sequence_position_z                      S x group x SP
                                            Sum Sq Mean Sq NumDF     DenDF
EventData                                   87.246  29.082     3 45445.346
t1_diagnosis                                 0.143   0.143     1   229.963
sequence_position_z                          0.003   0.003     1 45416.726
scale(ageyrs)                              108.333 108.333     1   229.731
scale(t1_piq)                                0.127   0.127     1   229.463
sex                                          1.669   1.669     1   228.787
scale(center_dev)                            0.754   0.754     1 10982.989
as.factor(sampling_rate)                     2.491   2.491     1   226.442
scale(missing_data_trial)                    3.563   3.563     1 45574.546
EventData:t1_diagnosis                      11.056   3.685     3 45444.126
EventData:sequence_position_z                2.504   0.835     3 45409.835
t1_diagnosis:sequence_position_z             2.135   2.135     1 45418.100
EventData:t1_diagnosis:sequence_position_z   0.198   0.066     3 45409.906
                                           F value Pr(&gt;F)
EventData                                   33.113  0.000
t1_diagnosis                                 0.163  0.686
sequence_position_z                          0.004  0.952
scale(ageyrs)                              123.347  0.000
scale(t1_piq)                                0.145  0.704
sex                                          1.901  0.169
scale(center_dev)                            0.859  0.354
as.factor(sampling_rate)                     2.836  0.094
scale(missing_data_trial)                    4.056  0.044
EventData:t1_diagnosis                       4.196  0.006
EventData:sequence_position_z                0.950  0.415
t1_diagnosis:sequence_position_z             2.431  0.119
EventData:t1_diagnosis:sequence_position_z   0.075  0.973</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: mismatch negativity - habituation&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: mismatch negativity - habituation
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
87.246
</td>
<td style="text-align:right;">
29.082
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45445.346
</td>
<td style="text-align:right;">
33.113
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
0.143
</td>
<td style="text-align:right;">
0.143
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
229.963
</td>
<td style="text-align:right;">
0.163
</td>
<td style="text-align:right;">
0.686
</td>
</tr>
<tr>
<td style="text-align:left;">
sequence position - continuous (SP)
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45416.726
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.952
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
108.333
</td>
<td style="text-align:right;">
108.333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
229.731
</td>
<td style="text-align:right;">
123.347
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
0.127
</td>
<td style="text-align:right;">
0.127
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
229.463
</td>
<td style="text-align:right;">
0.145
</td>
<td style="text-align:right;">
0.704
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1.669
</td>
<td style="text-align:right;">
1.669
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
228.787
</td>
<td style="text-align:right;">
1.901
</td>
<td style="text-align:right;">
0.169
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
0.754
</td>
<td style="text-align:right;">
0.754
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10982.989
</td>
<td style="text-align:right;">
0.859
</td>
<td style="text-align:right;">
0.354
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
2.491
</td>
<td style="text-align:right;">
2.491
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
226.442
</td>
<td style="text-align:right;">
2.836
</td>
<td style="text-align:right;">
0.094
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
3.563
</td>
<td style="text-align:right;">
3.563
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45574.546
</td>
<td style="text-align:right;">
4.056
</td>
<td style="text-align:right;">
0.044
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
11.056
</td>
<td style="text-align:right;">
3.685
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45444.126
</td>
<td style="text-align:right;">
4.196
</td>
<td style="text-align:right;">
0.006
</td>
</tr>
<tr>
<td style="text-align:left;">
S x SP
</td>
<td style="text-align:right;">
2.504
</td>
<td style="text-align:right;">
0.835
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45409.835
</td>
<td style="text-align:right;">
0.950
</td>
<td style="text-align:right;">
0.415
</td>
</tr>
<tr>
<td style="text-align:left;">
group x SP
</td>
<td style="text-align:right;">
2.135
</td>
<td style="text-align:right;">
2.135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45418.100
</td>
<td style="text-align:right;">
2.431
</td>
<td style="text-align:right;">
0.119
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x SP
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
0.066
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45409.906
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
0.973
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_MMN_habituation.html&#39;))</code></pre>
<pre class="r"><code>lmm_full&lt;-lm(scale(gain_pcdm)~t1_diagnosis+
               scale(ageyrs)+scale(t1_piq)+sex+
               scale(center_dev)+as.factor(sampling_rate)+scale(missing_data_trial)
               ,df_timepoint[df_timepoint$Rsq_pcdm&gt;0.2,])

anova(lmm_full) #higher gain in ASD for standards</code></pre>
<pre><code>Analysis of Variance Table

Response: scale(gain_pcdm)
                           Df  Sum Sq Mean Sq F value Pr(&gt;F)  
t1_diagnosis                1   4.761  4.7607  4.7179 0.0319 *
scale(ageyrs)               1   0.636  0.6356  0.6298 0.4290  
scale(t1_piq)               1   0.054  0.0540  0.0535 0.8175  
sex                         1   0.099  0.0990  0.0981 0.7547  
scale(center_dev)           1   0.224  0.2236  0.2216 0.6387  
as.factor(sampling_rate)    1   0.000  0.0004  0.0004 0.9845  
scale(missing_data_trial)   1   0.183  0.1832  0.1816 0.6708  
Residuals                 115 116.044  1.0091                 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>##supplements - full table
  row_names&lt;-c(&#39;group&#39;,
               &#39;age&#39;,&#39;perceptual IQ&#39;,&#39;sex&#39;,
               &#39;gaze center deviation&#39;,&#39;sampling rate&#39;,&#39;data quality&#39;,
               &#39;residuals&#39;)
   
  
  table_data_model&lt;-round(anova(lmm_full),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                      row_names  Df  Sum Sq Mean Sq F value
t1_diagnosis                              group   1   4.761   4.761   4.718
scale(ageyrs)                               age   1   0.636   0.636   0.630
scale(t1_piq)                     perceptual IQ   1   0.054   0.054   0.053
sex                                         sex   1   0.099   0.099   0.098
scale(center_dev)         gaze center deviation   1   0.224   0.224   0.222
as.factor(sampling_rate)          sampling rate   1   0.000   0.000   0.000
scale(missing_data_trial)          data quality   1   0.183   0.183   0.182
Residuals                             residuals 115 116.044   1.009      NA
                          Pr(&gt;F)
t1_diagnosis               0.032
scale(ageyrs)              0.429
scale(t1_piq)              0.818
sex                        0.755
scale(center_dev)          0.639
as.factor(sampling_rate)   0.984
scale(missing_data_trial)  0.671
Residuals                     NA</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear model: neural gain&quot;,
        col.names = c(&#39;&#39;,&#39;Df&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear model: neural gain
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.761
</td>
<td style="text-align:right;">
4.761
</td>
<td style="text-align:right;">
4.718
</td>
<td style="text-align:right;">
0.032
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.636
</td>
<td style="text-align:right;">
0.636
</td>
<td style="text-align:right;">
0.630
</td>
<td style="text-align:right;">
0.429
</td>
</tr>
<tr>
<td style="text-align:left;">
perceptual IQ
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
0.818
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
0.755
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
0.639
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.984
</td>
</tr>
<tr>
<td style="text-align:left;">
data quality
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.183
</td>
<td style="text-align:right;">
0.183
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
0.671
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
116.044
</td>
<td style="text-align:right;">
1.009
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_model_NG.html&#39;))</code></pre>
</div>
<div id="covariate-associations-with-bps-sepr-mmn"
class="section level2">
<h2>covariate associations with BPS, SEPR, MMN</h2>
<p>###BPS</p>
<pre class="r"><code>#full model  - save to supplements      
lmm_full&lt;-lmer(scale(pd_baseline)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
      scale(ageyrs)+scale(t1_piq)+sex+
      as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)+
      (1|subjects)+(1|wave),data=df_trial)


age_eff&lt;-cbind(&#39;age (yrs)&#39;,
               round(fixef(lmm_full)[&#39;scale(ageyrs)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(ageyrs)&#39;),2))

samplingrate_eff&lt;-confint(contrast(emmeans(lmm_full,~sampling_rate),
                                   &#39;revpairwise&#39;))[c(&#39;contrast&#39;,&#39;estimate&#39;,&#39;asymp.LCL&#39;,&#39;asymp.UCL&#39;)]

centerdev_eff&lt;-cbind(&#39;gaze center deviation (%)&#39;,
               round(fixef(lmm_full)[&#39;scale(center_dev)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(center_dev)&#39;),2))


dquality_eff&lt;-cbind(&#39;missing data per trial (%)&#39;,
               round(fixef(lmm_full)[&#39;scale(missing_data_trial)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(missing_data_trial)&#39;),2))


cov_eff_data&lt;-rbind(age_eff,
      c(&#39;sampling rate (300Hz vs. 120Hz)&#39;,round(samplingrate_eff[1,2:4],2)),
      centerdev_eff,
      dquality_eff)


cov_eff_table&lt;-cov_eff_data %&gt;%
    kbl(caption = &quot;Covariate effects on baseline pupil size (BPS)&quot;,
        col.names = c(&#39;covariate&#39;,&#39;estimate&#39;,&#39;lower bound (2.5%)&#39;,&#39;upper bound (97.5%)&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  cov_eff_table</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Covariate effects on baseline pupil size (BPS)
</caption>
<thead>
<tr>
<th style="text-align:left;">
covariate
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
lower bound (2.5%)
</th>
<th style="text-align:left;">
upper bound (97.5%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age (yrs)
</td>
<td style="text-align:left;">
-0.56
</td>
<td style="text-align:left;">
-0.63
</td>
<td style="text-align:left;">
-0.48
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling rate (300Hz vs. 120Hz)
</td>
<td style="text-align:left;">
0.17
</td>
<td style="text-align:left;">
0.16
</td>
<td style="text-align:left;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
gaze center deviation (%)
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.01
</td>
<td style="text-align:left;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
missing data per trial (%)
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(cov_eff_table, file= paste0(project_path,&#39;/output/supplements/table_BPS_covariateeffects.html&#39;))</code></pre>
<p>###SEPR</p>
<pre class="r"><code>#full model  - save to supplements      
lmm_full&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
      scale(ageyrs)+scale(t1_piq)+sex+
      as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)+
      (1|subjects)+(1|wave),data=df_trial)


dquality_eff&lt;-cbind(&#39;missing data per trial (%)&#39;,
               round(fixef(lmm_full)[&#39;scale(missing_data_trial)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(missing_data_trial)&#39;),2))


cov_eff_data&lt;-rbind(dquality_eff)

cov_eff_table&lt;-cov_eff_data %&gt;%
    kbl(caption = &quot;Covariate effects on stimulus-evoked pupillary response (SEPR)&quot;,
        col.names = c(&#39;covariate&#39;,&#39;estimate&#39;,&#39;lower bound (2.5%)&#39;,&#39;upper bound (97.5%)&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  cov_eff_table</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Covariate effects on stimulus-evoked pupillary response (SEPR)
</caption>
<thead>
<tr>
<th style="text-align:left;">
covariate
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
lower bound (2.5%)
</th>
<th style="text-align:left;">
upper bound (97.5%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
missing data per trial (%)
</td>
<td style="text-align:left;">
-0.03
</td>
<td style="text-align:left;">
-0.03
</td>
<td style="text-align:left;">
-0.03
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(cov_eff_table, file= paste0(project_path,&#39;/output/supplements/table_SEPR_covariateeffects.html&#39;))</code></pre>
<p>###MMN</p>
<pre class="r"><code>#full model  - save to supplements      
lmm_full&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*stats::poly(EventCounter,3)+
      scale(ageyrs)+scale(t1_piq)+sex+
      as.factor(sampling_rate)+scale(center_dev)+scale(missing_data_trial)+
      (1|id),data=df_trial)


age_eff&lt;-cbind(&#39;age (yrs)&#39;,
               round(fixef(lmm_full)[&#39;scale(ageyrs)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(ageyrs)&#39;),2))


dquality_eff&lt;-cbind(&#39;missing data per trial (%)&#39;,
               round(fixef(lmm_full)[&#39;scale(missing_data_trial)&#39;],2),
               round(confint(lmm_full,parm = &#39;scale(missing_data_trial)&#39;),2))


cov_eff_data&lt;-rbind(age_eff,
                    dquality_eff)

cov_eff_table&lt;-cov_eff_data %&gt;%
    kbl(caption = &quot;Covariate effects on mismatch negativity (MMN)&quot;,
        col.names = c(&#39;covariate&#39;,&#39;estimate&#39;,&#39;lower bound (2.5%)&#39;,&#39;upper bound (97.5%)&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  cov_eff_table</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Covariate effects on mismatch negativity (MMN)
</caption>
<thead>
<tr>
<th style="text-align:left;">
covariate
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
lower bound (2.5%)
</th>
<th style="text-align:left;">
upper bound (97.5%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age (yrs)
</td>
<td style="text-align:left;">
0.22
</td>
<td style="text-align:left;">
0.18
</td>
<td style="text-align:left;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
missing data per trial (%)
</td>
<td style="text-align:left;">
-0.01
</td>
<td style="text-align:left;">
-0.02
</td>
<td style="text-align:left;">
0
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(cov_eff_table, file= paste0(project_path,&#39;/output/supplements/table_MMN_covariateeffects.html&#39;))</code></pre>
</div>
<div
id="scaling-of-bps-sepr-and-mmn-for-demographic-variables-between-groups"
class="section level2">
<h2>scaling of BPS SEPR and MMN for demographic variables between
groups</h2>
<div id="sepr-scaling-with-demographic-variables"
class="section level3">
<h3>SEPR scaling with demographic variables</h3>
<pre class="r"><code>  ###SCALING of pupillary response AUC WITH MAIN DEMOGRAPHIC VARIABLES ####

  hist(df_trial$ageyrs) ## pick 10 - 25 years</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/SEPR%20scaling%20with%20demographics%20between%20groups-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  hist(df_trial$t1_piq) ### IQ 80-135</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/SEPR%20scaling%20with%20demographics%20between%20groups-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>    labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball&quot;, &quot;204&quot; = &quot;pitch+length oddball&quot;)

  #age
  g1&lt;-ggplot(df_trial[df_trial$ageyrs&gt;=10 &amp; df_trial$ageyrs&lt;=25,],aes(x=ageyrs,y=scale(rpd_auc),group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;age (years)&#39;,y=&#39;&#39;)+
    coord_cartesian(ylim = c(-0.05, 0.15))+
    theme_bw()

  #IQ
  g2&lt;-ggplot(df_trial[df_trial$t1_piq &gt; 80 &amp; df_trial$t1_piq &lt; 135,],aes(x=t1_piq,y=scale(rpd_auc),group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;perceptual IQ&#39;,y=&#39;&#39;)+
    coord_cartesian(ylim = c(-0.05, 0.15))+
    theme_bw()

    #summary functions
    stat_sum_df &lt;- function(fun, geom=&quot;crossbar&quot;, ...) {
      stat_summary(fun.data=fun, geom=geom, width=0.2, ...)
    }

    stat_sum_single &lt;- function(fun, geom=&quot;point&quot;, ...) {
      stat_summary(fun=fun, geom=geom, size = 3, ...)
    }

  group_labels&lt;-c(&quot;female&quot;,&quot;female&quot;,&quot;male&quot;,&quot;male&quot;)
  g3&lt;-ggplot(df_trial,aes(x=interaction(t1_diagnosis,sex),y=scale(rpd_auc),group=interaction(EventData,t1_diagnosis,sex),color=t1_diagnosis))+
    stat_sum_df(&quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;)+
    stat_sum_single(&quot;mean&quot;)+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_x_discrete(labels=group_labels)+
    labs(x=&#39;biological sex&#39;,y=&#39;&#39;)+
    coord_cartesian(ylim = c(-0.05, 0.15))+
    theme_bw()

  
  grid.arrange(g1,g2,g3,nrow=3)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/SEPR%20scaling%20with%20demographics%20between%20groups-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  #save to file
tiff(file=paste0(project_path,&quot;/output/supplements/SEPR_scaling_withdemographics_between_groups.tiff&quot;), # create a file in tiff format in current working directory
  width=10, height=8, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

  grid.arrange(g1,g2,g3,nrow=3,left=&#39;stimulus-evoked pupillary response (SEPR, z)&#39;)

        
dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
<div id="bps-scaling-with-demographic-variables" class="section level3">
<h3>BPS scaling with demographic variables</h3>
<pre class="r"><code>  ###SCALING of baseline pupil size WITH MAIN DEMOGRAPHIC VARIABLES ####

  labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball&quot;, &quot;204&quot; = &quot;pitch+length oddball&quot;)
  #age
  g1&lt;-ggplot(df_trial[df_trial$ageyrs&gt;=10 &amp; df_trial$ageyrs&lt;=25,],aes(x=ageyrs,y=pd_baseline,group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;age (years)&#39;,y=&#39;&#39;)+
    theme_bw()

  #IQ
  g2&lt;-ggplot(df_trial[df_trial$t1_piq &gt; 80 &amp; df_trial$t1_piq &lt; 135,],aes(x=t1_piq,y=pd_baseline,group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;perceptual IQ&#39;,y=&#39;&#39;)+
    theme_bw()


  #summary functions
  stat_sum_df &lt;- function(fun, geom=&quot;crossbar&quot;, ...) {
    stat_summary(fun.data=fun, geom=geom, width=0.2, ...)
  }

  stat_sum_single &lt;- function(fun, geom=&quot;point&quot;, ...) {
    stat_summary(fun=fun, geom=geom, size = 3, ...)
  }

  group_labels&lt;-c(&quot;female&quot;,&quot;female&quot;,&quot;male&quot;,&quot;male&quot;)
  g3&lt;-ggplot(df_trial,aes(x=interaction(t1_diagnosis,sex),y=pd_baseline,group=interaction(EventData,t1_diagnosis,sex),color=t1_diagnosis))+
    stat_sum_df(&quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;)+
    stat_sum_single(&quot;mean&quot;)+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_x_discrete(labels=group_labels)+
    labs(x=&#39;biological sex&#39;,y=&#39;&#39;)+
    theme_bw()

  grid.arrange(g1,g2,g3,nrow=3)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/BPS%20scaling%20with%20demographics%20between%20groups-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  ####--&gt; higher IQ and lower age in autistic females?

      with(df_dem,by(t1_piq,interaction(t1_sex,t1_diagnosis),summary))</code></pre>
<pre><code>interaction(t1_sex, t1_diagnosis): Female.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  57.00   86.25  100.50   97.00  112.00  133.00 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     45      86     102     100     113     137 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Female.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   59.0    97.5   105.0   103.0   113.5   131.0 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     51      94     105     104     117     137 </code></pre>
<pre class="r"><code>      with(df_dem,by(t1_ageyrs,interaction(t1_sex,t1_diagnosis),summary))</code></pre>
<pre><code>interaction(t1_sex, t1_diagnosis): Female.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.753  11.282  16.644  16.586  22.522  27.353 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.236  12.447  15.052  15.960  19.441  26.559 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Female.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  7.219  12.684  17.085  17.448  21.571  27.693 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.236  13.732  16.605  17.668  21.734  30.975 </code></pre>
<pre class="r"><code>    #save to file
tiff(file=paste0(project_path,&quot;/output/supplements/BPS_scaling_withdemographics_between_groups.tiff&quot;), # create a file in tiff format in current working directory
  width=10, height=8, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

  grid.arrange(g1,g2,g3,nrow=3,left=&#39;baseline pupil size (mm)&#39;)

        
dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
<p>MMN scaling with demographic variables</p>
<pre class="r"><code>  ###SCALING of MMN WITH MAIN DEMOGRAPHIC VARIABLES ####

    labels &lt;- c(&quot;201&quot; = &quot;standard&quot;, &quot;202&quot; = &quot;pitch oddball&quot;, &quot;203&quot; = &quot;length oddball&quot;, &quot;204&quot; = &quot;pitch+length oddball&quot;)

  #age
  g1&lt;-ggplot(df_trial[df_trial$ageyrs&gt;=10 &amp; df_trial$ageyrs&lt;=25,],aes(x=ageyrs,y=mmn,group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;age (years)&#39;,y=&#39;&#39;)+
    theme_bw()

  #IQ
  g2&lt;-ggplot(df_trial[df_trial$t1_piq &gt; 80 &amp; df_trial$t1_piq &lt; 135,],aes(x=t1_piq,y=mmn,group=interaction(EventData,t1_diagnosis),color=t1_diagnosis,fill=t1_diagnosis))+
    geom_smooth(method=&#39;lm&#39;)+facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    scale_fill_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    labs(x=&#39;perceptual IQ&#39;,y=&#39;&#39;)+
    theme_bw()


  #summary functions
  stat_sum_df &lt;- function(fun, geom=&quot;crossbar&quot;, ...) {
    stat_summary(fun.data=fun, geom=geom, width=0.2, ...)
  }

  stat_sum_single &lt;- function(fun, geom=&quot;point&quot;, ...) {
    stat_summary(fun=fun, geom=geom, size = 3, ...)
  }

  group_labels&lt;-c(&quot;female&quot;,&quot;female&quot;,&quot;male&quot;,&quot;male&quot;)
  g3&lt;-ggplot(df_trial,aes(x=interaction(t1_diagnosis,sex),y=mmn,group=interaction(EventData,t1_diagnosis,sex),color=t1_diagnosis))+
    stat_sum_df(&quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;)+
    stat_sum_single(&quot;mean&quot;)+
    scale_color_manual(name = &quot;group&quot;, labels = c(&quot;autistic&quot;, &quot;non-autistic&quot;),values = custom_group_color)+
    facet_grid(~EventData,labeller=labeller(EventData = labels))+
    scale_x_discrete(labels=group_labels)+
    labs(x=&#39;biological sex&#39;,y=&#39;&#39;)+
    theme_bw()

  grid.arrange(g1,g2,g3,nrow=3)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/MMN%20scaling%20with%20demographics%20between%20groups-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  ####--&gt; higher IQ and lower age in autistic females?

  with(df_dem,by(t1_piq,interaction(t1_sex,t1_diagnosis),summary))</code></pre>
<pre><code>interaction(t1_sex, t1_diagnosis): Female.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  57.00   86.25  100.50   97.00  112.00  133.00 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     45      86     102     100     113     137 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Female.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   59.0    97.5   105.0   103.0   113.5   131.0 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     51      94     105     104     117     137 </code></pre>
<pre class="r"><code>  with(df_dem,by(t1_ageyrs,interaction(t1_sex,t1_diagnosis),summary))</code></pre>
<pre><code>interaction(t1_sex, t1_diagnosis): Female.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.753  11.282  16.644  16.586  22.522  27.353 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.ASD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.236  12.447  15.052  15.960  19.441  26.559 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Female.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  7.219  12.684  17.085  17.448  21.571  27.693 
------------------------------------------------------------ 
interaction(t1_sex, t1_diagnosis): Male.Control
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  6.236  13.732  16.605  17.668  21.734  30.975 </code></pre>
<pre class="r"><code>  #save to file
tiff(file=paste0(project_path,&quot;/output/supplements/MMN_scaling_withdemographics_between_groups.tiff&quot;), # create a file in tiff format in current working directory
  width=10, height=8, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

  grid.arrange(g1,g2,g3,nrow=3,left=&#39;mismatch negativity (uV)&#39;)

        
dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div id="bayesian-chains---convergence-and-stationarity-of-estimates"
class="section level2">
<h2>Bayesian chains - convergence and stationarity of estimates</h2>
<pre class="r"><code>###load saved Bayeisan posterior estimates
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_twoway.Rdata&#39;)) #draws_BPS_twoway
load(file=paste0(project_path,&#39;/data/Bayesian_model_BPS_supp.Rdata&#39;)) #draws_BPS_supp
load(file=paste0(project_path,&#39;/data/Bayesian_model_SEPR_threewayinteraction.Rdata&#39;)) #draws_SEPR_threeway
load(file=paste0(project_path,&#39;/data/Bayesian_model_MMN_threewayinteraction.Rdata&#39;)) #draws_MMN_threeway

### for supplements

#chain converge and stationary

# #draws_BPS_twoway - chain converge and stationary
var_names &lt;- c(&quot;design_coef[1,1]&quot; = &quot;BPS_task_progression: autistic&quot;,
               &quot;design_coef[2,1]&quot; = &quot;BPS_task_progression: non-autistic&quot;) #define parameter names

g1a&lt;-mcmc_trace(draws_BPS_twoway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed))))
g1b&lt;-mcmc_dens(draws_BPS_twoway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)))) 

# #draws_BPS_supp - chain converge and stationary
var_names &lt;- c(&quot;design_coef[1,1]&quot; = &quot;BPS_sequence_position: autistic&quot;,
               &quot;design_coef[2,1]&quot; = &quot;BPS_sequence_position: non-autistic&quot;) #define parameter names

g2a&lt;-mcmc_trace(draws_BPS_supp, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed))))
g2b&lt;-mcmc_dens(draws_BPS_supp, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)))) 

# #draws_SEPR_threeway - chain converge and stationary
var_names &lt;- c(&quot;group_event_coefs[1,1]&quot; = &quot;SEPR_trend: autistic_standard&quot;,
               &quot;group_event_coefs[2,1]&quot; = &quot;SEPR_trend: non-autistic_standard&quot;,
               &quot;group_event_coefs[3,1]&quot; = &quot;SEPR_trend: autistic_pitch&quot;,
               &quot;group_event_coefs[4,1]&quot; = &quot;SEPR_trend: non-autistic_pitch&quot;,
               &quot;group_event_coefs[5,1]&quot; = &quot;SEPR_trend: autistic_length&quot;,
               &quot;group_event_coefs[6,1]&quot; = &quot;SEPR_trend: non-autistic_length&quot;,
               &quot;group_event_coefs[7,1]&quot; = &quot;SEPR_trend: autistic_pitch+length&quot;,
               &quot;group_event_coefs[8,1]&quot; = &quot;SEPR_trend: non-autistic_pitch+length&quot;) #define parameter names

g3a&lt;-mcmc_trace(draws_SEPR_threeway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)),nrow=1))
g3b&lt;-mcmc_dens(draws_SEPR_threeway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)),nrow=1)) 

# #draws_MMN_threeway - chain converge and stationary
var_names &lt;- c(&quot;group_event_coefs[1,1]&quot; = &quot;MMN_trend: autistic_standard&quot;,
               &quot;group_event_coefs[2,1]&quot; = &quot;MMN_trend: non-autistic_standard&quot;,
               &quot;group_event_coefs[3,1]&quot; = &quot;MMN_trend: autistic_pitch&quot;,
               &quot;group_event_coefs[4,1]&quot; = &quot;MMN_trend: non-autistic_pitch&quot;,
               &quot;group_event_coefs[5,1]&quot; = &quot;MMN_trend: autistic_length&quot;,
               &quot;group_event_coefs[6,1]&quot; = &quot;MMN_trend: non-autistic_length&quot;,
               &quot;group_event_coefs[7,1]&quot; = &quot;MMN_trend: autistic_pitch+length&quot;,
               &quot;group_event_coefs[8,1]&quot; = &quot;MMN_trend: non-autistic_pitch+length&quot;) #define parameter names

g4a&lt;-mcmc_trace(draws_MMN_threeway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)),nrow=1))
g4b&lt;-mcmc_dens(draws_MMN_threeway, 
           facet_args = list(labeller = labeller(parameter = as_labeller(var_names, label_parsed)),nrow=1)) 


#extract legend
g_legend&lt;-function(x){
  tmp &lt;- ggplot_gtable(ggplot_build(x))
  leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == &quot;guide-box&quot;)
  legend &lt;- tmp$grobs[[leg]]
  return(legend)}

mylegend&lt;-g_legend(g1a)

#arrange figures
g1&lt;-grid.arrange(g1a+theme(legend.position = &#39;none&#39;),g1b,top=&quot;BPS - task progression&quot;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g2&lt;-grid.arrange(g2a+theme(legend.position = &#39;none&#39;),g2b,top=&quot;BPS - sequence position&quot;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g3&lt;-grid.arrange(g3a+theme(legend.position = &#39;none&#39;),g3b,top=&quot;SEPR trend&quot;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g4&lt;-grid.arrange(g4a+theme(legend.position = &#39;none&#39;),g4b,top=&quot;MMN trend&quot;)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>g_figures&lt;-grid.arrange(
  grid.arrange(g1,g2,ncol=2),
  g3,g4,
  nrow=3)</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>grid.arrange(g_figures,mylegend,ncol=2,widths=c(20,1))</code></pre>
<p><img src="figure/data_analysis_oddball_leap.Rmd/figure%20Bayesian%20models%20chain%20convergence%20stationarity-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#save to file
tiff(file=paste0(project_path,&quot;/output/supplements/Bayesian_chains_convergence.tiff&quot;), # create a file in tiff format in current working directory
  width=25, height=15, units=&quot;in&quot;, res=300, compression=&#39;lzw&#39;) #define size and resolution of the resulting figure

grid.arrange(g_figures,mylegend,ncol=2,widths=c(20,1))
      
dev.off() #close operation and save file</code></pre>
<pre><code>png 
  2 </code></pre>
</div>
<div id="moderation-of-bps-on-sepr-and-mmn-interaction-by-group"
class="section level2">
<h2>moderation of BPS on SEPR and MMN interaction by group</h2>
<pre class="r"><code>#moderation of BPS on SEPR interaction with group
  lmm_REML_BPS&lt;-lmer(scale(rpd_auc)~EventData*t1_diagnosis*EventCounter+scale(pd_baseline)+
                   (1|subjects)+(1|wave),data=df_trial)

  anova(lmm_REML_BPS)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF  DenDF    F value
EventData                              15.8     5.3     3 298692     5.4871
t1_diagnosis                            1.1     1.1     1    242     1.1807
EventCounter                            3.6     3.6     1 298755     3.7155
scale(pd_baseline)                  10567.4 10567.4     1 203223 10999.6895
EventData:t1_diagnosis                  7.6     2.5     3 298692     2.6209
EventData:EventCounter                  4.4     1.5     3 298691     1.5264
t1_diagnosis:EventCounter               0.1     0.1     1 298754     0.1061
EventData:t1_diagnosis:EventCounter     9.0     3.0     3 298691     3.1082
                                       Pr(&gt;F)    
EventData                           0.0009121 ***
t1_diagnosis                        0.2783026    
EventCounter                        0.0539103 .  
scale(pd_baseline)                  &lt; 2.2e-16 ***
EventData:t1_diagnosis              0.0489398 *  
EventData:EventCounter              0.2053263    
t1_diagnosis:EventCounter           0.7446003    
EventData:t1_diagnosis:EventCounter 0.0252746 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  ##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;task progression (TP)&#39;,
               &#39;BPS&#39;,
               &#39;S x group&#39;,&#39;S x TP&#39;,&#39;group x TP&#39;,&#39;S x group x TP&#39;)
  
  
  table_data_model&lt;-round(anova(lmm_REML_BPS),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                row_names    Sum Sq   Mean Sq
EventData                                    stimulus (S)    15.814     5.271
t1_diagnosis                                        group     1.134     1.134
EventCounter                        task progression (TP)     3.569     3.569
scale(pd_baseline)                                    BPS 10567.407 10567.407
EventData:t1_diagnosis                          S x group     7.554     2.518
EventData:EventCounter                             S x TP     4.399     1.466
t1_diagnosis:EventCounter                      group x TP     0.102     0.102
EventData:t1_diagnosis:EventCounter        S x group x TP     8.958     2.986
                                    NumDF      DenDF   F value Pr(&gt;F)
EventData                               3 298692.020     5.487  0.001
t1_diagnosis                            1    241.506     1.181  0.278
EventCounter                            1 298755.255     3.716  0.054
scale(pd_baseline)                      1 203222.862 10999.689  0.000
EventData:t1_diagnosis                  3 298691.605     2.621  0.049
EventData:EventCounter                  3 298691.483     1.526  0.205
t1_diagnosis:EventCounter               1 298753.577     0.106  0.745
EventData:t1_diagnosis:EventCounter     3 298691.278     3.108  0.025</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: Moderation of group differences in dynamic stimulus-evoked pupillary response (SEPR) group differences by baseline pupil size (BPS)&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: Moderation of group differences in dynamic
stimulus-evoked pupillary response (SEPR) group differences by baseline
pupil size (BPS)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
15.814
</td>
<td style="text-align:right;">
5.271
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298692.020
</td>
<td style="text-align:right;">
5.487
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
1.134
</td>
<td style="text-align:right;">
1.134
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
241.506
</td>
<td style="text-align:right;">
1.181
</td>
<td style="text-align:right;">
0.278
</td>
</tr>
<tr>
<td style="text-align:left;">
task progression (TP)
</td>
<td style="text-align:right;">
3.569
</td>
<td style="text-align:right;">
3.569
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
298755.255
</td>
<td style="text-align:right;">
3.716
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS
</td>
<td style="text-align:right;">
10567.407
</td>
<td style="text-align:right;">
10567.407
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
203222.862
</td>
<td style="text-align:right;">
10999.689
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
7.554
</td>
<td style="text-align:right;">
2.518
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298691.605
</td>
<td style="text-align:right;">
2.621
</td>
<td style="text-align:right;">
0.049
</td>
</tr>
<tr>
<td style="text-align:left;">
S x TP
</td>
<td style="text-align:right;">
4.399
</td>
<td style="text-align:right;">
1.466
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298691.483
</td>
<td style="text-align:right;">
1.526
</td>
<td style="text-align:right;">
0.205
</td>
</tr>
<tr>
<td style="text-align:left;">
group x TP
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
298753.577
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.745
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x TP
</td>
<td style="text-align:right;">
8.958
</td>
<td style="text-align:right;">
2.986
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
298691.278
</td>
<td style="text-align:right;">
3.108
</td>
<td style="text-align:right;">
0.025
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_moderation_SEPR_by_BPS.html&#39;))


  #moderation of BPS on MMN interaction with group
  lmm_REML_BPS&lt;-lmer(scale(mmn)~EventData*t1_diagnosis*EventCounter+scale(pd_baseline)+
                       (1|subjects)+(1|wave),data=df_trial)

  anova(lmm_REML_BPS)</code></pre>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
                                     Sum Sq Mean Sq NumDF DenDF F value
EventData                           28.4353  9.4784     3 45445 10.8089
t1_diagnosis                         2.9067  2.9067     1   195  3.3148
EventCounter                         2.7082  2.7082     1 45538  3.0883
scale(pd_baseline)                   8.9418  8.9418     1 26891 10.1969
EventData:t1_diagnosis               3.9303  1.3101     3 45444  1.4940
EventData:EventCounter               3.9615  1.3205     3 45456  1.5058
t1_diagnosis:EventCounter            3.9762  3.9762     1 45531  4.5344
EventData:t1_diagnosis:EventCounter  7.0816  2.3605     3 45456  2.6919
                                       Pr(&gt;F)    
EventData                           4.278e-07 ***
t1_diagnosis                         0.070193 .  
EventCounter                         0.078864 .  
scale(pd_baseline)                   0.001408 ** 
EventData:t1_diagnosis               0.213921    
EventData:EventCounter               0.210746    
t1_diagnosis:EventCounter            0.033226 *  
EventData:t1_diagnosis:EventCounter  0.044487 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>  ##supplements - full table
  row_names&lt;-c(&#39;stimulus (S)&#39;,&#39;group&#39;,&#39;task progression (TP)&#39;,
               &#39;BPS&#39;,
               &#39;S x group&#39;,&#39;S x TP&#39;,&#39;group x TP&#39;,&#39;S x group x TP&#39;)
  
  
  table_data_model&lt;-round(anova(lmm_REML_BPS),3)
  table_data_model&lt;-cbind(row_names,table_data_model)
  
  table_data_model</code></pre>
<pre><code>                                                row_names Sum Sq Mean Sq NumDF
EventData                                    stimulus (S) 28.435   9.478     3
t1_diagnosis                                        group  2.907   2.907     1
EventCounter                        task progression (TP)  2.708   2.708     1
scale(pd_baseline)                                    BPS  8.942   8.942     1
EventData:t1_diagnosis                          S x group  3.930   1.310     3
EventData:EventCounter                             S x TP  3.961   1.320     3
t1_diagnosis:EventCounter                      group x TP  3.976   3.976     1
EventData:t1_diagnosis:EventCounter        S x group x TP  7.082   2.361     3
                                       DenDF F value Pr(&gt;F)
EventData                           45445.07  10.809  0.000
t1_diagnosis                          194.98   3.315  0.070
EventCounter                        45537.59   3.088  0.079
scale(pd_baseline)                  26890.91  10.197  0.001
EventData:t1_diagnosis              45444.27   1.494  0.214
EventData:EventCounter              45455.88   1.506  0.211
t1_diagnosis:EventCounter           45531.15   4.534  0.033
EventData:t1_diagnosis:EventCounter 45455.58   2.692  0.044</code></pre>
<pre class="r"><code>  table_model&lt;-table_data_model %&gt;%
    kbl(caption = &quot;Linear mixed model: Moderation of group differences in dynamic mismatch negativity (MMN) by baseline pupil size (BPS)&quot;,
        col.names = c(&#39;&#39;,&#39;Sum Sq&#39;,&#39;Mean Sq&#39;,&#39;df1&#39;,&#39;df2&#39;,&#39;F&#39;,&#39;p adjusted&#39;),
        row.names = F) %&gt;%
    kable_classic(full_width = F, html_font = &quot;Cambria&quot;)
  
  
  table_model</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Linear mixed model: Moderation of group differences in dynamic mismatch
negativity (MMN) by baseline pupil size (BPS)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
df1
</th>
<th style="text-align:right;">
df2
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p adjusted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
stimulus (S)
</td>
<td style="text-align:right;">
28.435
</td>
<td style="text-align:right;">
9.478
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45445.07
</td>
<td style="text-align:right;">
10.809
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:right;">
2.907
</td>
<td style="text-align:right;">
2.907
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
194.98
</td>
<td style="text-align:right;">
3.315
</td>
<td style="text-align:right;">
0.070
</td>
</tr>
<tr>
<td style="text-align:left;">
task progression (TP)
</td>
<td style="text-align:right;">
2.708
</td>
<td style="text-align:right;">
2.708
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45537.59
</td>
<td style="text-align:right;">
3.088
</td>
<td style="text-align:right;">
0.079
</td>
</tr>
<tr>
<td style="text-align:left;">
BPS
</td>
<td style="text-align:right;">
8.942
</td>
<td style="text-align:right;">
8.942
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
26890.91
</td>
<td style="text-align:right;">
10.197
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group
</td>
<td style="text-align:right;">
3.930
</td>
<td style="text-align:right;">
1.310
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45444.27
</td>
<td style="text-align:right;">
1.494
</td>
<td style="text-align:right;">
0.214
</td>
</tr>
<tr>
<td style="text-align:left;">
S x TP
</td>
<td style="text-align:right;">
3.961
</td>
<td style="text-align:right;">
1.320
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45455.88
</td>
<td style="text-align:right;">
1.506
</td>
<td style="text-align:right;">
0.211
</td>
</tr>
<tr>
<td style="text-align:left;">
group x TP
</td>
<td style="text-align:right;">
3.976
</td>
<td style="text-align:right;">
3.976
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
45531.15
</td>
<td style="text-align:right;">
4.534
</td>
<td style="text-align:right;">
0.033
</td>
</tr>
<tr>
<td style="text-align:left;">
S x group x TP
</td>
<td style="text-align:right;">
7.082
</td>
<td style="text-align:right;">
2.361
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45455.58
</td>
<td style="text-align:right;">
2.692
</td>
<td style="text-align:right;">
0.044
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>  save_kable(table_model, file= paste0(project_path,&#39;/output/supplements/table_moderation_MMN_by_BPS.html&#39;))</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=English_Germany.utf8  LC_CTYPE=English_Germany.utf8   
[3] LC_MONETARY=English_Germany.utf8 LC_NUMERIC=C                    
[5] LC_TIME=English_Germany.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] car_3.1-1          carData_3.0-5      eegUtils_0.7.0     eegkit_1.0-4      
 [5] signal_0.7-7       rgl_1.1.3          ica_1.0-3          bigsplines_1.1-1  
 [9] quadprog_1.5-8     eegkitdata_1.1     wesanderson_0.3.6  gridExtra_2.3     
[13] RColorBrewer_1.1-3 effectsize_0.8.2   R.matlab_3.7.0     ggplot2_3.4.2     
[17] DiagrammeR_1.0.9   bayestestR_0.13.0  bayesplot_1.10.0   greta_0.4.3       
[21] kableExtra_1.3.4   data.table_1.14.6  zoo_1.8-11         pbapply_1.6-0     
[25] performance_0.10.1 emmeans_1.8.2      lmerTest_3.1-3     lme4_1.1-31       
[29] Matrix_1.5-1      

loaded via a namespace (and not attached):
  [1] backports_1.4.1      Hmisc_5.1-0          workflowr_1.7.0     
  [4] systemfonts_1.0.4    plyr_1.8.8           igraph_1.4.0        
  [7] lazyeval_0.2.2       splines_4.2.2        listenv_0.9.0       
 [10] tfruns_1.5.1         TH.data_1.1-2        digest_0.6.30       
 [13] htmltools_0.5.4      fansi_1.0.3          checkmate_2.1.0     
 [16] magrittr_2.0.3       cluster_2.1.4        globals_0.16.2      
 [19] matrixStats_0.63.0   R.utils_2.12.2       sandwich_3.0-2      
 [22] svglite_2.1.0        prettyunits_1.1.1    colorspace_2.0-3    
 [25] rvest_1.0.3          rappdirs_0.3.3       xfun_0.35           
 [28] dplyr_1.1.2          callr_3.7.3          crayon_1.5.2        
 [31] jsonlite_1.8.4       survival_3.4-0       glue_1.6.2          
 [34] gtable_0.3.1         webshot_0.5.4        distributional_0.3.1
 [37] future.apply_1.11.0  abind_1.4-5          scales_1.2.1        
 [40] mvtnorm_1.1-3        miniUI_0.1.1.1       Rcpp_1.0.9          
 [43] isoband_0.2.6        htmlTable_2.4.1      viridisLite_0.4.1   
 [46] xtable_1.8-4         progress_1.2.2       reticulate_1.28     
 [49] foreign_0.8-83       Formula_1.2-4        datawizard_0.6.4    
 [52] htmlwidgets_1.6.2    httr_1.4.6           posterior_1.3.1     
 [55] ellipsis_0.3.2       farver_2.1.1         pkgconfig_2.0.3     
 [58] R.methodsS3_1.8.2    nnet_7.3-18          sass_0.4.4          
 [61] here_1.0.1           utf8_1.2.2           labeling_0.4.2      
 [64] reshape2_1.4.4       tidyselect_1.2.0     rlang_1.1.1         
 [67] later_1.3.0          munsell_0.5.0        tools_4.2.2         
 [70] visNetwork_2.1.2     cachem_1.0.6         cli_3.6.1           
 [73] generics_0.1.3       ggridges_0.5.4       evaluate_0.18       
 [76] stringr_1.5.0        fastmap_1.1.0        yaml_2.3.6          
 [79] processx_3.8.0       knitr_1.41           fs_1.5.2            
 [82] purrr_1.0.1          future_1.31.0        nlme_3.1-160        
 [85] whisker_0.4.1        mime_0.12            R.oo_1.25.0         
 [88] pracma_2.4.2         xml2_1.3.3           compiler_4.2.2      
 [91] rstudioapi_0.14      plotly_4.10.2        png_0.1-8           
 [94] tibble_3.2.1         bslib_0.4.1          stringi_1.7.8       
 [97] highr_0.9            ps_1.7.2             parameters_0.20.0   
[100] lattice_0.20-45      psych_2.2.9          tensorflow_2.11.0   
[103] nloptr_2.0.3         tensorA_0.36.2       vctrs_0.6.2         
[106] pillar_1.9.0         lifecycle_1.0.3      jquerylib_0.1.4     
[109] estimability_1.4.1   insight_0.18.8       httpuv_1.6.6        
[112] R6_2.5.1             promises_1.2.0.1     parallelly_1.34.0   
[115] codetools_0.2-18     boot_1.3-28          MASS_7.3-58.1       
[118] rprojroot_2.0.3      withr_2.5.0          mnormt_2.1.1        
[121] multcomp_1.4-23      mgcv_1.8-41          parallel_4.2.2      
[124] hms_1.1.2            rpart_4.1.19         grid_4.2.2          
[127] tidyr_1.3.0          coda_0.19-4          minqa_1.2.5         
[130] rmarkdown_2.18       git2r_0.30.1         numDeriv_2016.8-1.1 
[133] shiny_1.7.3          base64enc_0.1-3     </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
